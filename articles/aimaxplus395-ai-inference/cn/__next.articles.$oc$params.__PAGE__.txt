1:"$Sreact.fragment"
2:I[28979,["/_next/static/chunks/8d29a04bcfe27c24.js","/_next/static/chunks/3dff3d4c63cf346e.js","/_next/static/chunks/b3af52d5d180873a.js","/_next/static/chunks/86b442c1397f7351.js","/_next/static/chunks/0a1497ca0a1721ad.js","/_next/static/chunks/4ec1bf7a32b70f87.js","/_next/static/chunks/276b22541034e0ea.js"],"ArticleFrontmatter"]
c:I[79817,["/_next/static/chunks/8d29a04bcfe27c24.js","/_next/static/chunks/3dff3d4c63cf346e.js","/_next/static/chunks/b3af52d5d180873a.js","/_next/static/chunks/86b442c1397f7351.js","/_next/static/chunks/0a1497ca0a1721ad.js","/_next/static/chunks/4ec1bf7a32b70f87.js","/_next/static/chunks/276b22541034e0ea.js"],"Gallery"]
4f:I[23491,["/_next/static/chunks/2caa33a942c5f527.js","/_next/static/chunks/59983278a34fd25c.js"],"OutletBoundary"]
50:"$Sreact.suspense"
55:I[72053,["/_next/static/chunks/8d29a04bcfe27c24.js","/_next/static/chunks/3dff3d4c63cf346e.js","/_next/static/chunks/b3af52d5d180873a.js","/_next/static/chunks/86b442c1397f7351.js","/_next/static/chunks/0a1497ca0a1721ad.js","/_next/static/chunks/4ec1bf7a32b70f87.js","/_next/static/chunks/276b22541034e0ea.js"],"ArticleImage"]
5a:I[14620,["/_next/static/chunks/8d29a04bcfe27c24.js","/_next/static/chunks/3dff3d4c63cf346e.js","/_next/static/chunks/b3af52d5d180873a.js","/_next/static/chunks/86b442c1397f7351.js","/_next/static/chunks/0a1497ca0a1721ad.js","/_next/static/chunks/4ec1bf7a32b70f87.js","/_next/static/chunks/276b22541034e0ea.js"],"ArticleToc"]
5b:I[39182,["/_next/static/chunks/8d29a04bcfe27c24.js","/_next/static/chunks/3dff3d4c63cf346e.js","/_next/static/chunks/b3af52d5d180873a.js","/_next/static/chunks/86b442c1397f7351.js","/_next/static/chunks/0a1497ca0a1721ad.js","/_next/static/chunks/4ec1bf7a32b70f87.js","/_next/static/chunks/276b22541034e0ea.js"],"RelatedArticles"]
5c:I[42449,["/_next/static/chunks/8d29a04bcfe27c24.js","/_next/static/chunks/3dff3d4c63cf346e.js","/_next/static/chunks/b3af52d5d180873a.js","/_next/static/chunks/86b442c1397f7351.js","/_next/static/chunks/0a1497ca0a1721ad.js","/_next/static/chunks/4ec1bf7a32b70f87.js","/_next/static/chunks/276b22541034e0ea.js"],"CommentPanelWithCurrentLanguage"]
:HL["/_next/static/chunks/44d2e091595b3eca.css","style"]
:HL["/_next/static/chunks/5e55d74f3211c796.css","style"]
:HL["/_next/static/chunks/b59bad6ea4f112f2.css","style"]
3:T239a,
# 前言

之前写过一篇[关于HP战99 Ultra（搭载AMD AI Max+ 395）的使用体验](/articles/aimaxplus395-experience)，今天聊聊这台笔记本在AI推理场景下的表现。作为这台机器宣传的主要场景，AI推理的实际使用情况却优点一言难尽。

# 硬件配置回顾

| 配置 | 详情                                     |
| ---- | ---------------------------------------- |
| CPU  | AMD Ryzen AI Max+ 395 16C32T Zen5        |
| 内存 | 64G LPDDR5 8000MT 4通道可划分显存        |
| 显卡 | Radeon 8060S 40CU RDNA3.5                |
| 显存 | 可在BIOS里将几个固定挡位的内存分配给显存 |

# 关键概念：可划分显存 vs 统一内存

在深入分析数据之前，需要理解几个重要概念：

- **传统显存**：传统独立显卡的固定显存，容量固定，如RTX 4090的24G
- **可划分显存**：静态分配机制，将内存的一部分固定划给GPU作为显存使用，如AI Max+ 395
- **统一内存**：内存和显存统一寻址，整个内存空间CPU和GPU都可以访问，无需显式分配（主要见于Apple M系列芯片）

**重要区别**：AI Max+ 395使用可划分显存架构，需要静态分配部分内存给GPU使用；而统一内存无需显式分配，灵活性更高。

# AI推理测试数据

为了方便，本次测试均使用LM Studio运行。LM Studio中对AMD显卡有两种Runtime：Vulkan和ROCm。我本以为两种Runtime不会有什么很大的区别，但是实际测试下来却axm并非如此。

## GLM 4.7 Flash 

这是个MoE模型，总参数量30B激活3B的规模，主要测试`Q4_K_M`量化的情况。在这个量化等级下，在模型大小为`18.13GB`。

以下的给出Prompt为：

> 编写一个科技公司的官网的HTML

在16K上下文下：

| 专用显存                  | 512M         | 32G              |
| ------------------------- | ------------ | ---------------- |
| 显存占用                  | 20.8G        | 21.3G            |
| Vulkan速度、总数(token/s) | 17.26 (6970) | **42.89** (6107) |
| Vulkan 首token (s)        | 0.8          | 0.8              |
| ROCm速度、总数（token/s） | 15.28 (5262) | 14.42 (6351)     |
| ROCm 首token (s)          | 0.04         | 0.34             |

Vulkan在32G专用显存下的速度实在是过于逆天，于是我重新跑了数次，结果均非常接近。后面我们还能拿到如此让人匪夷所思的成绩。

16K的上下文只能说勉强够用。既然还有这么多显存可用，不妨试试更多的长度上下文。根据LM Studio估计，不同长度上下文的显存使用估计值：

- 16K上下文：**18.59G**
- 64K上下文：**19.57G**
- 最大支持（198K）：**22.3G**

看起来MoE模型的一大好处就是可以把上下文拉大！于是我选择GLM 4.7 Flash最大支持的长上下文 198K下，虽然LM Studio的估计显存占用也仅有**22.3G**，但是512M专用显存的无法正常加载：

![无法正常加载模型](./198K-glm4.7-vulkan-no-memory.png)

只有在32G下可以正常使用，在Vulkan下获得了**37.28 token/s（7857 token，首token 0.15s）**的成绩。

同时我还测试了**Q6_K**的量化模型，在16K上下文、32G专用显存下：

- **模型大小**：24.61GB
- **预计显存占用**：25.12GB
- **推理性能**：
  - ROCm：13.79 token/s（6419 token，首token 0.33s）
  - Vulkan：**25.51** token/s（5717 token，首token 0.20s）

再次看到了不知道该说是Vulkan逆天还是ROCm的成绩！ROCm作为AMD官方的方案，居然被Vulkan拉开了如此大的差距。

在不开启思考的情况下，10 token/s的速度还是可以应付日常使用的。

## Qwen3 VL 32B Q4_K_M

稠密模型的情况就不一样了。这一部分我选择了Qwen 3 VL 32B来测试。

这是个支持图像输入的模型，于是我去stackoverflow上截了如下这一张图，

![Stackover截图](reproduce.png)

并给出prompt：

> 使用html和css重现这个HTML页面

以下为结果：

| 专用显存                  | 512M 16K    | 512M 24K    | 32G 16K |
| ------------------------- | ----------- | ----------- | ------- |
| 显存占用                  | 25.8G       | 28.3G       |         |
| Vulkan速度、总数(token/s) | 3.74 (4059) | 3.51 (3676) |         |
| Vulkan 首token (s)        | 36.67       | 39.29       |         |
| ROCm速度、总数（token/s） | 4.15 (3723) | 3.10 (3713) |         |
| ROCm 首token (s)          | 24.59       | 26.56       |         |

可以看到，在24K上下文已经到32G显存的极限了（28G）。

# 分配48G给显存？

395的另一个宣传点是可以将75%的内存划给显存，在64G的型号上，BIOS中最高可以将48G的内存划给显存。

听起来很美？48G显存甚至可以高量化跑32B模型了！

Qwen 3 VL 32B的Q6_K量化模型大小为**28.08G**，在32G显存下可以加载，但是推理的时候因为显存不够了，速度比可以完全在显存中的Q4版本慢很多。经过测试，Q5_K_M是最大的32G显存可以充分的量化规格。

而这时候你想到，48G显存岂不是就可以接近这个问题了？

可是事实却是：**16G的系统内存**不仅使得正常的系统操作会开始缓慢甚至卡顿，甚至模型都无法正常加载！而我已经LM Studio中有三个选项和显存和内存全部调整为不给内存太多压力了：

- KV缓存卸载到GPU内存中：打开，显存够大！
- 保持模型在内存中：关闭
- 尝试mmap()：将磁盘上映射到内存中空间中，关闭

![Qwen 3 VL 32B的Q6_K模型无法加载](./q6_16G-memory-not-loadable-vulkan.png)

# 内存可划分为显存 != 共享内存

395的主要的宣传口号，就是内存可以当作显存用。这话当然不假，BIOS里确实可以将内存划分给显存，但是，它和我们预期的**共享内存**完全是两码事：

- 被划分给显存部分不可以再作为内存使用
- 每次切换显存需要重启，不可无缝切换

那，如果我们不划分显存，**直接把内存当显存用呢**？其实现在的推理框架都支持把内存当显存用，但是以下两个问题让用内存当显存的方案下的推理速度惨不忍睹：

1. 内存与显存的速度之间有巨大差距
2. 内存中的数据仅能由CPU计算，而CPU在AI计算场景下速度非常缓慢，且CPU和显卡的计算数据需频繁相互拷贝

理论上来说，395的内存和显存均为同一款芯片，问题1不存在，但实际上问题2的问题仍然无法避免：即使是在同一块芯片上，显存仍然不能直接用内存部分的部分，内存和显存之间拷贝仍然非常频繁。

以下为使用512M专用显存（上）和32G专用显存（下）使用Vulkan运行GLM 4.7 Flash Q4_K_M时的任务管理器的图片，可以看出，512M的专用显存下GPU利用率只有70%左右，而32G下可以到达90%以上。而右上角的Copy也可以看出512M专用显存下显存一直在进行复制的操作。

![512M显存跑GLM 4.7 Flash Q4 16K](./glm4.7-no-dedicated-vulkan.png)

![32G显存跑GLM 4.7 Flash Q4 16K](./dedicated-memory-vulkan-glm4.7.png)

同一现象也出现在512M专用显存下运行Qwen 3 VL 32B Q4_K_M的情况，GPU利用率更是只有50%，而Copy图中也能一直看到复制的过程，而整个过程中CPU也在（艰难地）参与运算。而CPU参与计算在笔记本场景下有抢功耗的问题，更影响了GPU的性能发挥。

![512M显存跑Qwen 3 32B Q4KM，16K](./qwen3-32b-q4-km-no-dedicated-memory.png)

更进一步地，如果把上下文拉到24K，进一步加大显存的需求量，在512M专用显存下情况更加恶化了：GPU有接近一半的时间都闲着。要知道，这个时候显存需求甚至才26G！

![512M显存跑Qwen 3 32B Q4KM，24K](./24k-qwen3-32b-q4km-no-dedicated.png)

# 总结

我用两个字总结395的优点：**能用**

- 大显存确实可以跑一些正常显卡无法跑的模型，虽然慢，但是能跑比不能跑好！
- 成本相对较低（相比高端显卡）（也只是相对了）
- 4060移动端的绝对算力，不算高，但是愿意等等的话，它能跑的模型还是能给出结果的

可是这台笔记本形态、64G的总内存的设备却有点尴尬：

- 为了兼顾日常使用，实际上最多只能32G给显存
- 80W的最高功耗，无法充分发挥CPU的性能
- 手动划分显存操作失去了灵活性

所以395确实非常适合小主机场景：

- 这类主机在分配96G显存的情况下还有32G可以用于日常场景，比64G=48G+16G实用太多
- 这类主机的性能释放普遍超过100W，也有更完善的散热方案，可以更完美地发挥CPU和GPU的性能
- 和395刚出来的时候AMD更羸弱的AI生态相比，至少现在主流的推理场景（LM Studio，Ollama、ComfyUI）都已经可以用了

甚至小主机的价格也比笔记本形态的设备（64G 19999）便宜太多（128G普遍15000，希望还没开始涨）。在这个内存价格疯涨的年代，能以这个价格有一台可以跑大模型的机器已经很不容易了。0:{"buildId":"7dQlY40Cm-uDMIit5S5Jz","rsc":["$","$1","c",{"children":[["$","article",null,{"children":[["$","div",null,{"className":"bg-neutral px-4 py-8","children":["$","div",null,{"className":"max-w-7xl mx-auto min-h-[256px] flex justify-center text-center text-neutral-content","children":["$","div",null,{"className":"flex flex-col justify-center animate-slide-up","children":[["$","h1",null,{"className":"text-4xl my-2","children":"可划分显存 != 统一内存：AI Max+ 395 64G AI推理性能"}],["$","$L2",null,{"className":"justify-center","articleId":"aimaxplus395-ai-inference","info":{"content":"$3","title":"可划分显存 != 统一内存：AI Max+ 395 64G AI推理性能","date":"2026-02-02 20:34","id":"aimaxplus395-ai-inference","lang":"cn","tags":["ai","hands-on","thoughts"],"wordCount":2342,"readingTime":11.71,"filePath":"contents/20260202-aimaxplus395-ai-inference/cn.md"},"langVersions":["cn"]}]]}]}]}],"$L4"]}],["$L5","$L6","$L7","$L8","$L9","$La"],"$Lb"]}],"loading":null,"isPartial":false}
d:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959ze:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z4:["$","div",null,{"className":"animate-slide-up","children":[["$","div",null,{"className":"max-w-7xl mx-auto p-4","children":["$","div",null,{"className":"flex flex-row space-x-4","children":[["$","div",null,{"className":"prose max-w-full lg:w-[75%]","children":["$undefined",["$","$Lc",null,{"withCaption":true,"id":"aimaxplus395-ai-inference","children":[["$","h1","h1-0",{"id":"前言","children":[["$","a","前言",{"href":"#前言","className":"mr-1","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 512 512","className":"inline-block opacity-20 hover:opacity-60","children":["$undefined",[["$","path","0",{"d":"$d","children":[]}]]],"style":{},"height":16,"width":16,"xmlns":"http://www.w3.org/2000/svg"}]}],"前言"]}],"\n",["$","p","p-0",{"children":["之前写过一篇",["$","a","a-0",{"href":"/articles/aimaxplus395-experience","children":"关于HP战99 Ultra（搭载AMD AI Max+ 395）的使用体验"}],"，今天聊聊这台笔记本在AI推理场景下的表现。作为这台机器宣传的主要场景，AI推理的实际使用情况却优点一言难尽。"]}],"\n",["$","h1","h1-1",{"id":"硬件配置回顾","children":[["$","a","硬件配置回顾",{"href":"#硬件配置回顾","className":"mr-1","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 512 512","className":"inline-block opacity-20 hover:opacity-60","children":["$undefined",[["$","path","0",{"d":"$e","children":[]}]]],"style":{},"height":16,"width":16,"xmlns":"http://www.w3.org/2000/svg"}]}],"硬件配置回顾"]}],"\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","$Lf","\n","$L10","\n","$L11","\n","$L12","\n","$L13","\n","$L14","\n","$L15","\n","$L16","\n","$L17","\n","$L18","\n","$L19","\n","$L1a","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","$L1b","\n","$L1c","\n","$L1d","\n","$L1e","\n","$L1f","\n","$L20","\n","$L21","\n","$L22","\n","$L23","\n","$L24","\n","$L25","\n","$L26","\n","$L27","\n","$L28","\n","$L29","\n","$L2a","\n","$L2b","\n","$L2c","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n","$L2d","\n","$L2e","\n","$L2f","\n","$L30","\n","$L31","\n","$L32","\n","$L33","\n","$L34","\n","$L35","\n","$L36","\n","$L37","\n","$L38","\n","$L39","\n","$L3a","\n","$L3b","\n","$L3c","\n","$L3d","\n","$L3e","\n","$L3f","\n","$L40","\n","$L41","\n","$L42","\n","$L43","\n","$L44","\n","$L45","\n","$L46","\n","$L47","\n","$L48","\n","$L49","\n","$L4a","\n","$L4b"]}]]}],"$L4c"]}]}],"$L4d","$L4e"]}]
5:["$","link","0",{"rel":"stylesheet","href":"/_next/static/chunks/44d2e091595b3eca.css","precedence":"next"}]
6:["$","link","1",{"rel":"stylesheet","href":"/_next/static/chunks/5e55d74f3211c796.css","precedence":"next"}]
7:["$","link","2",{"rel":"stylesheet","href":"/_next/static/chunks/b59bad6ea4f112f2.css","precedence":"next"}]
8:["$","script","script-0",{"src":"/_next/static/chunks/0a1497ca0a1721ad.js","async":true}]
9:["$","script","script-1",{"src":"/_next/static/chunks/4ec1bf7a32b70f87.js","async":true}]
a:["$","script","script-2",{"src":"/_next/static/chunks/276b22541034e0ea.js","async":true}]
b:["$","$L4f",null,{"children":["$","$50",null,{"name":"Next.MetadataOutlet","children":"$@51"}]}]
f:["$","table","table-0",{"children":[["$","thead","thead-0",{"children":["$","tr","tr-0",{"children":[["$","th","th-0",{"children":"配置"}],["$","th","th-1",{"children":"详情"}]]}]}],["$","tbody","tbody-0",{"children":[["$","tr","tr-0",{"children":[["$","td","td-0",{"children":"CPU"}],["$","td","td-1",{"children":"AMD Ryzen AI Max+ 395 16C32T Zen5"}]]}],["$","tr","tr-1",{"children":[["$","td","td-0",{"children":"内存"}],["$","td","td-1",{"children":"64G LPDDR5 8000MT 4通道可划分显存"}]]}],["$","tr","tr-2",{"children":[["$","td","td-0",{"children":"显卡"}],["$","td","td-1",{"children":"Radeon 8060S 40CU RDNA3.5"}]]}],["$","tr","tr-3",{"children":[["$","td","td-0",{"children":"显存"}],["$","td","td-1",{"children":"可在BIOS里将几个固定挡位的内存分配给显存"}]]}]]}]]}]
52:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z10:["$","h1","h1-2",{"id":"关键概念可划分显存-vs-统一内存","children":[["$","a","关键概念可划分显存-vs-统一内存",{"href":"#关键概念可划分显存-vs-统一内存","className":"mr-1","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 512 512","className":"inline-block opacity-20 hover:opacity-60","children":["$undefined",[["$","path","0",{"d":"$52","children":[]}]]],"style":{},"height":16,"width":16,"xmlns":"http://www.w3.org/2000/svg"}]}],"关键概念：可划分显存 vs 统一内存"]}]
11:["$","p","p-1",{"children":"在深入分析数据之前，需要理解几个重要概念："}]
12:["$","ul","ul-0",{"children":["\n",["$","li","li-0",{"children":[["$","strong","strong-0",{"children":"传统显存"}],"：传统独立显卡的固定显存，容量固定，如RTX 4090的24G"]}],"\n",["$","li","li-1",{"children":[["$","strong","strong-0",{"children":"可划分显存"}],"：静态分配机制，将内存的一部分固定划给GPU作为显存使用，如AI Max+ 395"]}],"\n",["$","li","li-2",{"children":[["$","strong","strong-0",{"children":"统一内存"}],"：内存和显存统一寻址，整个内存空间CPU和GPU都可以访问，无需显式分配（主要见于Apple M系列芯片）"]}],"\n"]}]
13:["$","p","p-2",{"children":[["$","strong","strong-0",{"children":"重要区别"}],"：AI Max+ 395使用可划分显存架构，需要静态分配部分内存给GPU使用；而统一内存无需显式分配，灵活性更高。"]}]
53:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z14:["$","h1","h1-3",{"id":"ai推理测试数据","children":[["$","a","ai推理测试数据",{"href":"#ai推理测试数据","className":"mr-1","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 512 512","className":"inline-block opacity-20 hover:opacity-60","children":["$undefined",[["$","path","0",{"d":"$53","children":[]}]]],"style":{},"height":16,"width":16,"xmlns":"http://www.w3.org/2000/svg"}]}],"AI推理测试数据"]}]
15:["$","p","p-3",{"children":"为了方便，本次测试均使用LM Studio运行。LM Studio中对AMD显卡有两种Runtime：Vulkan和ROCm。我本以为两种Runtime不会有什么很大的区别，但是实际测试下来却axm并非如此。"}]
54:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z16:["$","h2","h2-0",{"id":"glm-47-flash","children":[["$","a","glm-47-flash",{"href":"#glm-47-flash","className":"mr-1","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 512 512","className":"inline-block opacity-20 hover:opacity-60","children":["$undefined",[["$","path","0",{"d":"$54","children":[]}]]],"style":{},"height":16,"width":16,"xmlns":"http://www.w3.org/2000/svg"}]}],"GLM 4.7 Flash"]}]
17:["$","p","p-4",{"children":["这是个MoE模型，总参数量30B激活3B的规模，主要测试",["$","code","code-0",{"children":"Q4_K_M"}],"量化的情况。在这个量化等级下，在模型大小为",["$","code","code-1",{"children":"18.13GB"}],"。"]}]
18:["$","p","p-5",{"children":"以下的给出Prompt为："}]
19:["$","blockquote","blockquote-0",{"children":["\n",["$","p","p-0",{"children":"编写一个科技公司的官网的HTML"}],"\n"]}]
1a:["$","p","p-6",{"children":"在16K上下文下："}]
1b:["$","table","table-1",{"children":[["$","thead","thead-0",{"children":["$","tr","tr-0",{"children":[["$","th","th-0",{"children":"专用显存"}],["$","th","th-1",{"children":"512M"}],["$","th","th-2",{"children":"32G"}]]}]}],["$","tbody","tbody-0",{"children":[["$","tr","tr-0",{"children":[["$","td","td-0",{"children":"显存占用"}],["$","td","td-1",{"children":"20.8G"}],["$","td","td-2",{"children":"21.3G"}]]}],["$","tr","tr-1",{"children":[["$","td","td-0",{"children":"Vulkan速度、总数(token/s)"}],["$","td","td-1",{"children":"17.26 (6970)"}],["$","td","td-2",{"children":[["$","strong","strong-0",{"children":"42.89"}]," (6107)"]}]]}],["$","tr","tr-2",{"children":[["$","td","td-0",{"children":"Vulkan 首token (s)"}],["$","td","td-1",{"children":"0.8"}],["$","td","td-2",{"children":"0.8"}]]}],["$","tr","tr-3",{"children":[["$","td","td-0",{"children":"ROCm速度、总数（token/s）"}],["$","td","td-1",{"children":"15.28 (5262)"}],["$","td","td-2",{"children":"14.42 (6351)"}]]}],["$","tr","tr-4",{"children":[["$","td","td-0",{"children":"ROCm 首token (s)"}],["$","td","td-1",{"children":"0.04"}],["$","td","td-2",{"children":"0.34"}]]}]]}]]}]
1c:["$","p","p-7",{"children":"Vulkan在32G专用显存下的速度实在是过于逆天，于是我重新跑了数次，结果均非常接近。后面我们还能拿到如此让人匪夷所思的成绩。"}]
1d:["$","p","p-8",{"children":"16K的上下文只能说勉强够用。既然还有这么多显存可用，不妨试试更多的长度上下文。根据LM Studio估计，不同长度上下文的显存使用估计值："}]
1e:["$","ul","ul-1",{"children":["\n",["$","li","li-0",{"children":["16K上下文：",["$","strong","strong-0",{"children":"18.59G"}]]}],"\n",["$","li","li-1",{"children":["64K上下文：",["$","strong","strong-0",{"children":"19.57G"}]]}],"\n",["$","li","li-2",{"children":["最大支持（198K）：",["$","strong","strong-0",{"children":"22.3G"}]]}],"\n"]}]
1f:["$","p","p-9",{"children":["看起来MoE模型的一大好处就是可以把上下文拉大！于是我选择GLM 4.7 Flash最大支持的长上下文 198K下，虽然LM Studio的估计显存占用也仅有",["$","strong","strong-0",{"children":"22.3G"}],"，但是512M专用显存的无法正常加载："]}]
20:["$","p","p-10",{"children":["$","$L55","img-0",{"src":"/articles/asset/contents/20260202-aimaxplus395-ai-inference/198K-glm4.7-vulkan-no-memory.png","imageSize":{"height":175,"width":454},"imageProps":{"src":"./198K-glm4.7-vulkan-no-memory.png","alt":"无法正常加载模型"}}]}]
21:["$","p","p-11",{"children":"只有在32G下可以正常使用，在Vulkan下获得了**37.28 token/s（7857 token，首token 0.15s）**的成绩。"}]
22:["$","p","p-12",{"children":["同时我还测试了",["$","strong","strong-0",{"children":"Q6_K"}],"的量化模型，在16K上下文、32G专用显存下："]}]
23:["$","ul","ul-2",{"children":["\n",["$","li","li-0",{"children":[["$","strong","strong-0",{"children":"模型大小"}],"：24.61GB"]}],"\n",["$","li","li-1",{"children":[["$","strong","strong-0",{"children":"预计显存占用"}],"：25.12GB"]}],"\n",["$","li","li-2",{"children":[["$","strong","strong-0",{"children":"推理性能"}],"：\n",["$","ul","ul-0",{"children":["\n",["$","li","li-0",{"children":"ROCm：13.79 token/s（6419 token，首token 0.33s）"}],"\n",["$","li","li-1",{"children":["Vulkan：",["$","strong","strong-0",{"children":"25.51"}]," token/s（5717 token，首token 0.20s）"]}],"\n"]}],"\n"]}],"\n"]}]
24:["$","p","p-13",{"children":"再次看到了不知道该说是Vulkan逆天还是ROCm的成绩！ROCm作为AMD官方的方案，居然被Vulkan拉开了如此大的差距。"}]
25:["$","p","p-14",{"children":"在不开启思考的情况下，10 token/s的速度还是可以应付日常使用的。"}]
56:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z26:["$","h2","h2-1",{"id":"qwen3-vl-32b-q4_k_m","children":[["$","a","qwen3-vl-32b-q4_k_m",{"href":"#qwen3-vl-32b-q4_k_m","className":"mr-1","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 512 512","className":"inline-block opacity-20 hover:opacity-60","children":["$undefined",[["$","path","0",{"d":"$56","children":[]}]]],"style":{},"height":16,"width":16,"xmlns":"http://www.w3.org/2000/svg"}]}],"Qwen3 VL 32B Q4_K_M"]}]
27:["$","p","p-15",{"children":"稠密模型的情况就不一样了。这一部分我选择了Qwen 3 VL 32B来测试。"}]
28:["$","p","p-16",{"children":"这是个支持图像输入的模型，于是我去stackoverflow上截了如下这一张图，"}]
29:["$","p","p-17",{"children":["$","$L55","img-0",{"src":"/articles/asset/contents/20260202-aimaxplus395-ai-inference/reproduce.png","imageSize":{"height":831,"width":1486},"imageProps":{"src":"reproduce.png","alt":"Stackover截图"}}]}]
2a:["$","p","p-18",{"children":"并给出prompt："}]
2b:["$","blockquote","blockquote-1",{"children":["\n",["$","p","p-0",{"children":"使用html和css重现这个HTML页面"}],"\n"]}]
2c:["$","p","p-19",{"children":"以下为结果："}]
2d:["$","table","table-2",{"children":[["$","thead","thead-0",{"children":["$","tr","tr-0",{"children":[["$","th","th-0",{"children":"专用显存"}],["$","th","th-1",{"children":"512M 16K"}],["$","th","th-2",{"children":"512M 24K"}],["$","th","th-3",{"children":"32G 16K"}]]}]}],["$","tbody","tbody-0",{"children":[["$","tr","tr-0",{"children":[["$","td","td-0",{"children":"显存占用"}],["$","td","td-1",{"children":"25.8G"}],["$","td","td-2",{"children":"28.3G"}],["$","td","td-3",{}]]}],["$","tr","tr-1",{"children":[["$","td","td-0",{"children":"Vulkan速度、总数(token/s)"}],["$","td","td-1",{"children":"3.74 (4059)"}],["$","td","td-2",{"children":"3.51 (3676)"}],["$","td","td-3",{}]]}],["$","tr","tr-2",{"children":[["$","td","td-0",{"children":"Vulkan 首token (s)"}],["$","td","td-1",{"children":"36.67"}],["$","td","td-2",{"children":"39.29"}],["$","td","td-3",{}]]}],["$","tr","tr-3",{"children":[["$","td","td-0",{"children":"ROCm速度、总数（token/s）"}],["$","td","td-1",{"children":"4.15 (3723)"}],["$","td","td-2",{"children":"3.10 (3713)"}],["$","td","td-3",{}]]}],["$","tr","tr-4",{"children":[["$","td","td-0",{"children":"ROCm 首token (s)"}],["$","td","td-1",{"children":"24.59"}],["$","td","td-2",{"children":"26.56"}],["$","td","td-3",{}]]}]]}]]}]
2e:["$","p","p-20",{"children":"可以看到，在24K上下文已经到32G显存的极限了（28G）。"}]
57:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z2f:["$","h1","h1-4",{"id":"分配48g给显存","children":[["$","a","分配48g给显存",{"href":"#分配48g给显存","className":"mr-1","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 512 512","className":"inline-block opacity-20 hover:opacity-60","children":["$undefined",[["$","path","0",{"d":"$57","children":[]}]]],"style":{},"height":16,"width":16,"xmlns":"http://www.w3.org/2000/svg"}]}],"分配48G给显存？"]}]
30:["$","p","p-21",{"children":"395的另一个宣传点是可以将75%的内存划给显存，在64G的型号上，BIOS中最高可以将48G的内存划给显存。"}]
31:["$","p","p-22",{"children":"听起来很美？48G显存甚至可以高量化跑32B模型了！"}]
32:["$","p","p-23",{"children":["Qwen 3 VL 32B的Q6_K量化模型大小为",["$","strong","strong-0",{"children":"28.08G"}],"，在32G显存下可以加载，但是推理的时候因为显存不够了，速度比可以完全在显存中的Q4版本慢很多。经过测试，Q5_K_M是最大的32G显存可以充分的量化规格。"]}]
33:["$","p","p-24",{"children":"而这时候你想到，48G显存岂不是就可以接近这个问题了？"}]
34:["$","p","p-25",{"children":["可是事实却是：",["$","strong","strong-0",{"children":"16G的系统内存"}],"不仅使得正常的系统操作会开始缓慢甚至卡顿，甚至模型都无法正常加载！而我已经LM Studio中有三个选项和显存和内存全部调整为不给内存太多压力了："]}]
35:["$","ul","ul-3",{"children":["\n",["$","li","li-0",{"children":"KV缓存卸载到GPU内存中：打开，显存够大！"}],"\n",["$","li","li-1",{"children":"保持模型在内存中：关闭"}],"\n",["$","li","li-2",{"children":"尝试mmap()：将磁盘上映射到内存中空间中，关闭"}],"\n"]}]
36:["$","p","p-26",{"children":["$","$L55","img-0",{"src":"/articles/asset/contents/20260202-aimaxplus395-ai-inference/q6_16G-memory-not-loadable-vulkan.png","imageSize":{"height":821,"width":1046},"imageProps":{"src":"./q6_16G-memory-not-loadable-vulkan.png","alt":"Qwen 3 VL 32B的Q6_K模型无法加载"}}]}]
58:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z37:["$","h1","h1-5",{"id":"内存可划分为显存--共享内存","children":[["$","a","内存可划分为显存--共享内存",{"href":"#内存可划分为显存--共享内存","className":"mr-1","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 512 512","className":"inline-block opacity-20 hover:opacity-60","children":["$undefined",[["$","path","0",{"d":"$58","children":[]}]]],"style":{},"height":16,"width":16,"xmlns":"http://www.w3.org/2000/svg"}]}],"内存可划分为显存 != 共享内存"]}]
38:["$","p","p-27",{"children":["395的主要的宣传口号，就是内存可以当作显存用。这话当然不假，BIOS里确实可以将内存划分给显存，但是，它和我们预期的",["$","strong","strong-0",{"children":"共享内存"}],"完全是两码事："]}]
39:["$","ul","ul-4",{"children":["\n",["$","li","li-0",{"children":"被划分给显存部分不可以再作为内存使用"}],"\n",["$","li","li-1",{"children":"每次切换显存需要重启，不可无缝切换"}],"\n"]}]
3a:["$","p","p-28",{"children":["那，如果我们不划分显存，",["$","strong","strong-0",{"children":"直接把内存当显存用呢"}],"？其实现在的推理框架都支持把内存当显存用，但是以下两个问题让用内存当显存的方案下的推理速度惨不忍睹："]}]
3b:["$","ol","ol-0",{"children":["\n",["$","li","li-0",{"children":"内存与显存的速度之间有巨大差距"}],"\n",["$","li","li-1",{"children":"内存中的数据仅能由CPU计算，而CPU在AI计算场景下速度非常缓慢，且CPU和显卡的计算数据需频繁相互拷贝"}],"\n"]}]
3c:["$","p","p-29",{"children":"理论上来说，395的内存和显存均为同一款芯片，问题1不存在，但实际上问题2的问题仍然无法避免：即使是在同一块芯片上，显存仍然不能直接用内存部分的部分，内存和显存之间拷贝仍然非常频繁。"}]
3d:["$","p","p-30",{"children":"以下为使用512M专用显存（上）和32G专用显存（下）使用Vulkan运行GLM 4.7 Flash Q4_K_M时的任务管理器的图片，可以看出，512M的专用显存下GPU利用率只有70%左右，而32G下可以到达90%以上。而右上角的Copy也可以看出512M专用显存下显存一直在进行复制的操作。"}]
3e:["$","p","p-31",{"children":["$","$L55","img-0",{"src":"/articles/asset/contents/20260202-aimaxplus395-ai-inference/glm4.7-no-dedicated-vulkan.png","imageSize":{"height":1553,"width":1844},"imageProps":{"src":"./glm4.7-no-dedicated-vulkan.png","alt":"512M显存跑GLM 4.7 Flash Q4 16K"}}]}]
3f:["$","p","p-32",{"children":["$","$L55","img-0",{"src":"/articles/asset/contents/20260202-aimaxplus395-ai-inference/dedicated-memory-vulkan-glm4.7.png","imageSize":{"height":1470,"width":1866},"imageProps":{"src":"./dedicated-memory-vulkan-glm4.7.png","alt":"32G显存跑GLM 4.7 Flash Q4 16K"}}]}]
40:["$","p","p-33",{"children":"同一现象也出现在512M专用显存下运行Qwen 3 VL 32B Q4_K_M的情况，GPU利用率更是只有50%，而Copy图中也能一直看到复制的过程，而整个过程中CPU也在（艰难地）参与运算。而CPU参与计算在笔记本场景下有抢功耗的问题，更影响了GPU的性能发挥。"}]
41:["$","p","p-34",{"children":["$","$L55","img-0",{"src":"/articles/asset/contents/20260202-aimaxplus395-ai-inference/qwen3-32b-q4-km-no-dedicated-memory.png","imageSize":{"height":735,"width":1127},"imageProps":{"src":"./qwen3-32b-q4-km-no-dedicated-memory.png","alt":"512M显存跑Qwen 3 32B Q4KM，16K"}}]}]
42:["$","p","p-35",{"children":"更进一步地，如果把上下文拉到24K，进一步加大显存的需求量，在512M专用显存下情况更加恶化了：GPU有接近一半的时间都闲着。要知道，这个时候显存需求甚至才26G！"}]
43:["$","p","p-36",{"children":["$","$L55","img-0",{"src":"/articles/asset/contents/20260202-aimaxplus395-ai-inference/24k-qwen3-32b-q4km-no-dedicated.png","imageSize":{"height":1072,"width":1661},"imageProps":{"src":"./24k-qwen3-32b-q4km-no-dedicated.png","alt":"512M显存跑Qwen 3 32B Q4KM，24K"}}]}]
59:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z44:["$","h1","h1-6",{"id":"总结","children":[["$","a","总结",{"href":"#总结","className":"mr-1","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 512 512","className":"inline-block opacity-20 hover:opacity-60","children":["$undefined",[["$","path","0",{"d":"$59","children":[]}]]],"style":{},"height":16,"width":16,"xmlns":"http://www.w3.org/2000/svg"}]}],"总结"]}]
45:["$","p","p-37",{"children":["我用两个字总结395的优点：",["$","strong","strong-0",{"children":"能用"}]]}]
46:["$","ul","ul-5",{"children":["\n",["$","li","li-0",{"children":"大显存确实可以跑一些正常显卡无法跑的模型，虽然慢，但是能跑比不能跑好！"}],"\n",["$","li","li-1",{"children":"成本相对较低（相比高端显卡）（也只是相对了）"}],"\n",["$","li","li-2",{"children":"4060移动端的绝对算力，不算高，但是愿意等等的话，它能跑的模型还是能给出结果的"}],"\n"]}]
47:["$","p","p-38",{"children":"可是这台笔记本形态、64G的总内存的设备却有点尴尬："}]
48:["$","ul","ul-6",{"children":["\n",["$","li","li-0",{"children":"为了兼顾日常使用，实际上最多只能32G给显存"}],"\n",["$","li","li-1",{"children":"80W的最高功耗，无法充分发挥CPU的性能"}],"\n",["$","li","li-2",{"children":"手动划分显存操作失去了灵活性"}],"\n"]}]
49:["$","p","p-39",{"children":"所以395确实非常适合小主机场景："}]
4a:["$","ul","ul-7",{"children":["\n",["$","li","li-0",{"children":"这类主机在分配96G显存的情况下还有32G可以用于日常场景，比64G=48G+16G实用太多"}],"\n",["$","li","li-1",{"children":"这类主机的性能释放普遍超过100W，也有更完善的散热方案，可以更完美地发挥CPU和GPU的性能"}],"\n",["$","li","li-2",{"children":"和395刚出来的时候AMD更羸弱的AI生态相比，至少现在主流的推理场景（LM Studio，Ollama、ComfyUI）都已经可以用了"}],"\n"]}]
4b:["$","p","p-40",{"children":"甚至小主机的价格也比笔记本形态的设备（64G 19999）便宜太多（128G普遍15000，希望还没开始涨）。在这个内存价格疯涨的年代，能以这个价格有一台可以跑大模型的机器已经很不容易了。"}]
4c:["$","div",null,{"className":"hidden lg:block lg:w-[25%]","children":["$","$L5a",null,{"toc":[{"depth":1,"value":"前言","id":"前言"},{"depth":1,"value":"硬件配置回顾","id":"硬件配置回顾"},{"depth":1,"value":"关键概念：可划分显存 vs 统一内存","id":"关键概念可划分显存-vs-统一内存"},{"depth":1,"value":"AI推理测试数据","id":"ai推理测试数据","children":[{"depth":2,"value":"GLM 4.7 Flash","id":"glm-47-flash"},{"depth":2,"value":"Qwen3 VL 32B Q4_K_M","id":"qwen3-vl-32b-q4_k_m"}]},{"depth":1,"value":"分配48G给显存？","id":"分配48g给显存"},{"depth":1,"value":"内存可划分为显存 != 共享内存","id":"内存可划分为显存--共享内存"},{"depth":1,"value":"总结","id":"总结"}],"hasSummary":false}]}]
4d:["$","div",null,{"className":"max-w-7xl mx-auto p-4","children":["$","$L5b",null,{"relatedArticles":[]}]}]
4e:["$","div",null,{"className":"max-w-7xl mx-auto p-4","children":["$","$L5c",null,{"articleId":"aimaxplus395-ai-inference","articleTitle":"可划分显存 != 统一内存：AI Max+ 395 64G AI推理性能"}]}]
51:null
