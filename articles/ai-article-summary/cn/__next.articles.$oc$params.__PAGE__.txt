1:"$Sreact.fragment"
2:I[28979,["/_next/static/chunks/8d29a04bcfe27c24.js","/_next/static/chunks/3dff3d4c63cf346e.js","/_next/static/chunks/b3af52d5d180873a.js","/_next/static/chunks/86b442c1397f7351.js","/_next/static/chunks/0a1497ca0a1721ad.js","/_next/static/chunks/4ec1bf7a32b70f87.js","/_next/static/chunks/276b22541034e0ea.js"],"ArticleFrontmatter"]
c:I[21753,["/_next/static/chunks/8d29a04bcfe27c24.js","/_next/static/chunks/3dff3d4c63cf346e.js","/_next/static/chunks/b3af52d5d180873a.js","/_next/static/chunks/86b442c1397f7351.js","/_next/static/chunks/0a1497ca0a1721ad.js","/_next/static/chunks/4ec1bf7a32b70f87.js","/_next/static/chunks/276b22541034e0ea.js"],"ArticleSummarization"]
d:I[79817,["/_next/static/chunks/8d29a04bcfe27c24.js","/_next/static/chunks/3dff3d4c63cf346e.js","/_next/static/chunks/b3af52d5d180873a.js","/_next/static/chunks/86b442c1397f7351.js","/_next/static/chunks/0a1497ca0a1721ad.js","/_next/static/chunks/4ec1bf7a32b70f87.js","/_next/static/chunks/276b22541034e0ea.js"],"Gallery"]
2e:I[23491,["/_next/static/chunks/2caa33a942c5f527.js","/_next/static/chunks/59983278a34fd25c.js"],"OutletBoundary"]
2f:"$Sreact.suspense"
31:I[72053,["/_next/static/chunks/8d29a04bcfe27c24.js","/_next/static/chunks/3dff3d4c63cf346e.js","/_next/static/chunks/b3af52d5d180873a.js","/_next/static/chunks/86b442c1397f7351.js","/_next/static/chunks/0a1497ca0a1721ad.js","/_next/static/chunks/4ec1bf7a32b70f87.js","/_next/static/chunks/276b22541034e0ea.js"],"ArticleImage"]
86:I[14620,["/_next/static/chunks/8d29a04bcfe27c24.js","/_next/static/chunks/3dff3d4c63cf346e.js","/_next/static/chunks/b3af52d5d180873a.js","/_next/static/chunks/86b442c1397f7351.js","/_next/static/chunks/0a1497ca0a1721ad.js","/_next/static/chunks/4ec1bf7a32b70f87.js","/_next/static/chunks/276b22541034e0ea.js"],"ArticleToc"]
87:I[39182,["/_next/static/chunks/8d29a04bcfe27c24.js","/_next/static/chunks/3dff3d4c63cf346e.js","/_next/static/chunks/b3af52d5d180873a.js","/_next/static/chunks/86b442c1397f7351.js","/_next/static/chunks/0a1497ca0a1721ad.js","/_next/static/chunks/4ec1bf7a32b70f87.js","/_next/static/chunks/276b22541034e0ea.js"],"RelatedArticles"]
88:I[42449,["/_next/static/chunks/8d29a04bcfe27c24.js","/_next/static/chunks/3dff3d4c63cf346e.js","/_next/static/chunks/b3af52d5d180873a.js","/_next/static/chunks/86b442c1397f7351.js","/_next/static/chunks/0a1497ca0a1721ad.js","/_next/static/chunks/4ec1bf7a32b70f87.js","/_next/static/chunks/276b22541034e0ea.js"],"CommentPanelWithCurrentLanguage"]
:HL["/_next/static/chunks/44d2e091595b3eca.css","style"]
:HL["/_next/static/chunks/5e55d74f3211c796.css","style"]
:HL["/_next/static/chunks/b59bad6ea4f112f2.css","style"]
3:T25ee,
# 一条朋友圈的提示

当昨天的[2023年总结](/articles/summary-for-2023)发出后，朋友圈有人对文章做出了总结，这启发了我，何不自己用AI给文章加个总结功能呢？正好也是第一次在真实场景中实装AI功能，看看目前在真实项目中集成AI需要什么步骤，体验怎么样，能做到什么功能。

![朋友圈锐总结](./weixin-summary.png)

# 选择AI服务

确定了要做这事，下一步就开始调研应该用什么AI服务。


第一反应肯定用[OpenAI API](https://openai.com/blog/openai-api)，去年某段时间注册OpenAI账号不需要手机号，趁着这个机会直接注册了一个，至少最基本的ChatGPT可以用GPT 3.5模型聊天了。而当我想去用OpenAI的API的时候，发现要获得OpenAI的API需要验证手机号，而国内手机号当然验证不了的。除了手机号，支付方式也是一个问题，虽然我有国内银行的VISA卡但是似乎仍然不能使用。

![国内手机号无法验证OpenAI API](./openai-china-phone-not-available.png)

于是接下来我想到了公司的[Azure OpenAI](https://azure.microsoft.com/en-us/products/ai-services/openai-service)服务。虽然Azure的服务都偏贵，但是由于公司每年都给员工送150刀的Azure额度，所以一点简单的应用还是可以开发的。可是真的去注册的时候发现Azure OpenAI Service并没有完全开放给所有客户，要注册必须填个注册表，且必须以公司身份注册。

![Azure OpenAI服务并未面向大众开放](./azure-openai-limit.png)

正当我在想“不会要去找国产服务了吧”的时候，我想到两个月前在Ignite上亮相的[Azure AI Studio](https://azure.microsoft.com/en-us/products/ai-studio)。仔细研究了下，发现这个功能本身只是一个集成平台，它是基于一些已经已经发布的[Azure AI服务](https://learn.microsoft.com/en-us/azure/ai-services/)，而上面想尝试的Azure OpenAI只是这些服务内的一个。在这些服务中，有一个[Language服务](https://learn.microsoft.com/en-us/azure/ai-services/language-service/)，正好用于处理自然语言的场景，而其中正好还自带了[Summarization](https://learn.microsoft.com/en-us/azure/ai-services/language-service/summarization/overview?tabs=document-summarization)功能，其中的Abstractive summarization模式只要输入文本，它就能输出一段总结这段文本的文字。

一切都是正好。微软爸爸真懂我。

# 使用Azure AI Language Service

根据[Quickstart文档](https://learn.microsoft.com/en-us/azure/ai-services/language-service/summarization/quickstart?tabs=document-summarization%2Clinux&pivots=programming-language-javascript)，我们首先需要创建了一个[Language资源](https://portal.azure.com/#create/Microsoft.CognitiveServicesTextAnalytics)，获取资源对应的endpoint以及key。

文章总结功能的一大好处是这个功能**不需要实时交互**。也就是说，我可以在后台把总结生成好，像文章内容本身一样作为静态资源放在仓库里。这样，我们根本不需要能够支持大量调用的AI服务，只要运行一次，就完全可以使用了。创建的资源的时候，每个subscription可以创建一个免费的资源，我们本来也就不到50篇文章，免费的资源就完全够用了。

![创建好的Azure Language资源](./azure-language-resource.png)

接下来需要在项目中安装SDK来使用这个资源。我们的博客使用的是Node.js，于是我们选择Node.js继续进行下一步。使用`npm install --save @azure/ai-language-text@1.1.0`安装SDK后，根据指示直接在项目使用SDK即可。

由于只要内容不变，总结就没有必要更新，所以最简单最直接的做法，就是直接放在本地写个脚本，读取文章的内容，然后把文章内容的markdown直接一股脑送给服务获得内容的总结，然后把总结的内容生成到文章对应的目录下，读取文章的时候顺便读取生成的总结，然后在UI中渲染就好。

```ts title="ai/summarize.mts"
// 总结文本
async function summarize(text: string, languageCode: string): Promise<string[] | Error> {
  const lro = await client.beginAnalyzeBatch([
    // 使用AbstractiveSummarization模式
    { kind: "AbstractiveSummarization" },
    // 根据文章的语言指定所使用的语言，实现中文文章输出中文总结，英文文章输出英文总结
  ], [text], languageCode);

  // 这是个耗时操作，等待耗时操作结束
  const results = await lro.pollUntilDone();

  for await (const actionResult of results) {
    if (actionResult.kind !== "AbstractiveSummarization") {
      return new Error(`Expected extractive summarization results but got: ${actionResult.kind}`);
    }
    if (actionResult.error) {
      const { code, message } = actionResult.error;
      return new Error(`Unexpected error (${code}): ${message}`);
    }

    for (const result of actionResult.results) {
      if (result.error) {
        const { code, message } = result.error;
        return new Error(`Unexpected error (${code}): ${message}`);
      }

      // 返回输出的结果
      return result.summaries.map((x) => x.text);
    }
  }

  throw new Error("No result");
}

async function summarizeArticle(articleDir: string) {
  // 获取此文章的所有markdown文件
  const mdFiles = (await readdir(articleDir)).filter((x) => x.endsWith(".md"));

  for (const mdFile of mdFiles) {
    const mdFilePath = join(articleDir, mdFile);

    // 读取并解析文章内容
    const mdContent = await readFile(mdFilePath, "utf-8");
    const { data: frontMatter, content } = matter(mdContent);

    // 计算并更新文章Hash，如果文章内容hash没有变，之后就不要重新生成总结了
    const contentHash = hashContent(content);

    const summaryJsonFilePath = join(articleDir, `${frontMatter.lang}.summary.json`);

    if (existsSync(summaryJsonFilePath) && (await stat(summaryJsonFilePath)).isFile()) {
      const existingSummaryJson: ArticleSummary = JSON.parse(await readFile(summaryJsonFilePath, "utf-8"));

      existingSummaryJson.hash = contentHash;

      if (contentHash === existingSummaryJson.hash) {
        log("log", "Content is not changed after the last summarization. Skip summarization.");
        continue;
      }
    }

    // 总结文本
    const summary = await summarize(content,
      azureLanguageCodeMap[frontMatter.lang as keyof typeof azureLanguageCodeMap]);

    if (summary instanceof Error) {
      log("error", "Error on summarizing %s of lang %s: %s", frontMatter.id, frontMatter.lang, summary.message);
      continue;
    }

    // 在文章目录下生成一个[语言id].summary.json文件，存放内容hash、总结以及相关操作信息
    const summaryJson: ArticleSummary = {
      articleId: frontMatter.id,
      lang: frontMatter.lang,
      lastUpdateStartTime: startTime,
      lastUpdateEndTime: new Date().toISOString(),
      summaries: summary,
      hash: contentHash,
    };

    log("log", "Write summary of %s of lang %s to %s", frontMatter.id, frontMatter.lang, summaryJsonFilePath);

    await writeFile(summaryJsonFilePath, JSON.stringify(summaryJson, null, 2));
  }
}

```

# 效果

最终效果嘛，你在打开本文章的时候应该就看到了。如果一篇文章能够成功生成总结，那么文章页面的一开头，以及右侧的目录部分就会有**AI总结**这部分内容。

![效果图](./article-summary-live.png)

为什么说“如果可以成功生成总结”呢？在具体操作中，[2020年总结](/articles/summary-for-2020)这篇文章死活不能生成总结。

![一篇文章无法生成总结](./failed-to-generate-summary.png)

而对应成功生成总结的文章，总的来说英文文章的总结效果显著好于中文文章。例如，[An Infinite Loop Caused by Updating a Map during Iteration](/articles/an-infinite-loop-caused-by-updating-a-Map-during-iteration)这篇文章的总结包括了问题描述、问题解决过程以及最终的解决方案，语言流畅，逻辑清晰；

> The author encountered a problem during the development of the 2.0 version of [simstate], where an infinite loop occurred during the iteration of a set of ' observers' stored in a ES6 Map. The problem was initially confused due to the Map having only one element and remaining unchanged between and inside loops. However, after investigation, the author discovered that the root of the problem was the call to observer, which alters the Map itself during iteration. This led to the infinite loop, even when deleting and re-adding an entry during iteration.

而同样类型的[问题探究](https://ddadaal.me/articles/search?query=problem-investigation)类文章[一次生产环境的文件丢失事故：复盘和教训](/articles/summary-of-a-file-lost-accident)，得出的总结就过于简单，而且也没有找到问题重点，得出的文本中甚至都是英文标点。

> 作者通过log、数据库数据等找到了受到影响的用户,通过邮箱、电话和短信提醒他们重新上传文件。

# 总结

这是我第一次在实际项目中运用AI，在充分的文档帮助下，整个过程花费了6个小时左右，其中集成这个功能可能花了1个小时左右，而最终的效果不能算非常完美，但是也是是差强人意。在2023年的最后一天完成这个过程，在新年的第一天给博客实现这个新的功能，也算是一个新年礼物了吧。在AI的时代，与其害怕AI替代自己，不如主动拥抱AI提高生产效率，而这对于从业者的我们天生就有优势。
0:{"buildId":"7i2WQvz7gDPo6cUsqOuKv","rsc":["$","$1","c",{"children":[["$","article",null,{"children":[["$","div",null,{"className":"bg-neutral px-4 py-8","children":["$","div",null,{"className":"max-w-7xl mx-auto min-h-[256px] flex justify-center text-center text-neutral-content","children":["$","div",null,{"className":"flex flex-col justify-center animate-slide-up","children":[["$","h1",null,{"className":"text-4xl my-2","children":"博客集成AI文章总结功能"}],["$","$L2",null,{"className":"justify-center","articleId":"ai-article-summary","info":{"content":"$3","title":"博客集成AI文章总结功能","date":"2024-01-01 10:20","id":"ai-article-summary","lang":"cn","tags":["blog"],"wordCount":1930,"readingTime":9.65,"filePath":"contents/20240101-ai-article-summary/cn.md","summary":{"articleId":"ai-article-summary","lang":"cn","hash":"24ec2c456dfd0a28786b26ffccdcda57a9dee3f582b931868fb2b235ec525ea1","summaries":[{"metadata":{"summarizer":"azure-ai","model":"DeepSeek-R1"},"summaries":["作者受朋友圈启发，为博客添加AI自动总结功能。尝试OpenAI API受阻后，转向Azure AI Studio的Language服务，利用其抽象摘要功能。通过Node.js脚本读取文章内容并调用API生成总结，结果存储为静态文件。实现中英文文章总结，但英文效果更佳，部分中文总结存在标点及逻辑问题。尽管存在不足，整体效果尚可。项目耗时约6小时，集成过程约1小时，体现开发者主动拥抱AI提升效率的实践，强调利用工具优化生产力而非被动担忧替代风险。"],"startTime":"2025-02-14T13:42:49.901Z","endTime":"2025-02-14T13:43:15.051Z"},{"metadata":{"summarizer":"ollama","model":"deepseek-r1:8b"},"summaries":["## 分步说明：\n\n1. **理解文档内容**：阅读用户提供的文章，分析其结构和目标。了解作者使用Azure Cognitive Services实现了自动摘要功能，并记录了遇到的问题及解决过程。\n\n2. **识别关键问题**：\n   - 某些文章无法生成总结。\n   - 不同语言的总结质量存在差异。\n   - 代码中的错误处理和日志信息可以优化。\n\n3. **寻找改进方法**：\n   - 针对无法生成总结的文章，分析可能原因，如内容结构复杂或技术术语密集。\n   - 提高不同语言总结质量，可能需要优化模型参数或增加训练数据。\n   - 优化代码中的错误处理，确保日志信息简洁且有助于调试。\n\n4. **实施修改**：\n   - 在代码中引入更细致的错误处理逻辑，提升异常情况下的可读性。\n   - 验证文章内容哈希计算是否正确，避免潜在问题。\n   - 对比不同语言总结效果，调整模型以提高准确性。\n\n5. **测试和验证**：\n   - 在多篇文章上运行改进后的代码，观察生成总结的质量和成功率。\n   - 收集反馈，持续优化功能，直到满足预期效果。\n\n6. **记录并分享**：将整个过程详细记录，并在博客上发布一个更新，介绍新功能及其改进措施。\n\n## 最终结果：\n\n通过以上步骤，用户成功实现了使用AI进行自动文档总结功能，同时也解决了一些技术难点。这不仅提高了工作效率，也展示了如何将现有技术与实际项目结合，积极应用新技术来优化工作流程。"]}]}},"langVersions":["cn"]}]]}]}]}],"$L4"]}],["$L5","$L6","$L7","$L8","$L9","$La"],"$Lb"]}],"loading":null,"isPartial":false}
e:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z4:["$","div",null,{"className":"animate-slide-up","children":[["$","div",null,{"className":"max-w-7xl mx-auto p-4","children":["$","div",null,{"className":"flex flex-row space-x-4","children":[["$","div",null,{"className":"prose max-w-full lg:w-[75%]","children":[["$","$Lc",null,{"summaries":[{"metadata":{"summarizer":"azure-ai","model":"DeepSeek-R1"},"children":[["$","p","p-0",{"children":"作者受朋友圈启发，为博客添加AI自动总结功能。尝试OpenAI API受阻后，转向Azure AI Studio的Language服务，利用其抽象摘要功能。通过Node.js脚本读取文章内容并调用API生成总结，结果存储为静态文件。实现中英文文章总结，但英文效果更佳，部分中文总结存在标点及逻辑问题。尽管存在不足，整体效果尚可。项目耗时约6小时，集成过程约1小时，体现开发者主动拥抱AI提升效率的实践，强调利用工具优化生产力而非被动担忧替代风险。"}]]},{"metadata":{"summarizer":"ollama","model":"deepseek-r1:8b"},"children":[["$","h2","h2-0",{"children":"分步说明："}],"\n",["$","ol","ol-0",{"children":["\n",["$","li","li-0",{"children":["\n",["$","p","p-0",{"children":[["$","strong","strong-0",{"children":"理解文档内容"}],"：阅读用户提供的文章，分析其结构和目标。了解作者使用Azure Cognitive Services实现了自动摘要功能，并记录了遇到的问题及解决过程。"]}],"\n"]}],"\n",["$","li","li-1",{"children":["\n",["$","p","p-0",{"children":[["$","strong","strong-0",{"children":"识别关键问题"}],"："]}],"\n",["$","ul","ul-0",{"children":["\n",["$","li","li-0",{"children":"某些文章无法生成总结。"}],"\n",["$","li","li-1",{"children":"不同语言的总结质量存在差异。"}],"\n",["$","li","li-2",{"children":"代码中的错误处理和日志信息可以优化。"}],"\n"]}],"\n"]}],"\n",["$","li","li-2",{"children":["\n",["$","p","p-0",{"children":[["$","strong","strong-0",{"children":"寻找改进方法"}],"："]}],"\n",["$","ul","ul-0",{"children":["\n",["$","li","li-0",{"children":"针对无法生成总结的文章，分析可能原因，如内容结构复杂或技术术语密集。"}],"\n",["$","li","li-1",{"children":"提高不同语言总结质量，可能需要优化模型参数或增加训练数据。"}],"\n",["$","li","li-2",{"children":"优化代码中的错误处理，确保日志信息简洁且有助于调试。"}],"\n"]}],"\n"]}],"\n",["$","li","li-3",{"children":["\n",["$","p","p-0",{"children":[["$","strong","strong-0",{"children":"实施修改"}],"："]}],"\n",["$","ul","ul-0",{"children":["\n",["$","li","li-0",{"children":"在代码中引入更细致的错误处理逻辑，提升异常情况下的可读性。"}],"\n",["$","li","li-1",{"children":"验证文章内容哈希计算是否正确，避免潜在问题。"}],"\n",["$","li","li-2",{"children":"对比不同语言总结效果，调整模型以提高准确性。"}],"\n"]}],"\n"]}],"\n",["$","li","li-4",{"children":["\n",["$","p","p-0",{"children":[["$","strong","strong-0",{"children":"测试和验证"}],"："]}],"\n",["$","ul","ul-0",{"children":["\n",["$","li","li-0",{"children":"在多篇文章上运行改进后的代码，观察生成总结的质量和成功率。"}],"\n",["$","li","li-1",{"children":"收集反馈，持续优化功能，直到满足预期效果。"}],"\n"]}],"\n"]}],"\n",["$","li","li-5",{"children":["\n",["$","p","p-0",{"children":[["$","strong","strong-0",{"children":"记录并分享"}],"：将整个过程详细记录，并在博客上发布一个更新，介绍新功能及其改进措施。"]}],"\n"]}],"\n"]}],"\n",["$","h2","h2-1",{"children":"最终结果："}],"\n",["$","p","p-0",{"children":"通过以上步骤，用户成功实现了使用AI进行自动文档总结功能，同时也解决了一些技术难点。这不仅提高了工作效率，也展示了如何将现有技术与实际项目结合，积极应用新技术来优化工作流程。"}]]}]}],["$","$Ld",null,{"withCaption":true,"id":"ai-article-summary","children":[["$","h1","h1-0",{"id":"一条朋友圈的提示","children":[["$","a","一条朋友圈的提示",{"href":"#一条朋友圈的提示","className":"mr-1","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 512 512","className":"inline-block opacity-20 hover:opacity-60","children":["$undefined",[["$","path","0",{"d":"$e","children":[]}]]],"style":{},"height":16,"width":16,"xmlns":"http://www.w3.org/2000/svg"}]}],"一条朋友圈的提示"]}],"\n","$Lf","\n","$L10","\n","$L11","\n","$L12","\n","$L13","\n","$L14","\n","$L15","\n","$L16","\n","$L17","\n","$L18","\n","$L19","\n","$L1a","\n","$L1b","\n","$L1c","\n","$L1d","\n","$L1e","\n","$L1f","\n","$L20","\n","$L21","\n","$L22","\n","$L23","\n","$L24","\n","$L25","\n","$L26","\n","$L27","\n","$L28","\n","$L29","\n","$L2a"]}]]}],"$L2b"]}]}],"$L2c","$L2d"]}]
5:["$","link","0",{"rel":"stylesheet","href":"/_next/static/chunks/44d2e091595b3eca.css","precedence":"next"}]
6:["$","link","1",{"rel":"stylesheet","href":"/_next/static/chunks/5e55d74f3211c796.css","precedence":"next"}]
7:["$","link","2",{"rel":"stylesheet","href":"/_next/static/chunks/b59bad6ea4f112f2.css","precedence":"next"}]
8:["$","script","script-0",{"src":"/_next/static/chunks/0a1497ca0a1721ad.js","async":true}]
9:["$","script","script-1",{"src":"/_next/static/chunks/4ec1bf7a32b70f87.js","async":true}]
a:["$","script","script-2",{"src":"/_next/static/chunks/276b22541034e0ea.js","async":true}]
b:["$","$L2e",null,{"children":["$","$2f",null,{"name":"Next.MetadataOutlet","children":"$@30"}]}]
f:["$","p","p-0",{"children":["当昨天的",["$","a","a-0",{"href":"/articles/summary-for-2023","children":"2023年总结"}],"发出后，朋友圈有人对文章做出了总结，这启发了我，何不自己用AI给文章加个总结功能呢？正好也是第一次在真实场景中实装AI功能，看看目前在真实项目中集成AI需要什么步骤，体验怎么样，能做到什么功能。"]}]
10:["$","p","p-1",{"children":["$","$L31","img-0",{"src":"/articles/asset/contents/20240101-ai-article-summary/weixin-summary.png","imageSize":{"height":34,"width":562},"imageProps":{"src":"./weixin-summary.png","alt":"朋友圈锐总结"}}]}]
32:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z11:["$","h1","h1-1",{"id":"选择ai服务","children":[["$","a","选择ai服务",{"href":"#选择ai服务","className":"mr-1","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 512 512","className":"inline-block opacity-20 hover:opacity-60","children":["$undefined",[["$","path","0",{"d":"$32","children":[]}]]],"style":{},"height":16,"width":16,"xmlns":"http://www.w3.org/2000/svg"}]}],"选择AI服务"]}]
12:["$","p","p-2",{"children":"确定了要做这事，下一步就开始调研应该用什么AI服务。"}]
13:["$","p","p-3",{"children":["第一反应肯定用",["$","a","a-0",{"href":"https://openai.com/blog/openai-api","children":"OpenAI API"}],"，去年某段时间注册OpenAI账号不需要手机号，趁着这个机会直接注册了一个，至少最基本的ChatGPT可以用GPT 3.5模型聊天了。而当我想去用OpenAI的API的时候，发现要获得OpenAI的API需要验证手机号，而国内手机号当然验证不了的。除了手机号，支付方式也是一个问题，虽然我有国内银行的VISA卡但是似乎仍然不能使用。"]}]
14:["$","p","p-4",{"children":["$","$L31","img-0",{"src":"/articles/asset/contents/20240101-ai-article-summary/openai-china-phone-not-available.png","imageSize":{"height":933,"width":1915},"imageProps":{"src":"./openai-china-phone-not-available.png","alt":"国内手机号无法验证OpenAI API"}}]}]
15:["$","p","p-5",{"children":["于是接下来我想到了公司的",["$","a","a-0",{"href":"https://azure.microsoft.com/en-us/products/ai-services/openai-service","children":"Azure OpenAI"}],"服务。虽然Azure的服务都偏贵，但是由于公司每年都给员工送150刀的Azure额度，所以一点简单的应用还是可以开发的。可是真的去注册的时候发现Azure OpenAI Service并没有完全开放给所有客户，要注册必须填个注册表，且必须以公司身份注册。"]}]
16:["$","p","p-6",{"children":["$","$L31","img-0",{"src":"/articles/asset/contents/20240101-ai-article-summary/azure-openai-limit.png","imageSize":{"height":324,"width":1350},"imageProps":{"src":"./azure-openai-limit.png","alt":"Azure OpenAI服务并未面向大众开放"}}]}]
17:["$","p","p-7",{"children":["正当我在想“不会要去找国产服务了吧”的时候，我想到两个月前在Ignite上亮相的",["$","a","a-0",{"href":"https://azure.microsoft.com/en-us/products/ai-studio","children":"Azure AI Studio"}],"。仔细研究了下，发现这个功能本身只是一个集成平台，它是基于一些已经已经发布的",["$","a","a-1",{"href":"https://learn.microsoft.com/en-us/azure/ai-services/","children":"Azure AI服务"}],"，而上面想尝试的Azure OpenAI只是这些服务内的一个。在这些服务中，有一个",["$","a","a-2",{"href":"https://learn.microsoft.com/en-us/azure/ai-services/language-service/","children":"Language服务"}],"，正好用于处理自然语言的场景，而其中正好还自带了",["$","a","a-3",{"href":"https://learn.microsoft.com/en-us/azure/ai-services/language-service/summarization/overview?tabs=document-summarization","children":"Summarization"}],"功能，其中的Abstractive summarization模式只要输入文本，它就能输出一段总结这段文本的文字。"]}]
18:["$","p","p-8",{"children":"一切都是正好。微软爸爸真懂我。"}]
33:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z19:["$","h1","h1-2",{"id":"使用azure-ai-language-service","children":[["$","a","使用azure-ai-language-service",{"href":"#使用azure-ai-language-service","className":"mr-1","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 512 512","className":"inline-block opacity-20 hover:opacity-60","children":["$undefined",[["$","path","0",{"d":"$33","children":[]}]]],"style":{},"height":16,"width":16,"xmlns":"http://www.w3.org/2000/svg"}]}],"使用Azure AI Language Service"]}]
1a:["$","p","p-9",{"children":["根据",["$","a","a-0",{"href":"https://learn.microsoft.com/en-us/azure/ai-services/language-service/summarization/quickstart?tabs=document-summarization%2Clinux&pivots=programming-language-javascript","children":"Quickstart文档"}],"，我们首先需要创建了一个",["$","a","a-1",{"href":"https://portal.azure.com/#create/Microsoft.CognitiveServicesTextAnalytics","children":"Language资源"}],"，获取资源对应的endpoint以及key。"]}]
1b:["$","p","p-10",{"children":["文章总结功能的一大好处是这个功能",["$","strong","strong-0",{"children":"不需要实时交互"}],"。也就是说，我可以在后台把总结生成好，像文章内容本身一样作为静态资源放在仓库里。这样，我们根本不需要能够支持大量调用的AI服务，只要运行一次，就完全可以使用了。创建的资源的时候，每个subscription可以创建一个免费的资源，我们本来也就不到50篇文章，免费的资源就完全够用了。"]}]
1c:["$","p","p-11",{"children":["$","$L31","img-0",{"src":"/articles/asset/contents/20240101-ai-article-summary/azure-language-resource.png","imageSize":{"height":731,"width":2577},"imageProps":{"src":"./azure-language-resource.png","alt":"创建好的Azure Language资源"}}]}]
1d:["$","p","p-12",{"children":["接下来需要在项目中安装SDK来使用这个资源。我们的博客使用的是Node.js，于是我们选择Node.js继续进行下一步。使用",["$","code","code-0",{"children":"npm install --save @azure/ai-language-text@1.1.0"}],"安装SDK后，根据指示直接在项目使用SDK即可。"]}]
1e:["$","p","p-13",{"children":"由于只要内容不变，总结就没有必要更新，所以最简单最直接的做法，就是直接放在本地写个脚本，读取文章的内容，然后把文章内容的markdown直接一股脑送给服务获得内容的总结，然后把总结的内容生成到文章对应的目录下，读取文章的时候顺便读取生成的总结，然后在UI中渲染就好。"}]
1f:["$","figure","figure-0",{"data-rehype-pretty-code-figure":"","children":[["$","figcaption","figcaption-0",{"data-rehype-pretty-code-title":"","data-language":"ts","data-theme":"one-dark-pro","children":"ai/summarize.mts"}],["$","pre","pre-0",{"style":{"backgroundColor":"#282c34","color":"#abb2bf"},"tabIndex":0,"data-language":"ts","data-theme":"one-dark-pro","children":["$","code","code-0",{"data-language":"ts","data-theme":"one-dark-pro","style":{"display":"grid"},"children":[["$","span","span-0",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#7F848E","fontStyle":"italic"},"children":"// 总结文本"}]}],"\n",["$","span","span-1",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"async"}],["$","span","span-1",{"style":{"color":"#C678DD"},"children":" function"}],["$","span","span-2",{"style":{"color":"#61AFEF"},"children":" summarize"}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-4",{"style":{"color":"#E06C75","fontStyle":"italic"},"children":"text"}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":": "}],["$","span","span-6",{"style":{"color":"#E5C07B"},"children":"string"}],["$","span","span-7",{"style":{"color":"#ABB2BF"},"children":", "}],["$","span","span-8",{"style":{"color":"#E06C75","fontStyle":"italic"},"children":"languageCode"}],["$","span","span-9",{"style":{"color":"#ABB2BF"},"children":": "}],["$","span","span-10",{"style":{"color":"#E5C07B"},"children":"string"}],["$","span","span-11",{"style":{"color":"#ABB2BF"},"children":"): "}],["$","span","span-12",{"style":{"color":"#E5C07B"},"children":"Promise"}],["$","span","span-13",{"style":{"color":"#ABB2BF"},"children":"<"}],["$","span","span-14",{"style":{"color":"#E5C07B"},"children":"string"}],["$","span","span-15",{"style":{"color":"#ABB2BF"},"children":"[] | "}],["$","span","span-16",{"style":{"color":"#E5C07B"},"children":"Error"}],["$","span","span-17",{"style":{"color":"#ABB2BF"},"children":"> {"}]]}],"\n",["$","span","span-2",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"  const"}],["$","span","span-1",{"style":{"color":"#E5C07B"},"children":" lro"}],["$","span","span-2",{"style":{"color":"#56B6C2"},"children":" ="}],["$","span","span-3",{"style":{"color":"#C678DD"},"children":" await"}],["$","span","span-4",{"style":{"color":"#E5C07B"},"children":" client"}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-6",{"style":{"color":"#61AFEF"},"children":"beginAnalyzeBatch"}],["$","span","span-7",{"style":{"color":"#ABB2BF"},"children":"(["}]]}],"\n",["$","span","span-3",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#7F848E","fontStyle":"italic"},"children":"    // 使用AbstractiveSummarization模式"}]}],"\n",["$","span","span-4",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#ABB2BF"},"children":"    { "}],["$","span","span-1",{"style":{"color":"#E06C75"},"children":"kind"}],["$","span","span-2",{"style":{"color":"#ABB2BF"},"children":": "}],["$","span","span-3",{"style":{"color":"#98C379"},"children":"\"AbstractiveSummarization\""}],["$","span","span-4",{"style":{"color":"#ABB2BF"},"children":" },"}]]}],"\n",["$","span","span-5",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#7F848E","fontStyle":"italic"},"children":"    // 根据文章的语言指定所使用的语言，实现中文文章输出中文总结，英文文章输出英文总结"}]}],"\n",["$","span","span-6",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#ABB2BF"},"children":"  ], ["}],["$","span","span-1",{"style":{"color":"#E06C75"},"children":"text"}],["$","span","span-2",{"style":{"color":"#ABB2BF"},"children":"], "}],["$","span","span-3",{"style":{"color":"#E06C75"},"children":"languageCode"}],["$","span","span-4",{"style":{"color":"#ABB2BF"},"children":");"}]]}],"\n",["$","span","span-7",{"data-line":"","children":" "}],"\n",["$","span","span-8",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#7F848E","fontStyle":"italic"},"children":"  // 这是个耗时操作，等待耗时操作结束"}]}],"\n",["$","span","span-9",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"  const"}],["$","span","span-1",{"style":{"color":"#E5C07B"},"children":" results"}],["$","span","span-2",{"style":{"color":"#56B6C2"},"children":" ="}],["$","span","span-3",{"style":{"color":"#C678DD"},"children":" await"}],["$","span","span-4",{"style":{"color":"#E5C07B"},"children":" lro"}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-6",{"style":{"color":"#61AFEF"},"children":"pollUntilDone"}],["$","span","span-7",{"style":{"color":"#ABB2BF"},"children":"();"}]]}],"\n",["$","span","span-10",{"data-line":"","children":" "}],"\n",["$","span","span-11",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"  for"}],["$","span","span-1",{"style":{"color":"#C678DD"},"children":" await"}],"$L34","$L35","$L36","$L37","$L38","$L39"]}],"\n","$L3a","\n","$L3b","\n","$L3c","\n","$L3d","\n","$L3e","\n","$L3f","\n","$L40","\n","$L41","\n","$L42","\n","$L43","\n","$L44","\n","$L45","\n","$L46","\n","$L47","\n","$L48","\n","$L49","\n","$L4a","\n","$L4b","\n","$L4c","\n","$L4d","\n","$L4e","\n","$L4f","\n","$L50","\n","$L51","\n","$L52","\n","$L53","\n","$L54","\n","$L55","\n","$L56","\n","$L57","\n","$L58","\n","$L59","\n","$L5a","\n","$L5b","\n","$L5c","\n","$L5d","\n","$L5e","\n","$L5f","\n","$L60","\n","$L61","\n","$L62","\n","$L63","\n","$L64","\n","$L65","\n","$L66","\n","$L67","\n","$L68","\n","$L69","\n","$L6a","\n","$L6b","\n","$L6c","\n","$L6d","\n","$L6e","\n","$L6f","\n","$L70","\n","$L71","\n","$L72","\n","$L73","\n","$L74","\n","$L75","\n","$L76","\n","$L77","\n","$L78","\n","$L79","\n","$L7a","\n","$L7b","\n","$L7c","\n","$L7d","\n","$L7e","\n","$L7f","\n","$L80","\n","$L81","\n","$L82","\n","$L83"]}]}]]}]
84:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z20:["$","h1","h1-3",{"id":"效果","children":[["$","a","效果",{"href":"#效果","className":"mr-1","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 512 512","className":"inline-block opacity-20 hover:opacity-60","children":["$undefined",[["$","path","0",{"d":"$84","children":[]}]]],"style":{},"height":16,"width":16,"xmlns":"http://www.w3.org/2000/svg"}]}],"效果"]}]
21:["$","p","p-14",{"children":["最终效果嘛，你在打开本文章的时候应该就看到了。如果一篇文章能够成功生成总结，那么文章页面的一开头，以及右侧的目录部分就会有",["$","strong","strong-0",{"children":"AI总结"}],"这部分内容。"]}]
22:["$","p","p-15",{"children":["$","$L31","img-0",{"src":"/articles/asset/contents/20240101-ai-article-summary/article-summary-live.png","imageSize":{"height":879,"width":1876},"imageProps":{"src":"./article-summary-live.png","alt":"效果图"}}]}]
23:["$","p","p-16",{"children":["为什么说“如果可以成功生成总结”呢？在具体操作中，",["$","a","a-0",{"href":"/articles/summary-for-2020","children":"2020年总结"}],"这篇文章死活不能生成总结。"]}]
24:["$","p","p-17",{"children":["$","$L31","img-0",{"src":"/articles/asset/contents/20240101-ai-article-summary/failed-to-generate-summary.png","imageSize":{"height":137,"width":2177},"imageProps":{"src":"./failed-to-generate-summary.png","alt":"一篇文章无法生成总结"}}]}]
25:["$","p","p-18",{"children":["而对应成功生成总结的文章，总的来说英文文章的总结效果显著好于中文文章。例如，",["$","a","a-0",{"href":"/articles/an-infinite-loop-caused-by-updating-a-Map-during-iteration","children":"An Infinite Loop Caused by Updating a Map during Iteration"}],"这篇文章的总结包括了问题描述、问题解决过程以及最终的解决方案，语言流畅，逻辑清晰；"]}]
26:["$","blockquote","blockquote-0",{"children":["\n",["$","p","p-0",{"children":"The author encountered a problem during the development of the 2.0 version of [simstate], where an infinite loop occurred during the iteration of a set of ' observers' stored in a ES6 Map. The problem was initially confused due to the Map having only one element and remaining unchanged between and inside loops. However, after investigation, the author discovered that the root of the problem was the call to observer, which alters the Map itself during iteration. This led to the infinite loop, even when deleting and re-adding an entry during iteration."}],"\n"]}]
27:["$","p","p-19",{"children":["而同样类型的",["$","a","a-0",{"href":"https://ddadaal.me/articles/search?query=problem-investigation","children":"问题探究"}],"类文章",["$","a","a-1",{"href":"/articles/summary-of-a-file-lost-accident","children":"一次生产环境的文件丢失事故：复盘和教训"}],"，得出的总结就过于简单，而且也没有找到问题重点，得出的文本中甚至都是英文标点。"]}]
28:["$","blockquote","blockquote-1",{"children":["\n",["$","p","p-0",{"children":"作者通过log、数据库数据等找到了受到影响的用户,通过邮箱、电话和短信提醒他们重新上传文件。"}],"\n"]}]
85:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z29:["$","h1","h1-4",{"id":"总结","children":[["$","a","总结",{"href":"#总结","className":"mr-1","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 512 512","className":"inline-block opacity-20 hover:opacity-60","children":["$undefined",[["$","path","0",{"d":"$85","children":[]}]]],"style":{},"height":16,"width":16,"xmlns":"http://www.w3.org/2000/svg"}]}],"总结"]}]
2a:["$","p","p-20",{"children":"这是我第一次在实际项目中运用AI，在充分的文档帮助下，整个过程花费了6个小时左右，其中集成这个功能可能花了1个小时左右，而最终的效果不能算非常完美，但是也是是差强人意。在2023年的最后一天完成这个过程，在新年的第一天给博客实现这个新的功能，也算是一个新年礼物了吧。在AI的时代，与其害怕AI替代自己，不如主动拥抱AI提高生产效率，而这对于从业者的我们天生就有优势。"}]
2b:["$","div",null,{"className":"hidden lg:block lg:w-[25%]","children":["$","$L86",null,{"toc":[{"depth":1,"value":"一条朋友圈的提示","id":"一条朋友圈的提示"},{"depth":1,"value":"选择AI服务","id":"选择ai服务"},{"depth":1,"value":"使用Azure AI Language Service","id":"使用azure-ai-language-service"},{"depth":1,"value":"效果","id":"效果"},{"depth":1,"value":"总结","id":"总结"}],"hasSummary":true}]}]
2c:["$","div",null,{"className":"max-w-7xl mx-auto p-4","children":["$","$L87",null,{"relatedArticles":[]}]}]
2d:["$","div",null,{"className":"max-w-7xl mx-auto p-4","children":["$","$L88",null,{"articleId":"ai-article-summary","articleTitle":"博客集成AI文章总结功能"}]}]
30:null
34:["$","span","span-2",{"style":{"color":"#ABB2BF"},"children":" ("}]
35:["$","span","span-3",{"style":{"color":"#C678DD"},"children":"const"}]
36:["$","span","span-4",{"style":{"color":"#E5C07B"},"children":" actionResult"}]
37:["$","span","span-5",{"style":{"color":"#C678DD"},"children":" of"}]
38:["$","span","span-6",{"style":{"color":"#E06C75"},"children":" results"}]
39:["$","span","span-7",{"style":{"color":"#ABB2BF"},"children":") {"}]
3a:["$","span","span-12",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"    if"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":" ("}],["$","span","span-2",{"style":{"color":"#E5C07B"},"children":"actionResult"}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-4",{"style":{"color":"#E06C75"},"children":"kind"}],["$","span","span-5",{"style":{"color":"#56B6C2"},"children":" !=="}],["$","span","span-6",{"style":{"color":"#98C379"},"children":" \"AbstractiveSummarization\""}],["$","span","span-7",{"style":{"color":"#ABB2BF"},"children":") {"}]]}]
3b:["$","span","span-13",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"      return"}],["$","span","span-1",{"style":{"color":"#C678DD"},"children":" new"}],["$","span","span-2",{"style":{"color":"#61AFEF"},"children":" Error"}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-4",{"style":{"color":"#98C379"},"children":"`Expected extractive summarization results but got: "}],["$","span","span-5",{"style":{"color":"#C678DD"},"children":"$${"}],["$","span","span-6",{"style":{"color":"#E5C07B"},"children":"actionResult"}],["$","span","span-7",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-8",{"style":{"color":"#E06C75"},"children":"kind"}],["$","span","span-9",{"style":{"color":"#C678DD"},"children":"}"}],["$","span","span-10",{"style":{"color":"#98C379"},"children":"`"}],["$","span","span-11",{"style":{"color":"#ABB2BF"},"children":");"}]]}]
3c:["$","span","span-14",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#ABB2BF"},"children":"    }"}]}]
3d:["$","span","span-15",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"    if"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":" ("}],["$","span","span-2",{"style":{"color":"#E5C07B"},"children":"actionResult"}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-4",{"style":{"color":"#E06C75"},"children":"error"}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":") {"}]]}]
3e:["$","span","span-16",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"      const"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":" { "}],["$","span","span-2",{"style":{"color":"#E5C07B"},"children":"code"}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":", "}],["$","span","span-4",{"style":{"color":"#E5C07B"},"children":"message"}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":" } "}],["$","span","span-6",{"style":{"color":"#56B6C2"},"children":"="}],["$","span","span-7",{"style":{"color":"#E5C07B"},"children":" actionResult"}],["$","span","span-8",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-9",{"style":{"color":"#E06C75"},"children":"error"}],["$","span","span-10",{"style":{"color":"#ABB2BF"},"children":";"}]]}]
3f:["$","span","span-17",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"      return"}],["$","span","span-1",{"style":{"color":"#C678DD"},"children":" new"}],["$","span","span-2",{"style":{"color":"#61AFEF"},"children":" Error"}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-4",{"style":{"color":"#98C379"},"children":"`Unexpected error ("}],["$","span","span-5",{"style":{"color":"#C678DD"},"children":"$${"}],["$","span","span-6",{"style":{"color":"#E06C75"},"children":"code"}],["$","span","span-7",{"style":{"color":"#C678DD"},"children":"}"}],["$","span","span-8",{"style":{"color":"#98C379"},"children":"): "}],["$","span","span-9",{"style":{"color":"#C678DD"},"children":"$${"}],["$","span","span-10",{"style":{"color":"#E06C75"},"children":"message"}],["$","span","span-11",{"style":{"color":"#C678DD"},"children":"}"}],["$","span","span-12",{"style":{"color":"#98C379"},"children":"`"}],["$","span","span-13",{"style":{"color":"#ABB2BF"},"children":");"}]]}]
40:["$","span","span-18",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#ABB2BF"},"children":"    }"}]}]
41:["$","span","span-19",{"data-line":"","children":" "}]
42:["$","span","span-20",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"    for"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":" ("}],["$","span","span-2",{"style":{"color":"#C678DD"},"children":"const"}],["$","span","span-3",{"style":{"color":"#E5C07B"},"children":" result"}],["$","span","span-4",{"style":{"color":"#C678DD"},"children":" of"}],["$","span","span-5",{"style":{"color":"#E5C07B"},"children":" actionResult"}],["$","span","span-6",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-7",{"style":{"color":"#E06C75"},"children":"results"}],["$","span","span-8",{"style":{"color":"#ABB2BF"},"children":") {"}]]}]
43:["$","span","span-21",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"      if"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":" ("}],["$","span","span-2",{"style":{"color":"#E5C07B"},"children":"result"}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-4",{"style":{"color":"#E06C75"},"children":"error"}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":") {"}]]}]
44:["$","span","span-22",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"        const"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":" { "}],["$","span","span-2",{"style":{"color":"#E5C07B"},"children":"code"}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":", "}],["$","span","span-4",{"style":{"color":"#E5C07B"},"children":"message"}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":" } "}],["$","span","span-6",{"style":{"color":"#56B6C2"},"children":"="}],["$","span","span-7",{"style":{"color":"#E5C07B"},"children":" result"}],["$","span","span-8",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-9",{"style":{"color":"#E06C75"},"children":"error"}],["$","span","span-10",{"style":{"color":"#ABB2BF"},"children":";"}]]}]
45:["$","span","span-23",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"        return"}],["$","span","span-1",{"style":{"color":"#C678DD"},"children":" new"}],["$","span","span-2",{"style":{"color":"#61AFEF"},"children":" Error"}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-4",{"style":{"color":"#98C379"},"children":"`Unexpected error ("}],["$","span","span-5",{"style":{"color":"#C678DD"},"children":"$${"}],["$","span","span-6",{"style":{"color":"#E06C75"},"children":"code"}],["$","span","span-7",{"style":{"color":"#C678DD"},"children":"}"}],["$","span","span-8",{"style":{"color":"#98C379"},"children":"): "}],["$","span","span-9",{"style":{"color":"#C678DD"},"children":"$${"}],["$","span","span-10",{"style":{"color":"#E06C75"},"children":"message"}],["$","span","span-11",{"style":{"color":"#C678DD"},"children":"}"}],["$","span","span-12",{"style":{"color":"#98C379"},"children":"`"}],["$","span","span-13",{"style":{"color":"#ABB2BF"},"children":");"}]]}]
46:["$","span","span-24",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#ABB2BF"},"children":"      }"}]}]
47:["$","span","span-25",{"data-line":"","children":" "}]
48:["$","span","span-26",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#7F848E","fontStyle":"italic"},"children":"      // 返回输出的结果"}]}]
49:["$","span","span-27",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"      return"}],["$","span","span-1",{"style":{"color":"#E5C07B"},"children":" result"}],["$","span","span-2",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-3",{"style":{"color":"#E5C07B"},"children":"summaries"}],["$","span","span-4",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-5",{"style":{"color":"#61AFEF"},"children":"map"}],["$","span","span-6",{"style":{"color":"#ABB2BF"},"children":"(("}],["$","span","span-7",{"style":{"color":"#E06C75","fontStyle":"italic"},"children":"x"}],["$","span","span-8",{"style":{"color":"#ABB2BF"},"children":") "}],["$","span","span-9",{"style":{"color":"#C678DD"},"children":"=>"}],["$","span","span-10",{"style":{"color":"#E5C07B"},"children":" x"}],["$","span","span-11",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-12",{"style":{"color":"#E06C75"},"children":"text"}],["$","span","span-13",{"style":{"color":"#ABB2BF"},"children":");"}]]}]
4a:["$","span","span-28",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#ABB2BF"},"children":"    }"}]}]
4b:["$","span","span-29",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#ABB2BF"},"children":"  }"}]}]
4c:["$","span","span-30",{"data-line":"","children":" "}]
4d:["$","span","span-31",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"  throw"}],["$","span","span-1",{"style":{"color":"#C678DD"},"children":" new"}],["$","span","span-2",{"style":{"color":"#61AFEF"},"children":" Error"}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-4",{"style":{"color":"#98C379"},"children":"\"No result\""}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":");"}]]}]
4e:["$","span","span-32",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#ABB2BF"},"children":"}"}]}]
4f:["$","span","span-33",{"data-line":"","children":" "}]
50:["$","span","span-34",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"async"}],["$","span","span-1",{"style":{"color":"#C678DD"},"children":" function"}],["$","span","span-2",{"style":{"color":"#61AFEF"},"children":" summarizeArticle"}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-4",{"style":{"color":"#E06C75","fontStyle":"italic"},"children":"articleDir"}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":": "}],["$","span","span-6",{"style":{"color":"#E5C07B"},"children":"string"}],["$","span","span-7",{"style":{"color":"#ABB2BF"},"children":") {"}]]}]
51:["$","span","span-35",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#7F848E","fontStyle":"italic"},"children":"  // 获取此文章的所有markdown文件"}]}]
52:["$","span","span-36",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"  const"}],["$","span","span-1",{"style":{"color":"#E5C07B"},"children":" mdFiles"}],["$","span","span-2",{"style":{"color":"#56B6C2"},"children":" ="}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":" ("}],["$","span","span-4",{"style":{"color":"#C678DD"},"children":"await"}],["$","span","span-5",{"style":{"color":"#61AFEF"},"children":" readdir"}],["$","span","span-6",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-7",{"style":{"color":"#E06C75"},"children":"articleDir"}],["$","span","span-8",{"style":{"color":"#ABB2BF"},"children":"))."}],["$","span","span-9",{"style":{"color":"#61AFEF"},"children":"filter"}],["$","span","span-10",{"style":{"color":"#ABB2BF"},"children":"(("}],["$","span","span-11",{"style":{"color":"#E06C75","fontStyle":"italic"},"children":"x"}],["$","span","span-12",{"style":{"color":"#ABB2BF"},"children":") "}],["$","span","span-13",{"style":{"color":"#C678DD"},"children":"=>"}],["$","span","span-14",{"style":{"color":"#E5C07B"},"children":" x"}],["$","span","span-15",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-16",{"style":{"color":"#61AFEF"},"children":"endsWith"}],["$","span","span-17",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-18",{"style":{"color":"#98C379"},"children":"\".md\""}],["$","span","span-19",{"style":{"color":"#ABB2BF"},"children":"));"}]]}]
53:["$","span","span-37",{"data-line":"","children":" "}]
54:["$","span","span-38",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"  for"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":" ("}],["$","span","span-2",{"style":{"color":"#C678DD"},"children":"const"}],["$","span","span-3",{"style":{"color":"#E5C07B"},"children":" mdFile"}],["$","span","span-4",{"style":{"color":"#C678DD"},"children":" of"}],["$","span","span-5",{"style":{"color":"#E06C75"},"children":" mdFiles"}],["$","span","span-6",{"style":{"color":"#ABB2BF"},"children":") {"}]]}]
55:["$","span","span-39",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"    const"}],["$","span","span-1",{"style":{"color":"#E5C07B"},"children":" mdFilePath"}],["$","span","span-2",{"style":{"color":"#56B6C2"},"children":" ="}],["$","span","span-3",{"style":{"color":"#61AFEF"},"children":" join"}],["$","span","span-4",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-5",{"style":{"color":"#E06C75"},"children":"articleDir"}],["$","span","span-6",{"style":{"color":"#ABB2BF"},"children":", "}],["$","span","span-7",{"style":{"color":"#E06C75"},"children":"mdFile"}],["$","span","span-8",{"style":{"color":"#ABB2BF"},"children":");"}]]}]
56:["$","span","span-40",{"data-line":"","children":" "}]
57:["$","span","span-41",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#7F848E","fontStyle":"italic"},"children":"    // 读取并解析文章内容"}]}]
58:["$","span","span-42",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"    const"}],["$","span","span-1",{"style":{"color":"#E5C07B"},"children":" mdContent"}],["$","span","span-2",{"style":{"color":"#56B6C2"},"children":" ="}],["$","span","span-3",{"style":{"color":"#C678DD"},"children":" await"}],["$","span","span-4",{"style":{"color":"#61AFEF"},"children":" readFile"}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-6",{"style":{"color":"#E06C75"},"children":"mdFilePath"}],["$","span","span-7",{"style":{"color":"#ABB2BF"},"children":", "}],["$","span","span-8",{"style":{"color":"#98C379"},"children":"\"utf-8\""}],["$","span","span-9",{"style":{"color":"#ABB2BF"},"children":");"}]]}]
59:["$","span","span-43",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"    const"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":" { "}],["$","span","span-2",{"style":{"color":"#E06C75"},"children":"data"}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":": "}],["$","span","span-4",{"style":{"color":"#E5C07B"},"children":"frontMatter"}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":", "}],["$","span","span-6",{"style":{"color":"#E5C07B"},"children":"content"}],["$","span","span-7",{"style":{"color":"#ABB2BF"},"children":" } "}],["$","span","span-8",{"style":{"color":"#56B6C2"},"children":"="}],["$","span","span-9",{"style":{"color":"#61AFEF"},"children":" matter"}],["$","span","span-10",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-11",{"style":{"color":"#E06C75"},"children":"mdContent"}],["$","span","span-12",{"style":{"color":"#ABB2BF"},"children":");"}]]}]
5a:["$","span","span-44",{"data-line":"","children":" "}]
5b:["$","span","span-45",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#7F848E","fontStyle":"italic"},"children":"    // 计算并更新文章Hash，如果文章内容hash没有变，之后就不要重新生成总结了"}]}]
5c:["$","span","span-46",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"    const"}],["$","span","span-1",{"style":{"color":"#E5C07B"},"children":" contentHash"}],["$","span","span-2",{"style":{"color":"#56B6C2"},"children":" ="}],["$","span","span-3",{"style":{"color":"#61AFEF"},"children":" hashContent"}],["$","span","span-4",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-5",{"style":{"color":"#E06C75"},"children":"content"}],["$","span","span-6",{"style":{"color":"#ABB2BF"},"children":");"}]]}]
5d:["$","span","span-47",{"data-line":"","children":" "}]
5e:["$","span","span-48",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"    const"}],["$","span","span-1",{"style":{"color":"#E5C07B"},"children":" summaryJsonFilePath"}],["$","span","span-2",{"style":{"color":"#56B6C2"},"children":" ="}],["$","span","span-3",{"style":{"color":"#61AFEF"},"children":" join"}],["$","span","span-4",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-5",{"style":{"color":"#E06C75"},"children":"articleDir"}],["$","span","span-6",{"style":{"color":"#ABB2BF"},"children":", "}],["$","span","span-7",{"style":{"color":"#98C379"},"children":"`"}],["$","span","span-8",{"style":{"color":"#C678DD"},"children":"$${"}],["$","span","span-9",{"style":{"color":"#E5C07B"},"children":"frontMatter"}],["$","span","span-10",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-11",{"style":{"color":"#E06C75"},"children":"lang"}],["$","span","span-12",{"style":{"color":"#C678DD"},"children":"}"}],["$","span","span-13",{"style":{"color":"#98C379"},"children":".summary.json`"}],["$","span","span-14",{"style":{"color":"#ABB2BF"},"children":");"}]]}]
5f:["$","span","span-49",{"data-line":"","children":" "}]
60:["$","span","span-50",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"    if"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":" ("}],["$","span","span-2",{"style":{"color":"#61AFEF"},"children":"existsSync"}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-4",{"style":{"color":"#E06C75"},"children":"summaryJsonFilePath"}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":") "}],["$","span","span-6",{"style":{"color":"#56B6C2"},"children":"&&"}],["$","span","span-7",{"style":{"color":"#ABB2BF"},"children":" ("}],["$","span","span-8",{"style":{"color":"#C678DD"},"children":"await"}],["$","span","span-9",{"style":{"color":"#61AFEF"},"children":" stat"}],["$","span","span-10",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-11",{"style":{"color":"#E06C75"},"children":"summaryJsonFilePath"}],["$","span","span-12",{"style":{"color":"#ABB2BF"},"children":"))."}],["$","span","span-13",{"style":{"color":"#61AFEF"},"children":"isFile"}],["$","span","span-14",{"style":{"color":"#ABB2BF"},"children":"()) {"}]]}]
61:["$","span","span-51",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"      const"}],["$","span","span-1",{"style":{"color":"#E5C07B"},"children":" existingSummaryJson"}],["$","span","span-2",{"style":{"color":"#ABB2BF"},"children":": "}],["$","span","span-3",{"style":{"color":"#E5C07B"},"children":"ArticleSummary"}],["$","span","span-4",{"style":{"color":"#56B6C2"},"children":" ="}],["$","span","span-5",{"style":{"color":"#E5C07B"},"children":" JSON"}],["$","span","span-6",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-7",{"style":{"color":"#61AFEF"},"children":"parse"}],["$","span","span-8",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-9",{"style":{"color":"#C678DD"},"children":"await"}],["$","span","span-10",{"style":{"color":"#61AFEF"},"children":" readFile"}],["$","span","span-11",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-12",{"style":{"color":"#E06C75"},"children":"summaryJsonFilePath"}],["$","span","span-13",{"style":{"color":"#ABB2BF"},"children":", "}],["$","span","span-14",{"style":{"color":"#98C379"},"children":"\"utf-8\""}],["$","span","span-15",{"style":{"color":"#ABB2BF"},"children":"));"}]]}]
62:["$","span","span-52",{"data-line":"","children":" "}]
63:["$","span","span-53",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#E5C07B"},"children":"      existingSummaryJson"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-2",{"style":{"color":"#E06C75"},"children":"hash"}],["$","span","span-3",{"style":{"color":"#56B6C2"},"children":" ="}],["$","span","span-4",{"style":{"color":"#E06C75"},"children":" contentHash"}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":";"}]]}]
64:["$","span","span-54",{"data-line":"","children":" "}]
65:["$","span","span-55",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"      if"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":" ("}],["$","span","span-2",{"style":{"color":"#E06C75"},"children":"contentHash"}],["$","span","span-3",{"style":{"color":"#56B6C2"},"children":" ==="}],["$","span","span-4",{"style":{"color":"#E5C07B"},"children":" existingSummaryJson"}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-6",{"style":{"color":"#E06C75"},"children":"hash"}],["$","span","span-7",{"style":{"color":"#ABB2BF"},"children":") {"}]]}]
66:["$","span","span-56",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#61AFEF"},"children":"        log"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-2",{"style":{"color":"#98C379"},"children":"\"log\""}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":", "}],["$","span","span-4",{"style":{"color":"#98C379"},"children":"\"Content is not changed after the last summarization. Skip summarization.\""}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":");"}]]}]
67:["$","span","span-57",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"        continue"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":";"}]]}]
68:["$","span","span-58",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#ABB2BF"},"children":"      }"}]}]
69:["$","span","span-59",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#ABB2BF"},"children":"    }"}]}]
6a:["$","span","span-60",{"data-line":"","children":" "}]
6b:["$","span","span-61",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#7F848E","fontStyle":"italic"},"children":"    // 总结文本"}]}]
6c:["$","span","span-62",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"    const"}],["$","span","span-1",{"style":{"color":"#E5C07B"},"children":" summary"}],["$","span","span-2",{"style":{"color":"#56B6C2"},"children":" ="}],["$","span","span-3",{"style":{"color":"#C678DD"},"children":" await"}],["$","span","span-4",{"style":{"color":"#61AFEF"},"children":" summarize"}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-6",{"style":{"color":"#E06C75"},"children":"content"}],["$","span","span-7",{"style":{"color":"#ABB2BF"},"children":","}]]}]
6d:["$","span","span-63",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#E06C75"},"children":"      azureLanguageCodeMap"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":"["}],["$","span","span-2",{"style":{"color":"#E5C07B"},"children":"frontMatter"}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-4",{"style":{"color":"#E06C75"},"children":"lang"}],["$","span","span-5",{"style":{"color":"#C678DD"},"children":" as"}],["$","span","span-6",{"style":{"color":"#C678DD"},"children":" keyof"}],["$","span","span-7",{"style":{"color":"#C678DD"},"children":" typeof"}],["$","span","span-8",{"style":{"color":"#E06C75"},"children":" azureLanguageCodeMap"}],["$","span","span-9",{"style":{"color":"#ABB2BF"},"children":"]);"}]]}]
6e:["$","span","span-64",{"data-line":"","children":" "}]
6f:["$","span","span-65",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"    if"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":" ("}],["$","span","span-2",{"style":{"color":"#E06C75"},"children":"summary"}],["$","span","span-3",{"style":{"color":"#C678DD"},"children":" instanceof"}],["$","span","span-4",{"style":{"color":"#E5C07B"},"children":" Error"}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":") {"}]]}]
70:["$","span","span-66",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#61AFEF"},"children":"      log"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-2",{"style":{"color":"#98C379"},"children":"\"error\""}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":", "}],["$","span","span-4",{"style":{"color":"#98C379"},"children":"\"Error on summarizing %s of lang %s: %s\""}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":", "}],["$","span","span-6",{"style":{"color":"#E5C07B"},"children":"frontMatter"}],["$","span","span-7",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-8",{"style":{"color":"#E06C75"},"children":"id"}],["$","span","span-9",{"style":{"color":"#ABB2BF"},"children":", "}],["$","span","span-10",{"style":{"color":"#E5C07B"},"children":"frontMatter"}],["$","span","span-11",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-12",{"style":{"color":"#E06C75"},"children":"lang"}],["$","span","span-13",{"style":{"color":"#ABB2BF"},"children":", "}],["$","span","span-14",{"style":{"color":"#E5C07B"},"children":"summary"}],["$","span","span-15",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-16",{"style":{"color":"#E06C75"},"children":"message"}],["$","span","span-17",{"style":{"color":"#ABB2BF"},"children":");"}]]}]
71:["$","span","span-67",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"      continue"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":";"}]]}]
72:["$","span","span-68",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#ABB2BF"},"children":"    }"}]}]
73:["$","span","span-69",{"data-line":"","children":" "}]
74:["$","span","span-70",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#7F848E","fontStyle":"italic"},"children":"    // 在文章目录下生成一个[语言id].summary.json文件，存放内容hash、总结以及相关操作信息"}]}]
75:["$","span","span-71",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"    const"}],["$","span","span-1",{"style":{"color":"#E5C07B"},"children":" summaryJson"}],["$","span","span-2",{"style":{"color":"#ABB2BF"},"children":": "}],["$","span","span-3",{"style":{"color":"#E5C07B"},"children":"ArticleSummary"}],["$","span","span-4",{"style":{"color":"#56B6C2"},"children":" ="}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":" {"}]]}]
76:["$","span","span-72",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#E06C75"},"children":"      articleId"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":": "}],["$","span","span-2",{"style":{"color":"#E5C07B"},"children":"frontMatter"}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-4",{"style":{"color":"#E06C75"},"children":"id"}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":","}]]}]
77:["$","span","span-73",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#E06C75"},"children":"      lang"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":": "}],["$","span","span-2",{"style":{"color":"#E5C07B"},"children":"frontMatter"}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-4",{"style":{"color":"#E06C75"},"children":"lang"}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":","}]]}]
78:["$","span","span-74",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#E06C75"},"children":"      lastUpdateStartTime"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":": "}],["$","span","span-2",{"style":{"color":"#E06C75"},"children":"startTime"}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":","}]]}]
79:["$","span","span-75",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#E06C75"},"children":"      lastUpdateEndTime"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":": "}],["$","span","span-2",{"style":{"color":"#C678DD"},"children":"new"}],["$","span","span-3",{"style":{"color":"#61AFEF"},"children":" Date"}],["$","span","span-4",{"style":{"color":"#ABB2BF"},"children":"()."}],["$","span","span-5",{"style":{"color":"#61AFEF"},"children":"toISOString"}],["$","span","span-6",{"style":{"color":"#ABB2BF"},"children":"(),"}]]}]
7a:["$","span","span-76",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#E06C75"},"children":"      summaries"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":": "}],["$","span","span-2",{"style":{"color":"#E06C75"},"children":"summary"}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":","}]]}]
7b:["$","span","span-77",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#E06C75"},"children":"      hash"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":": "}],["$","span","span-2",{"style":{"color":"#E06C75"},"children":"contentHash"}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":","}]]}]
7c:["$","span","span-78",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#ABB2BF"},"children":"    };"}]}]
7d:["$","span","span-79",{"data-line":"","children":" "}]
7e:["$","span","span-80",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#61AFEF"},"children":"    log"}],["$","span","span-1",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-2",{"style":{"color":"#98C379"},"children":"\"log\""}],["$","span","span-3",{"style":{"color":"#ABB2BF"},"children":", "}],["$","span","span-4",{"style":{"color":"#98C379"},"children":"\"Write summary of %s of lang %s to %s\""}],["$","span","span-5",{"style":{"color":"#ABB2BF"},"children":", "}],["$","span","span-6",{"style":{"color":"#E5C07B"},"children":"frontMatter"}],["$","span","span-7",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-8",{"style":{"color":"#E06C75"},"children":"id"}],["$","span","span-9",{"style":{"color":"#ABB2BF"},"children":", "}],["$","span","span-10",{"style":{"color":"#E5C07B"},"children":"frontMatter"}],["$","span","span-11",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-12",{"style":{"color":"#E06C75"},"children":"lang"}],["$","span","span-13",{"style":{"color":"#ABB2BF"},"children":", "}],["$","span","span-14",{"style":{"color":"#E06C75"},"children":"summaryJsonFilePath"}],["$","span","span-15",{"style":{"color":"#ABB2BF"},"children":");"}]]}]
7f:["$","span","span-81",{"data-line":"","children":" "}]
80:["$","span","span-82",{"data-line":"","children":[["$","span","span-0",{"style":{"color":"#C678DD"},"children":"    await"}],["$","span","span-1",{"style":{"color":"#61AFEF"},"children":" writeFile"}],["$","span","span-2",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-3",{"style":{"color":"#E06C75"},"children":"summaryJsonFilePath"}],["$","span","span-4",{"style":{"color":"#ABB2BF"},"children":", "}],["$","span","span-5",{"style":{"color":"#E5C07B"},"children":"JSON"}],["$","span","span-6",{"style":{"color":"#ABB2BF"},"children":"."}],["$","span","span-7",{"style":{"color":"#61AFEF"},"children":"stringify"}],["$","span","span-8",{"style":{"color":"#ABB2BF"},"children":"("}],["$","span","span-9",{"style":{"color":"#E06C75"},"children":"summaryJson"}],["$","span","span-10",{"style":{"color":"#ABB2BF"},"children":", "}],["$","span","span-11",{"style":{"color":"#D19A66"},"children":"null"}],["$","span","span-12",{"style":{"color":"#ABB2BF"},"children":", "}],["$","span","span-13",{"style":{"color":"#D19A66"},"children":"2"}],["$","span","span-14",{"style":{"color":"#ABB2BF"},"children":"));"}]]}]
81:["$","span","span-83",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#ABB2BF"},"children":"  }"}]}]
82:["$","span","span-84",{"data-line":"","children":["$","span","span-0",{"style":{"color":"#ABB2BF"},"children":"}"}]}]
83:["$","span","span-85",{"data-line":"","children":" "}]
