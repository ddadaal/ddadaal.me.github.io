1:"$Sreact.fragment"
2:I[28979,["/_next/static/chunks/8d29a04bcfe27c24.js","/_next/static/chunks/3dff3d4c63cf346e.js","/_next/static/chunks/b3af52d5d180873a.js","/_next/static/chunks/86b442c1397f7351.js","/_next/static/chunks/0a1497ca0a1721ad.js","/_next/static/chunks/4ec1bf7a32b70f87.js","/_next/static/chunks/276b22541034e0ea.js"],"ArticleFrontmatter"]
c:I[21753,["/_next/static/chunks/8d29a04bcfe27c24.js","/_next/static/chunks/3dff3d4c63cf346e.js","/_next/static/chunks/b3af52d5d180873a.js","/_next/static/chunks/86b442c1397f7351.js","/_next/static/chunks/0a1497ca0a1721ad.js","/_next/static/chunks/4ec1bf7a32b70f87.js","/_next/static/chunks/276b22541034e0ea.js"],"ArticleSummarization"]
d:I[79817,["/_next/static/chunks/8d29a04bcfe27c24.js","/_next/static/chunks/3dff3d4c63cf346e.js","/_next/static/chunks/b3af52d5d180873a.js","/_next/static/chunks/86b442c1397f7351.js","/_next/static/chunks/0a1497ca0a1721ad.js","/_next/static/chunks/4ec1bf7a32b70f87.js","/_next/static/chunks/276b22541034e0ea.js"],"Gallery"]
30:I[23491,["/_next/static/chunks/2caa33a942c5f527.js","/_next/static/chunks/59983278a34fd25c.js"],"OutletBoundary"]
31:"$Sreact.suspense"
33:I[72053,["/_next/static/chunks/8d29a04bcfe27c24.js","/_next/static/chunks/3dff3d4c63cf346e.js","/_next/static/chunks/b3af52d5d180873a.js","/_next/static/chunks/86b442c1397f7351.js","/_next/static/chunks/0a1497ca0a1721ad.js","/_next/static/chunks/4ec1bf7a32b70f87.js","/_next/static/chunks/276b22541034e0ea.js"],"ArticleImage"]
37:I[14620,["/_next/static/chunks/8d29a04bcfe27c24.js","/_next/static/chunks/3dff3d4c63cf346e.js","/_next/static/chunks/b3af52d5d180873a.js","/_next/static/chunks/86b442c1397f7351.js","/_next/static/chunks/0a1497ca0a1721ad.js","/_next/static/chunks/4ec1bf7a32b70f87.js","/_next/static/chunks/276b22541034e0ea.js"],"ArticleToc"]
38:I[39182,["/_next/static/chunks/8d29a04bcfe27c24.js","/_next/static/chunks/3dff3d4c63cf346e.js","/_next/static/chunks/b3af52d5d180873a.js","/_next/static/chunks/86b442c1397f7351.js","/_next/static/chunks/0a1497ca0a1721ad.js","/_next/static/chunks/4ec1bf7a32b70f87.js","/_next/static/chunks/276b22541034e0ea.js"],"RelatedArticles"]
39:I[42449,["/_next/static/chunks/8d29a04bcfe27c24.js","/_next/static/chunks/3dff3d4c63cf346e.js","/_next/static/chunks/b3af52d5d180873a.js","/_next/static/chunks/86b442c1397f7351.js","/_next/static/chunks/0a1497ca0a1721ad.js","/_next/static/chunks/4ec1bf7a32b70f87.js","/_next/static/chunks/276b22541034e0ea.js"],"CommentPanelWithCurrentLanguage"]
:HL["/_next/static/chunks/44d2e091595b3eca.css","style"]
:HL["/_next/static/chunks/5e55d74f3211c796.css","style"]
:HL["/_next/static/chunks/b59bad6ea4f112f2.css","style"]
3:Tfc4,
## 前言

因为VS2017是我的刚需（和Azure的交互以及个人的喜好），所以当插件可以下载的时候，我直接解包修改了插件的配置文件从而在VS2017上运行。我以为就这样我就可以用VS2017而不需要虚拟机装VS2013了，但事实还是证明我太年轻了……

## 错误

在VS2017上运行插件，运行测试时，会弹出如下的错误提示。

![](./error-on-vs.png)

## 找错

为了找到这个的原因，使用免费的JetBrains的[dotPeek](https://www.jetbrains.com/decompiler)工具对CppPlugin工具解包出的**CppPlugin.dll**文件进行反编译并导出成解决方案到VS里查看。

![](./decompile.png)

导出到VS后，需要在nuget里安装**Microsoft.VisualStudio.Shell**和**EnvDTE**依赖以正常获得InteliSense提示。否则就要去翻MSDN……

通过查找报错的字符串*获取可执行文件路径出错*直接定位出错的位置，可以发现相关代码路径是`Controller/imp/TestControllerImp.cs`的`CallResult RunTest(string)`方法。

![](./throw-exception.png)

图中`get_Solution()`、`get_Name()`等语句不是错误，它们是C#的属性编译后的代码。在自己程序中，如需访问`Solution`等属性，**只能**直接`.Solution`，不能直接调用`get_Solution()`代码。

更具体来说，是下部`if (current.Name.Equals(toProjectNameMap[qid])`块中的赋值语句。

```CSharp
path1_1 = current.get_ConfigurationManager().ConfigurationRow("Debug").Item((object) 1).get_Properties().Item((object) "OutputPath").get_Value().ToString();
```

这句话非常长，有很多函数调用。

为了弄清楚具体哪一个调用出错，我新建了一个**全新的VSIX扩展程序**项目，并在点击事件响应中加入了这个方法。

![](./new-vs-extension.png)

在调试中的VS实例中新建一个C++控制台程序，点击菜单按钮，发现如下结果：

![](./test-new-extension.png)

**Properties是null，Item(1)返回的是一个COM对象，无法获得值。**

这就是错误所在了。

## 社区
微软的相关文档中并没有提到任何相关API在VS2017中的变化。

[Configurations.Item(Object)方法](https://docs.microsoft.com/en-us/dotnet/api/envdte.configurations.item?view=visualstudiosdk-2017#EnvDTE_Configurations_Item_System_Object_)

[Configuration.Properties属性](https://docs.microsoft.com/en-us/dotnet/api/envdte.configuration.properties?view=visualstudiosdk-2017#EnvDTE_Configuration_Properties)

同时，在StackOverflow下有类似问题：

[Configuration.Properties object returning null in Visual Studio 2017 VSIX extension
](https://stackoverflow.com/questions/43418796/configuration-properties-object-returning-null-in-visual-studio-2017-vsix-extens)

按描述，题主也是有一个**C++相关的扩展程序**，相同代码在VS2015中能够运行，而在VS2017中出现错误。题主最后提出了一个可用解决方案。如有兴趣请点进去查看，这里就不搬运了。


在官方社区中也有相关问题[ConfigurationManager.ActiveConfiguration.Properties is empty for c++ projects in Visual Studio Extensions](https://developercommunity.visualstudio.com/content/problem/5500/configurationmanageractiveconfigurationproperties.html)，微软官方并未给出有效回答，却以*有效信息不足*的理由关闭了这个问题。这就非常滑稽了。

>Thank you for your feedback! Unfortunately, we don’t have enough information to narrow down this issue and find a solution. If this is still an issue for you, we recommend that you upgrade to the latest version via the in-product notification or from here: https://www.visualstudio.com.  If the problem should again occur, please let us know by creating a new problem report using the latest version.

## 总结
总的来说，这个插件不兼容VS2017，是**微软的锅**：API变动却没有在任何地方体现（~~可能这是个feature吧~~）。请大家可以不折腾这个插件了，安心用虚拟机或者实机安装VS2013吧！
0:{"buildId":"7i2WQvz7gDPo6cUsqOuKv","rsc":["$","$1","c",{"children":[["$","article",null,{"children":[["$","div",null,{"className":"bg-neutral px-4 py-8","children":["$","div",null,{"className":"max-w-7xl mx-auto min-h-[256px] flex justify-center text-center text-neutral-content","children":["$","div",null,{"className":"flex flex-col justify-center animate-slide-up","children":[["$","h1",null,{"className":"text-4xl my-2","children":"C++插件在VS2017上无法使用的分析"}],["$","$L2",null,{"className":"justify-center","articleId":"analysis-on-cpp-plugin-not-running-at-vs2017","info":{"content":"$3","title":"C++插件在VS2017上无法使用的分析","date":"2017-09-27 20:32","id":"analysis-on-cpp-plugin-not-running-at-vs2017","lang":"cn","tags":["C++","problem-investigation"],"wordCount":757,"readingTime":3.785,"filePath":"contents/20170927-C++插件在VS2017上无法使用的分析/index.md","summary":{"articleId":"analysis-on-cpp-plugin-not-running-at-vs2017","lang":"cn","hash":"f2c967cfa0ea44e2ce3016bbab446149f257798fe60ba03fceb5ce972fecb82a","summaries":[{"metadata":{"summarizer":"azure-ai","model":"DeepSeek-R1"},"summaries":["作者在VS2017中使用CppPlugin插件时出现“获取可执行文件路径出错”，反编译定位到TestControllerImp.cs中通过ConfigurationManager获取输出路径的代码存在异常。测试发现VS2017的Configuration.Properties返回null，导致API失效。微软未在文档提及该变动，社区反馈类似问题均未解决，确认为VS2017兼容性问题。结论为微软API变动导致插件无法适配，建议继续使用VS2013或虚拟机方案。"],"startTime":"2025-02-14T13:21:43.451Z","endTime":"2025-02-14T13:22:06.500Z"},{"metadata":{"summarizer":"ollama","model":"deepseek-r1:8b"},"summaries":["这篇文章讲述了用户尝试将插件从VS2013迁移到VS2017时遇到的问题。最初，他希望通过直接解包并修改插件配置文件，在VS2017中运行插件，但在运行测试时出现错误。通过反编译和分析，发现错误出现在C#代码中的属性访问方式上，特别是Solution和Name的调用方法。\n\n进一步调试显示，插件中涉及ConfigurationManager的使用出现了问题，尤其是在获取配置输出路径时，Properties对象返回null。此外，用户尝试创建新的VSIX扩展项目进行测试，发现同样的错误：Properties为null，无法访问特定项。这表明问题可能与VS2017 API的变化有关。\n\n虽然微软文档中没有详细说明相关API的变动，但StackOverflow和开发者社区有类似的问题报告。用户提到在该平台找到了一些解决方案，但微软官方问题闭锁，未给出有效回复。这让用户感到不满，并建议读者放弃修复插件，直接使用虚拟机或实机安装VS2013。\n\n总结来说，这个问题是由于插件与VS2017的API变化不兼容，用户认为这是微软的问题，没有提供明确的解决方案。最终，他建议继续使用旧版本工具来避免麻烦。"]}]}},"langVersions":["cn"]}]]}]}]}],"$L4"]}],["$L5","$L6","$L7","$L8","$L9","$La"],"$Lb"]}],"loading":null,"isPartial":false}
e:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959zf:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z4:["$","div",null,{"className":"animate-slide-up","children":[["$","div",null,{"className":"max-w-7xl mx-auto p-4","children":["$","div",null,{"className":"flex flex-row space-x-4","children":[["$","div",null,{"className":"prose max-w-full lg:w-[75%]","children":[["$","$Lc",null,{"summaries":[{"metadata":{"summarizer":"azure-ai","model":"DeepSeek-R1"},"children":[["$","p","p-0",{"children":"作者在VS2017中使用CppPlugin插件时出现“获取可执行文件路径出错”，反编译定位到TestControllerImp.cs中通过ConfigurationManager获取输出路径的代码存在异常。测试发现VS2017的Configuration.Properties返回null，导致API失效。微软未在文档提及该变动，社区反馈类似问题均未解决，确认为VS2017兼容性问题。结论为微软API变动导致插件无法适配，建议继续使用VS2013或虚拟机方案。"}]]},{"metadata":{"summarizer":"ollama","model":"deepseek-r1:8b"},"children":[["$","p","p-0",{"children":"这篇文章讲述了用户尝试将插件从VS2013迁移到VS2017时遇到的问题。最初，他希望通过直接解包并修改插件配置文件，在VS2017中运行插件，但在运行测试时出现错误。通过反编译和分析，发现错误出现在C#代码中的属性访问方式上，特别是Solution和Name的调用方法。"}],"\n",["$","p","p-1",{"children":"进一步调试显示，插件中涉及ConfigurationManager的使用出现了问题，尤其是在获取配置输出路径时，Properties对象返回null。此外，用户尝试创建新的VSIX扩展项目进行测试，发现同样的错误：Properties为null，无法访问特定项。这表明问题可能与VS2017 API的变化有关。"}],"\n",["$","p","p-2",{"children":"虽然微软文档中没有详细说明相关API的变动，但StackOverflow和开发者社区有类似的问题报告。用户提到在该平台找到了一些解决方案，但微软官方问题闭锁，未给出有效回复。这让用户感到不满，并建议读者放弃修复插件，直接使用虚拟机或实机安装VS2013。"}],"\n",["$","p","p-3",{"children":"总结来说，这个问题是由于插件与VS2017的API变化不兼容，用户认为这是微软的问题，没有提供明确的解决方案。最终，他建议继续使用旧版本工具来避免麻烦。"}]]}]}],["$","$Ld",null,{"withCaption":true,"id":"analysis-on-cpp-plugin-not-running-at-vs2017","children":[["$","h2","h2-0",{"id":"前言","children":[["$","a","前言",{"href":"#前言","className":"mr-1","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 512 512","className":"inline-block opacity-20 hover:opacity-60","children":["$undefined",[["$","path","0",{"d":"$e","children":[]}]]],"style":{},"height":16,"width":16,"xmlns":"http://www.w3.org/2000/svg"}]}],"前言"]}],"\n",["$","p","p-0",{"children":"因为VS2017是我的刚需（和Azure的交互以及个人的喜好），所以当插件可以下载的时候，我直接解包修改了插件的配置文件从而在VS2017上运行。我以为就这样我就可以用VS2017而不需要虚拟机装VS2013了，但事实还是证明我太年轻了……"}],"\n",["$","h2","h2-1",{"id":"错误","children":[["$","a","错误",{"href":"#错误","className":"mr-1","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 512 512","className":"inline-block opacity-20 hover:opacity-60","children":["$undefined",[["$","path","0",{"d":"$f","children":[]}]]],"style":{},"height":16,"width":16,"xmlns":"http://www.w3.org/2000/svg"}]}],"错误"]}],"\n","$L10","\n","$L11","\n","$L12","\n","$L13","\n","$L14","\n","$L15","\n","$L16","\n","$L17","\n","$L18","\n","$L19","\n","$L1a","\n","$L1b","\n","$L1c","\n","$L1d","\n","$L1e","\n","$L1f","\n","$L20","\n","$L21","\n","$L22","\n","$L23","\n","$L24","\n","$L25","\n","$L26","\n","$L27","\n","$L28","\n","$L29","\n","$L2a","\n","$L2b","\n","$L2c"]}]]}],"$L2d"]}]}],"$L2e","$L2f"]}]
5:["$","link","0",{"rel":"stylesheet","href":"/_next/static/chunks/44d2e091595b3eca.css","precedence":"next"}]
6:["$","link","1",{"rel":"stylesheet","href":"/_next/static/chunks/5e55d74f3211c796.css","precedence":"next"}]
7:["$","link","2",{"rel":"stylesheet","href":"/_next/static/chunks/b59bad6ea4f112f2.css","precedence":"next"}]
8:["$","script","script-0",{"src":"/_next/static/chunks/0a1497ca0a1721ad.js","async":true}]
9:["$","script","script-1",{"src":"/_next/static/chunks/4ec1bf7a32b70f87.js","async":true}]
a:["$","script","script-2",{"src":"/_next/static/chunks/276b22541034e0ea.js","async":true}]
b:["$","$L30",null,{"children":["$","$31",null,{"name":"Next.MetadataOutlet","children":"$@32"}]}]
10:["$","p","p-1",{"children":"在VS2017上运行插件，运行测试时，会弹出如下的错误提示。"}]
11:["$","p","p-2",{"children":["$","$L33","img-0",{"src":"/articles/asset/contents/20170927-C++插件在VS2017上无法使用的分析/error-on-vs.png","imageSize":{"height":1040,"width":1920},"imageProps":{"src":"./error-on-vs.png","alt":""}}]}]
34:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z12:["$","h2","h2-2",{"id":"找错","children":[["$","a","找错",{"href":"#找错","className":"mr-1","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 512 512","className":"inline-block opacity-20 hover:opacity-60","children":["$undefined",[["$","path","0",{"d":"$34","children":[]}]]],"style":{},"height":16,"width":16,"xmlns":"http://www.w3.org/2000/svg"}]}],"找错"]}]
13:["$","p","p-3",{"children":["为了找到这个的原因，使用免费的JetBrains的",["$","a","a-0",{"href":"https://www.jetbrains.com/decompiler","children":"dotPeek"}],"工具对CppPlugin工具解包出的",["$","strong","strong-0",{"children":"CppPlugin.dll"}],"文件进行反编译并导出成解决方案到VS里查看。"]}]
14:["$","p","p-4",{"children":["$","$L33","img-0",{"src":"/articles/asset/contents/20170927-C++插件在VS2017上无法使用的分析/decompile.png","imageSize":{"height":912,"width":1539},"imageProps":{"src":"./decompile.png","alt":""}}]}]
15:["$","p","p-5",{"children":["导出到VS后，需要在nuget里安装",["$","strong","strong-0",{"children":"Microsoft.VisualStudio.Shell"}],"和",["$","strong","strong-1",{"children":"EnvDTE"}],"依赖以正常获得InteliSense提示。否则就要去翻MSDN……"]}]
16:["$","p","p-6",{"children":["通过查找报错的字符串",["$","em","em-0",{"children":"获取可执行文件路径出错"}],"直接定位出错的位置，可以发现相关代码路径是",["$","code","code-0",{"children":"Controller/imp/TestControllerImp.cs"}],"的",["$","code","code-1",{"children":"CallResult RunTest(string)"}],"方法。"]}]
17:["$","p","p-7",{"children":["$","$L33","img-0",{"src":"/articles/asset/contents/20170927-C++插件在VS2017上无法使用的分析/throw-exception.png","imageSize":{"height":888,"width":1935},"imageProps":{"src":"./throw-exception.png","alt":""}}]}]
18:["$","p","p-8",{"children":["图中",["$","code","code-0",{"children":"get_Solution()"}],"、",["$","code","code-1",{"children":"get_Name()"}],"等语句不是错误，它们是C#的属性编译后的代码。在自己程序中，如需访问",["$","code","code-2",{"children":"Solution"}],"等属性，",["$","strong","strong-0",{"children":"只能"}],"直接",["$","code","code-3",{"children":".Solution"}],"，不能直接调用",["$","code","code-4",{"children":"get_Solution()"}],"代码。"]}]
19:["$","p","p-9",{"children":["更具体来说，是下部",["$","code","code-0",{"children":"if (current.Name.Equals(toProjectNameMap[qid])"}],"块中的赋值语句。"]}]
1a:["$","figure","figure-0",{"data-rehype-pretty-code-figure":"","children":["$","pre","pre-0",{"style":{"backgroundColor":"#282c34","color":"#abb2bf"},"tabIndex":0,"data-language":"CSharp","data-theme":"one-dark-pro","children":["$","code","code-0",{"data-language":"CSharp","data-theme":"one-dark-pro","style":{"display":"grid"},"children":["$","span","span-0",{"data-line":"","children":["$","span","span-0",{"children":"path1_1 = current.get_ConfigurationManager().ConfigurationRow(\"Debug\").Item((object) 1).get_Properties().Item((object) \"OutputPath\").get_Value().ToString();"}]}]}]}]}]
1b:["$","p","p-10",{"children":"这句话非常长，有很多函数调用。"}]
1c:["$","p","p-11",{"children":["为了弄清楚具体哪一个调用出错，我新建了一个",["$","strong","strong-0",{"children":"全新的VSIX扩展程序"}],"项目，并在点击事件响应中加入了这个方法。"]}]
1d:["$","p","p-12",{"children":["$","$L33","img-0",{"src":"/articles/asset/contents/20170927-C++插件在VS2017上无法使用的分析/new-vs-extension.png","imageSize":{"height":595,"width":531},"imageProps":{"src":"./new-vs-extension.png","alt":""}}]}]
1e:["$","p","p-13",{"children":"在调试中的VS实例中新建一个C++控制台程序，点击菜单按钮，发现如下结果："}]
1f:["$","p","p-14",{"children":["$","$L33","img-0",{"src":"/articles/asset/contents/20170927-C++插件在VS2017上无法使用的分析/test-new-extension.png","imageSize":{"height":187,"width":926},"imageProps":{"src":"./test-new-extension.png","alt":""}}]}]
20:["$","p","p-15",{"children":["$","strong","strong-0",{"children":"Properties是null，Item(1)返回的是一个COM对象，无法获得值。"}]}]
21:["$","p","p-16",{"children":"这就是错误所在了。"}]
35:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z22:["$","h2","h2-3",{"id":"社区","children":[["$","a","社区",{"href":"#社区","className":"mr-1","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 512 512","className":"inline-block opacity-20 hover:opacity-60","children":["$undefined",[["$","path","0",{"d":"$35","children":[]}]]],"style":{},"height":16,"width":16,"xmlns":"http://www.w3.org/2000/svg"}]}],"社区"]}]
23:["$","p","p-17",{"children":"微软的相关文档中并没有提到任何相关API在VS2017中的变化。"}]
24:["$","p","p-18",{"children":["$","a","a-0",{"href":"https://docs.microsoft.com/en-us/dotnet/api/envdte.configurations.item?view=visualstudiosdk-2017#EnvDTE_Configurations_Item_System_Object_","children":"Configurations.Item(Object)方法"}]}]
25:["$","p","p-19",{"children":["$","a","a-0",{"href":"https://docs.microsoft.com/en-us/dotnet/api/envdte.configuration.properties?view=visualstudiosdk-2017#EnvDTE_Configuration_Properties","children":"Configuration.Properties属性"}]}]
26:["$","p","p-20",{"children":"同时，在StackOverflow下有类似问题："}]
27:["$","p","p-21",{"children":["$","a","a-0",{"href":"https://stackoverflow.com/questions/43418796/configuration-properties-object-returning-null-in-visual-studio-2017-vsix-extens","children":"Configuration.Properties object returning null in Visual Studio 2017 VSIX extension\n"}]}]
28:["$","p","p-22",{"children":["按描述，题主也是有一个",["$","strong","strong-0",{"children":"C++相关的扩展程序"}],"，相同代码在VS2015中能够运行，而在VS2017中出现错误。题主最后提出了一个可用解决方案。如有兴趣请点进去查看，这里就不搬运了。"]}]
29:["$","p","p-23",{"children":["在官方社区中也有相关问题",["$","a","a-0",{"href":"https://developercommunity.visualstudio.com/content/problem/5500/configurationmanageractiveconfigurationproperties.html","children":"ConfigurationManager.ActiveConfiguration.Properties is empty for c++ projects in Visual Studio Extensions"}],"，微软官方并未给出有效回答，却以",["$","em","em-0",{"children":"有效信息不足"}],"的理由关闭了这个问题。这就非常滑稽了。"]}]
2a:["$","blockquote","blockquote-0",{"children":["\n",["$","p","p-0",{"children":["Thank you for your feedback! Unfortunately, we don’t have enough information to narrow down this issue and find a solution. If this is still an issue for you, we recommend that you upgrade to the latest version via the in-product notification or from here: ",["$","a","a-0",{"href":"https://www.visualstudio.com","children":"https://www.visualstudio.com"}],".  If the problem should again occur, please let us know by creating a new problem report using the latest version."]}],"\n"]}]
36:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z2b:["$","h2","h2-4",{"id":"总结","children":[["$","a","总结",{"href":"#总结","className":"mr-1","children":["$","svg",null,{"stroke":"currentColor","fill":"currentColor","strokeWidth":"0","viewBox":"0 0 512 512","className":"inline-block opacity-20 hover:opacity-60","children":["$undefined",[["$","path","0",{"d":"$36","children":[]}]]],"style":{},"height":16,"width":16,"xmlns":"http://www.w3.org/2000/svg"}]}],"总结"]}]
2c:["$","p","p-24",{"children":["总的来说，这个插件不兼容VS2017，是",["$","strong","strong-0",{"children":"微软的锅"}],"：API变动却没有在任何地方体现（",["$","del","del-0",{"children":"可能这是个feature吧"}],"）。请大家可以不折腾这个插件了，安心用虚拟机或者实机安装VS2013吧！"]}]
2d:["$","div",null,{"className":"hidden lg:block lg:w-[25%]","children":["$","$L37",null,{"toc":[{"depth":2,"value":"前言","id":"前言"},{"depth":2,"value":"错误","id":"错误"},{"depth":2,"value":"找错","id":"找错"},{"depth":2,"value":"社区","id":"社区"},{"depth":2,"value":"总结","id":"总结"}],"hasSummary":true}]}]
2e:["$","div",null,{"className":"max-w-7xl mx-auto p-4","children":["$","$L38",null,{"relatedArticles":[]}]}]
2f:["$","div",null,{"className":"max-w-7xl mx-auto p-4","children":["$","$L39",null,{"articleId":"analysis-on-cpp-plugin-not-running-at-vs2017","articleTitle":"C++插件在VS2017上无法使用的分析"}]}]
32:null
