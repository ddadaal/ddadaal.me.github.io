<!DOCTYPE html><html lang="zh-CN" class="scroll-smooth"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="/_next/static/css/54c4c90f0e4aaa79.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/fe1e54f11bde7158.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/0e452e629ebb050b.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/550cc6711c036586.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/84af3e6cc7365e2a.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-2a9780a61575fd97.js"/><script src="/_next/static/chunks/79b3e8d8-3ee8badaaf61aebc.js" async=""></script><script src="/_next/static/chunks/919-686fd648ee068a73.js" async=""></script><script src="/_next/static/chunks/main-app-1f8d22ea4bb2d2c3.js" async=""></script><script src="/_next/static/chunks/c556396d-6bde9789d0a41114.js" async=""></script><script src="/_next/static/chunks/845-a0203995fac91684.js" async=""></script><script src="/_next/static/chunks/57-3951d65188499c8f.js" async=""></script><script src="/_next/static/chunks/325-924239ad7bda233c.js" async=""></script><script src="/_next/static/chunks/app/layout-7026065b75b2b00f.js" async=""></script><script src="/_next/static/chunks/app/page-6cd03741a79daf91.js" async=""></script><script src="/_next/static/chunks/7a1bdfe6-8f7609c25899d936.js" async=""></script><script src="/_next/static/chunks/c4aeae87-2a85323a0275cbf9.js" async=""></script><script src="/_next/static/chunks/1b3e99d6-50521588821d44ca.js" async=""></script><script src="/_next/static/chunks/826-c44bffd752ec02cd.js" async=""></script><script src="/_next/static/chunks/467-ff6f7f0e9f0462a7.js" async=""></script><script src="/_next/static/chunks/app/articles/%5B%5B...params%5D%5D/page-59c8401fd7fff2e0.js" async=""></script><link rel="preload" href="https://services.ddadaal.me/monitor/script.js" as="script"/><title>A React Form Component Performance Optimization with Profiler - ddadaal.me</title><meta name="description" content="ddadaal&#x27;s personal website"/><link rel="manifest" href="/site.webmanifest"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="16x16"/><link rel="icon" href="/icon.svg?35be8e76be1c3618" type="image/svg+xml" sizes="any"/><link rel="apple-touch-icon" href="/apple-icon.png?5334a64f42000bb0" type="image/png" sizes="180x180"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="w-full"><div class="items-center sticky z-50 w-full h-13 transition -top-[1px] bg-base-200 text-base-content"><div class="flex justify-between items-center max-w-7xl mx-auto px-4"><a class="flex items-center justify-center space-x-1" href="/"><img alt="logo" loading="lazy" width="42" height="42" decoding="async" data-nimg="1" style="color:transparent" src="/_next/static/media/logo.8f2bd5ec.svg"/><h1 class="text-sm font-bold">ddadaal.me</h1></a><div class="flex items-center gap-1"><div class="hidden lg:flex"><ul class="menu menu-horizontal"><li><a class="" href="/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 576 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"></path></svg>主页</a></li><li><a class="active" href="/articles"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 576 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"></path></svg>文章</a></li><li><details><summary class=""><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 384 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm160-14.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"></path></svg>简历</summary><ul class="shadow bg-base-200 text-base-content min-w-max"><li><a class="" href="/resume/cn">🇨🇳 <!-- -->简体中文</a></li><li><a class="" href="/resume/en">🇺🇸 <!-- -->English</a></li></ul></details></li><li><a class="" href="/slides"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M187.7 153.7c-34 0-61.7 25.7-61.7 57.7 0 31.7 27.7 57.7 61.7 57.7s61.7-26 61.7-57.7c0-32-27.7-57.7-61.7-57.7zm143.4 0c-34 0-61.7 25.7-61.7 57.7 0 31.7 27.7 57.7 61.7 57.7 34.3 0 61.7-26 61.7-57.7.1-32-27.4-57.7-61.7-57.7zm156.6 90l-6 4.3V49.7c0-27.4-20.6-49.7-46-49.7H76.6c-25.4 0-46 22.3-46 49.7V248c-2-1.4-4.3-2.9-6.3-4.3-15.1-10.6-25.1 4-16 17.7 18.3 22.6 53.1 50.3 106.3 72C58.3 525.1 252 555.7 248.9 457.5c0-.7.3-56.6.3-96.6 5.1 1.1 9.4 2.3 13.7 3.1 0 39.7.3 92.8.3 93.5-3.1 98.3 190.6 67.7 134.3-124 53.1-21.7 88-49.4 106.3-72 9.1-13.8-.9-28.3-16.1-17.8zm-30.5 19.2c-68.9 37.4-128.3 31.1-160.6 29.7-23.7-.9-32.6 9.1-33.7 24.9-10.3-7.7-18.6-15.5-20.3-17.1-5.1-5.4-13.7-8-27.1-7.7-31.7 1.1-89.7 7.4-157.4-28V72.3c0-34.9 8.9-45.7 40.6-45.7h317.7c30.3 0 40.9 12.9 40.9 45.7v190.6z"></path></svg>幻灯片</a></li><li><details><summary class=""><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 192 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 424.229h20V279.771H20c-11.046 0-20-8.954-20-20V212c0-11.046 8.954-20 20-20h112c11.046 0 20 8.954 20 20v212.229h20c11.046 0 20 8.954 20 20V492c0 11.046-8.954 20-20 20H20c-11.046 0-20-8.954-20-20v-47.771c0-11.046 8.954-20 20-20zM96 0C56.235 0 24 32.235 24 72s32.235 72 72 72 72-32.235 72-72S135.764 0 96 0z"></path></svg>关于</summary><ul class="shadow bg-base-200 text-base-content min-w-max"><li><a class="" href="/about/odyssey"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 576 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"></path></svg>一个个人博客的史诗</a></li><li><a class="" href="/about/project"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"></path></svg>关于网站</a></li><li><a class="" href="/about/me"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 192 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M96 0c35.346 0 64 28.654 64 64s-28.654 64-64 64-64-28.654-64-64S60.654 0 96 0m48 144h-11.36c-22.711 10.443-49.59 10.894-73.28 0H48c-26.51 0-48 21.49-48 48v136c0 13.255 10.745 24 24 24h16v136c0 13.255 10.745 24 24 24h64c13.255 0 24-10.745 24-24V352h16c13.255 0 24-10.745 24-24V192c0-26.51-21.49-48-48-48z"></path></svg>关于我</a></li></ul></details></li></ul></div><div class="dropdown dropdown-end"><label tabindex="0" class="btn"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M8 256c0 136.966 111.033 248 248 248s248-111.034 248-248S392.966 8 256 8 8 119.033 8 256zm248 184V72c101.705 0 184 82.311 184 184 0 101.705-82.311 184-184 184z"></path></svg><span class="hidden sm:block">自动</span></label><ul tabindex="0" class="dropdown-content menu p-2 bg-base-200 text-base-content shadow rounded-box min-w-max"><li><a class="justify-between">自动</a></li><li><a class="justify-between">明亮</a></li><li><a class="justify-between">暗色</a></li><li><a class="justify-between">杯子蛋糕</a></li><li><a class="justify-between">大黄蜂</a></li><li><a class="justify-between">白色商务</a></li><li><a class="justify-between">黑色商务</a></li><li><a class="justify-between">金色奢华</a></li><li><a class="justify-between">夏日柠檬</a></li><li><a class="justify-between">绿野仙踪</a></li><li><a class="justify-between">复古</a></li><li><a class="justify-between">粉色浪漫</a></li><li><a class="justify-between">赛博朋克</a></li></ul></div><div class="dropdown dropdown-end"><label tabindex="0" class="btn">🇨🇳 <span class="hidden sm:block">简体中文</span></label><ul tabindex="0" class="dropdown-content menu p-2 shadow bg-base-200 rounded-box min-w-max text-base-content"><li><a class="justify-between">🇨🇳 <!-- -->简体中文</a></li><li><a class="justify-between">🇺🇸 <!-- -->English</a></li></ul></div><div class="dropdown dropdown-end lg:hidden"><label tabindex="0" class="btn btn-ghost"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M328 256c0 39.8-32.2 72-72 72s-72-32.2-72-72 32.2-72 72-72 72 32.2 72 72zm104-72c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72zm-352 0c-39.8 0-72 32.2-72 72s32.2 72 72 72 72-32.2 72-72-32.2-72-72-72z"></path></svg></label><ul tabindex="0" class="menu menu-compact dropdown-content min-w-max mt-3 p-2 shadow rounded-box bg-base-200 text-base-content"><li><a class="" href="/"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 576 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M280.37 148.26L96 300.11V464a16 16 0 0 0 16 16l112.06-.29a16 16 0 0 0 15.92-16V368a16 16 0 0 1 16-16h64a16 16 0 0 1 16 16v95.64a16 16 0 0 0 16 16.05L464 480a16 16 0 0 0 16-16V300L295.67 148.26a12.19 12.19 0 0 0-15.3 0zM571.6 251.47L488 182.56V44.05a12 12 0 0 0-12-12h-56a12 12 0 0 0-12 12v72.61L318.47 43a48 48 0 0 0-61 0L4.34 251.47a12 12 0 0 0-1.6 16.9l25.5 31A12 12 0 0 0 45.15 301l235.22-193.74a12.19 12.19 0 0 1 15.3 0L530.9 301a12 12 0 0 0 16.9-1.6l25.5-31a12 12 0 0 0-1.7-16.93z"></path></svg>主页</a></li><li><a class="active" href="/articles"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 576 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"></path></svg>文章</a></li><li><a><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 384 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm160-14.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"></path></svg>简历</a><ul><li><a class="" href="/resume/cn">🇨🇳 <!-- -->简体中文</a></li><li><a class="" href="/resume/en">🇺🇸 <!-- -->English</a></li></ul></li><li><a class="" href="/slides"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M187.7 153.7c-34 0-61.7 25.7-61.7 57.7 0 31.7 27.7 57.7 61.7 57.7s61.7-26 61.7-57.7c0-32-27.7-57.7-61.7-57.7zm143.4 0c-34 0-61.7 25.7-61.7 57.7 0 31.7 27.7 57.7 61.7 57.7 34.3 0 61.7-26 61.7-57.7.1-32-27.4-57.7-61.7-57.7zm156.6 90l-6 4.3V49.7c0-27.4-20.6-49.7-46-49.7H76.6c-25.4 0-46 22.3-46 49.7V248c-2-1.4-4.3-2.9-6.3-4.3-15.1-10.6-25.1 4-16 17.7 18.3 22.6 53.1 50.3 106.3 72C58.3 525.1 252 555.7 248.9 457.5c0-.7.3-56.6.3-96.6 5.1 1.1 9.4 2.3 13.7 3.1 0 39.7.3 92.8.3 93.5-3.1 98.3 190.6 67.7 134.3-124 53.1-21.7 88-49.4 106.3-72 9.1-13.8-.9-28.3-16.1-17.8zm-30.5 19.2c-68.9 37.4-128.3 31.1-160.6 29.7-23.7-.9-32.6 9.1-33.7 24.9-10.3-7.7-18.6-15.5-20.3-17.1-5.1-5.4-13.7-8-27.1-7.7-31.7 1.1-89.7 7.4-157.4-28V72.3c0-34.9 8.9-45.7 40.6-45.7h317.7c30.3 0 40.9 12.9 40.9 45.7v190.6z"></path></svg>幻灯片</a></li><li><a><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 192 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M20 424.229h20V279.771H20c-11.046 0-20-8.954-20-20V212c0-11.046 8.954-20 20-20h112c11.046 0 20 8.954 20 20v212.229h20c11.046 0 20 8.954 20 20V492c0 11.046-8.954 20-20 20H20c-11.046 0-20-8.954-20-20v-47.771c0-11.046 8.954-20 20-20zM96 0C56.235 0 24 32.235 24 72s32.235 72 72 72 72-32.235 72-72S135.764 0 96 0z"></path></svg>关于</a><ul><li><a class="" href="/about/odyssey"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 576 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M542.22 32.05c-54.8 3.11-163.72 14.43-230.96 55.59-4.64 2.84-7.27 7.89-7.27 13.17v363.87c0 11.55 12.63 18.85 23.28 13.49 69.18-34.82 169.23-44.32 218.7-46.92 16.89-.89 30.02-14.43 30.02-30.66V62.75c.01-17.71-15.35-31.74-33.77-30.7zM264.73 87.64C197.5 46.48 88.58 35.17 33.78 32.05 15.36 31.01 0 45.04 0 62.75V400.6c0 16.24 13.13 29.78 30.02 30.66 49.49 2.6 149.59 12.11 218.77 46.95 10.62 5.35 23.21-1.94 23.21-13.46V100.63c0-5.29-2.62-10.14-7.27-12.99z"></path></svg>一个个人博客的史诗</a></li><li><a class="" href="/about/project"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"></path></svg>关于网站</a></li><li><a class="" href="/about/me"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 192 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M96 0c35.346 0 64 28.654 64 64s-28.654 64-64 64-64-28.654-64-64S60.654 0 96 0m48 144h-11.36c-22.711 10.443-49.59 10.894-73.28 0H48c-26.51 0-48 21.49-48 48v136c0 13.255 10.745 24 24 24h16v136c0 13.255 10.745 24 24 24h64c13.255 0 24-10.745 24-24V352h16c13.255 0 24-10.745 24-24V192c0-26.51-21.49-48-48-48z"></path></svg>关于我</a></li></ul></li></ul></div></div></div></div><div><article><div class="bg-neutral px-4 py-8"><div class="max-w-7xl mx-auto min-h-[256px] flex justify-center text-center text-neutral-content"><div class="flex flex-col justify-center animate-slide-up"><h1 class="text-4xl my-2">A React Form Component Performance Optimization with Profiler</h1><div class="flex flex-wrap gap-3 my-2 text-sm justify-center"><div class="flex flex-wrap gap-1 items-center"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M0 252.118V48C0 21.49 21.49 0 48 0h204.118a48 48 0 0 1 33.941 14.059l211.882 211.882c18.745 18.745 18.745 49.137 0 67.882L293.823 497.941c-18.745 18.745-49.137 18.745-67.882 0L14.059 286.059A48 48 0 0 1 0 252.118zM112 64c-26.51 0-48 21.49-48 48s21.49 48 48 48 48-21.49 48-48-21.49-48-48-48z"></path></svg><a class="badge badge-accent mx-0.5 text-accent-content" href="/articles/search?query=problem-investigation">问题探究</a><a class="badge badge-accent mx-0.5 text-accent-content" href="/articles/search?query=web-frontend">Web前端</a><a class="badge badge-accent mx-0.5 text-accent-content" href="/articles/search?query=React">React</a></div><div class="flex items-center" title="发表时间"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M12 192h424c6.6 0 12 5.4 12 12v260c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V204c0-6.6 5.4-12 12-12zm436-44v-36c0-26.5-21.5-48-48-48h-48V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H160V12c0-6.6-5.4-12-12-12h-40c-6.6 0-12 5.4-12 12v52H48C21.5 64 0 85.5 0 112v36c0 6.6 5.4 12 12 12h424c6.6 0 12-5.4 12-12z"></path></svg><span class="mx-0.5">2019-10-13 11:14:00 UTC+8</span></div><div class="flex items-center"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 384 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm57.1 120H305c7.7 0 13.4 7.1 11.7 14.7l-38 168c-1.2 5.5-6.1 9.3-11.7 9.3h-38c-5.5 0-10.3-3.8-11.6-9.1-25.8-103.5-20.8-81.2-25.6-110.5h-.5c-1.1 14.3-2.4 17.4-25.6 110.5-1.3 5.3-6.1 9.1-11.6 9.1H117c-5.6 0-10.5-3.9-11.7-9.4l-37.8-168c-1.7-7.5 4-14.6 11.7-14.6h24.5c5.7 0 10.7 4 11.8 9.7 15.6 78 20.1 109.5 21 122.2 1.6-10.2 7.3-32.7 29.4-122.7 1.3-5.4 6.1-9.1 11.7-9.1h29.1c5.6 0 10.4 3.8 11.7 9.2 24 100.4 28.8 124 29.6 129.4-.2-11.2-2.6-17.8 21.6-129.2 1-5.6 5.9-9.5 11.5-9.5zM384 121.9v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"></path></svg><span class="mx-0.5">1628<!-- --> 字</span></div><div class="flex items-center"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M256,8C119,8,8,119,8,256S119,504,256,504,504,393,504,256,393,8,256,8Zm92.49,313h0l-20,25a16,16,0,0,1-22.49,2.5h0l-67-49.72a40,40,0,0,1-15-31.23V112a16,16,0,0,1,16-16h32a16,16,0,0,1,16,16V256l58,42.5A16,16,0,0,1,348.49,321Z"></path></svg><span class="mx-0.5">9<!-- --> 分钟阅读</span></div><div class="flex items-center"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M336.5 160C322 70.7 287.8 8 248 8s-74 62.7-88.5 152h177zM152 256c0 22.2 1.2 43.5 3.3 64h185.3c2.1-20.5 3.3-41.8 3.3-64s-1.2-43.5-3.3-64H155.3c-2.1 20.5-3.3 41.8-3.3 64zm324.7-96c-28.6-67.9-86.5-120.4-158-141.6 24.4 33.8 41.2 84.7 50 141.6h108zM177.2 18.4C105.8 39.6 47.8 92.1 19.3 160h108c8.7-56.9 25.5-107.8 49.9-141.6zM487.4 192H372.7c2.1 21 3.3 42.5 3.3 64s-1.2 43-3.3 64h114.6c5.5-20.5 8.6-41.8 8.6-64s-3.1-43.5-8.5-64zM120 256c0-21.5 1.2-43 3.3-64H8.6C3.2 212.5 0 233.8 0 256s3.2 43.5 8.6 64h114.6c-2-21-3.2-42.5-3.2-64zm39.5 96c14.5 89.3 48.7 152 88.5 152s74-62.7 88.5-152h-177zm159.3 141.6c71.4-21.2 129.4-73.7 158-141.6h-108c-8.8 56.9-25.6 107.8-50 141.6zM19.3 352c28.6 67.9 86.5 120.4 158 141.6-24.4-33.8-41.2-84.7-50-141.6h-108z"></path></svg><span class="mx-0.5 space-x-1"><a class="link link-hover" href="/articles/a-react-form-comp-pref-optimization-with-profiler/en">English</a></span></div></div></div></div></div><div class="animate-slide-up"><div class="max-w-7xl mx-auto p-4"><div class="flex flex-row space-x-4"><div class="prose max-w-full lg:w-[75%]"><div class="p-4 my-4 bg-neutral rounded shadow"><h1 id="summary" class="text-neutral-content mb-3"><a href="#summary" class="mr-1 text-neutral-content"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="inline-block opacity-20 hover:opacity-60" height="16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a>✨AI全文摘要</h1><div><div role="tablist" class="tabs-boxed"><a role="tab" class="tab no-underline tab-active">DeepSeek R1</a><a role="tab" class="tab no-underline">DeepSeek R1 8B</a><div role="tabpanel" class="p-3"><div class="prose max-h-80 overflow-auto max-w-full prose-p:m-0 prose-li:m-0 prose-ul:m-0 prose-ol:m-0"><p>A developer addressed severe performance issues in a React form, where input lagged significantly, especially when entering sequential keystrokes. Initially suspecting validations or form-wide re-renders, profiling with React DevTools revealed a Dropdown component (Semantic-UI) rendering 400+ options as the culprit. Each keystroke triggered re-renders, generating new option instances. The uncontrolled Dropdown was extracted into a PureComponent, memoizing options to prevent redundant renders. This reduced per-input render time from ~400ms to ~22ms, eliminating lag. The solution highlighted the importance of profiling to identify bottlenecks, controlled re-renders via memoization, and optimizing third-party components in large-scale React applications to maintain responsiveness.</p></div><p class="text-sm justify-end flex m-2 italic">由<a target="_blank" href="https://ai.azure.com">Azure AI</a>部署的DeepSeek-R1模型推理</p></div></div></div></div><blockquote>
<p>Note: This code is from an internal project. Measurements apply to protect confidential information, but the problem and methods mentioned in the article are universal and not limited to specific projects.</p>
</blockquote>
<h1 id="the-problem"><a href="#the-problem" class="mr-1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="inline-block opacity-20 hover:opacity-60" height="16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a>The Problem</h1>
<p>I was working on a form that had very poor performance. To be specific, at every key stroke, the form responded pretty slowly. What&#x27;s worse, the component and the whole website became completely unresponsive for <strong>seconds</strong> if several keys were stroked sequentially (like input a long number), which was, unfortunately, the normal use case for this field.</p>
<p><figure><img alt="bad performance, especially for the first input field" loading="lazy" width="534" height="123" decoding="async" data-nimg="1" class="cursor-zoom-in mx-auto" style="color:transparent" srcSet="/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/bad-pref.gif?width=640 1x, /articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/bad-pref.gif?width=1080 2x" src="/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/bad-pref.gif?width=1080"/><figcaption class="text-center">bad performance, especially for the first input field</figcaption></figure></p>
<h1 id="investigation"><a href="#investigation" class="mr-1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="inline-block opacity-20 hover:opacity-60" height="16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a>Investigation</h1>
<h2 id="validations"><a href="#validations" class="mr-1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="inline-block opacity-20 hover:opacity-60" height="16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a>Validations?</h2>
<p>From the gif provided above, you may find some details that are worth taking notice of:</p>
<ul>
<li>The first field had the <strong>worse performance</strong>,</li>
<li>The first field had some kinds of input validation (loading indicator when the first inputs were registered),</li>
<li>The field below the first field had better performance than the first one, and it had no validation.</li>
</ul>
<p>Hmm...It looks like <strong>the validation</strong> might be the cause.</p>
<p>However, the validation process was merely some format check, and a request which would be cancelled if next key stroke had come before it completed. It did increase the delay of input, but should not be so significant.</p>
<h2 id="re-renders-of-the-whole-form"><a href="#re-renders-of-the-whole-form" class="mr-1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="inline-block opacity-20 hover:opacity-60" height="16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a>Re-renders of the Whole Form?</h2>
<h3 id="the-challenge-of-forms-in-react"><a href="#the-challenge-of-forms-in-react" class="mr-1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="inline-block opacity-20 hover:opacity-60" height="16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a>The Challenge of Forms in React</h3>
<p>The <strong>re-render of the whole form at every input</strong> might be the problem as well.</p>
<p>React has been known as <em>not good at implementing forms</em> because of its famous <strong>unidirectional data flow</strong>.</p>
<p><figure><img alt="Source: https://gist.github.com/alexmingoia/4db967e5aeb31d84847c. See this page to get yourself familiarized if you haven&#x27;t already." loading="lazy" width="960" height="720" decoding="async" data-nimg="1" class="cursor-zoom-in mx-auto" style="color:transparent" srcSet="/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/unidirectiona-data-flow.png?width=1080 1x, /articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/unidirectiona-data-flow.png?width=1920 2x" src="/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/unidirectiona-data-flow.png?width=1920"/><figcaption class="text-center">Source: https://gist.github.com/alexmingoia/4db967e5aeb31d84847c. See this page to get yourself familiarized if you haven&#x27;t already.</figcaption></figure></p>
<p>Unidirectional data flow simplifies the data flow and fits seeminglessly with the concept of React. However, since <strong>each update to the state will trigger the component to re-render</strong>, it might impact the performance of the app.</p>
<p>Form is one of such cases, because a form consists of multiple input fields, and <strong>each input to any one of them</strong> would update the state, and re-render the whole form and every other fields. Therefore, writing forms in React has always a challenge.</p>
<h3 id="complicated-form"><a href="#complicated-form" class="mr-1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="inline-block opacity-20 hover:opacity-60" height="16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a>Complicated Form</h3>
<p>Looking at the code, the form was implemented in a very React way: the form contained all the fields, and handled every <code>onChange</code> event for each input fields.</p>
<p><figure><img alt="part of fields" loading="lazy" width="726" height="248" decoding="async" data-nimg="1" class="cursor-zoom-in mx-auto" style="color:transparent" srcSet="/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/fields.png?width=750 1x, /articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/fields.png?width=1920 2x" src="/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/fields.png?width=1920"/><figcaption class="text-center">part of fields</figcaption></figure></p>
<p>The form was complicated with dozens of fields, several <strong>sync/async and cross-field validations</strong>, <strong>dynamic placeholders</strong> and some unnecessary <strong>duplicate calculations</strong> (which could be improved with constants and cache).</p>
<p>It seemed pretty evident that the <strong>re-renders</strong> and <strong>the complicated calculations</strong> during the render were the cause to the problem.</p>
<h3 id="no-easy-solutions"><a href="#no-easy-solutions" class="mr-1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="inline-block opacity-20 hover:opacity-60" height="16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a>No Easy Solutions</h3>
<p>Having found the reason, what&#x27;s left was to find a solution. However, the reason that form implementation is called a <em>challenge</em> in React is that it can not be solved easily. There are lots of React form library from the community (like <a href="https://github.com/tannerlinsley/react-form">react-form</a>, <a href="https://github.com/jaredpalmer/formik">formik</a>) trying to solve the form as a whole by providing a complete solution to some common form challenges, including input management, async validations, and submission. They may be viable for many users and should be considered if you are having trouble building a form in your project, but I couldn&#x27;t adopt them in this project because:</p>
<ul>
<li>hiding complexities usually means introducing other complexities
<ul>
<li>for example, when using the libraries, more problems are introduced, like <strong>less flexibilities</strong>, <strong>less understandable code</strong>, <strong>interop with UI libraries</strong> and <strong>the cost of learning and adopting a new set of APIs</strong>.</li>
</ul>
</li>
<li>The code is involved with several internal concepts and conventions, which I am not familiar enough. As a result, I don&#x27;t have the confidence to rewrite the logic correctly in a short time;</li>
<li>introducing a new library into this project is hard, for it is a internal project that has over 200K lines of TypeScript code, hundreds of authors and users, so the review for this project is strict.</li>
</ul>
<h2 id="maybe-not-re-renders"><a href="#maybe-not-re-renders" class="mr-1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="inline-block opacity-20 hover:opacity-60" height="16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a>Maybe Not Re-renders?</h2>
<p>Besides, my experiences told me that it was possibly not the <strong>re-renders</strong> that was to blame, since the updates of the form should not be so costly that would result in such a significant delay.</p>
<p>I have encountered situations where even <strong>a whole page</strong> re-rendered at every interaction, but React and modern JavaScript engines is more than capable to drive it smoothly without even a stutter. This form had several fields to be re-rendered at every input, but when taking the whole page into consideration, the number of re-renders inside this page was negligible.</p>
<h2 id="profiling-profiling-profiling"><a href="#profiling-profiling-profiling" class="mr-1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="inline-block opacity-20 hover:opacity-60" height="16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a>Profiling, Profiling, Profiling</h2>
<p>After wasting days on <em>brainstorming</em> the source of problem, I decided to diagnose the issue in a scientific way -- <strong>profiling</strong>.</p>
<p><a href="https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi">React&#x27;s official devtool of Chrome</a> has a built-in profiling tool. By recoding a sequence of user interactions, profiler can provide performance metrics on each commit during the record, like what components are re-rendered, how many time they take to re-render, with which the developer can locate the components that have biggest impact to the performance, and optimize them accordingly.</p>
<p>Start the recoding, repeat the operations of the gif above, and I had the following result:</p>
<p><figure><img alt="Ranked chart" loading="lazy" width="780" height="141" decoding="async" data-nimg="1" class="cursor-zoom-in mx-auto" style="color:transparent" srcSet="/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/profiling.png?width=828 1x, /articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/profiling.png?width=1920 2x" src="/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/profiling.png?width=1920"/><figcaption class="text-center">Ranked chart</figcaption></figure>
<figure><img alt="Flamegraph chart" loading="lazy" width="414" height="228" decoding="async" data-nimg="1" class="cursor-zoom-in mx-auto" style="color:transparent" srcSet="/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/profiling-2.png?width=640 1x, /articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/profiling-2.png?width=828 2x" src="/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/profiling-2.png?width=828"/><figcaption class="text-center">Flamegraph chart</figcaption></figure></p>
<p>The first chart (ranked chart) showed the time to re-render for each component that had re-rendered on this commit. The second chart (flamegraph chart) shoed the re-rendered components <strong>hierarchically</strong>: that is, the time to render the component itself, and each of its children.</p>
<p>As you could see, a <strong>Dropdown</strong> component took a significant time to re-render. In fact, all the graphes on all the last 10 commits had led me to the same component. By following the hierarchy provided by the flamegraph, it didn&#x27;t take long to locate the component, which was the dropdown <strong>on the right side</strong> of the first field with slow responsiveness, and implemented as follows:</p>
<p><figure><img alt="The dropdown" loading="lazy" width="476" height="174" decoding="async" data-nimg="1" class="cursor-zoom-in mx-auto" style="color:transparent" srcSet="/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/dropdown.png?width=640 1x, /articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/dropdown.png?width=1080 2x" src="/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/dropdown.png?width=1080"/><figcaption class="text-center">The dropdown</figcaption></figure></p>
<p>It looked like a normal dropdown with the exception of a <strong>duplicate calculations</strong>: generating an options array at every render. <strong>Providing different instances at every render</strong> is a common source of performance problem in React, because it signals React that the props have changed and a re-render is required, even the objects between renders are <strong>deep equal</strong>. The solution is straightforward: instead of generating a different instance each time, provide a constant or a class field that only changes when it is modified.</p>
<p>But unfortunately, in this case, after replacing the call to <code>this.generateDropdown</code> to a constant, the problem persisted.</p>
<h2 id="large-quantity-of-options"><a href="#large-quantity-of-options" class="mr-1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="inline-block opacity-20 hover:opacity-60" height="16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a>Large Quantity of Options</h2>
<p>The source of options of the dropdown came from a network request that was initiated when the page loaded. Another clue that I found during investigation was that when network errors happened, the input became very <strong>responsive</strong>, at which time <strong>the dropdown had no option</strong>. And after several intentional experiments, I found the correspondance between options and performance to be true (no option -&gt; good performance, had options -&gt; bad performace).</p>
<p>I was just a maintainer of the component, not the original authors, so I didn&#x27;t take notice of the contents of dropdown during my previous investigation. Now, according to the correspondance, I checked out the options of the dropdown, only to find it had over 400 options.</p>
<p><figure><img alt="&gt;400 options" loading="lazy" width="123" height="109" decoding="async" data-nimg="1" class="cursor-zoom-in mx-auto" style="color:transparent" srcSet="/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/large-number-of-options.png?width=128 1x, /articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/large-number-of-options.png?width=256 2x" src="/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/large-number-of-options.png?width=256"/><figcaption class="text-center">&gt;400 options</figcaption></figure></p>
<p>Rendering <strong>so many options</strong> at each render would definitely impact performance pretty hard, unless the component had thought of it and selectively re-rendered only the changed part.</p>
<p>This project used <a href="https://react.semantic-ui.com/">React Wrapper of Semantic-UI</a> which was a famous component library and open source. By diving into the source code, I found that the dropdown did re-render every options every time without any memoing or caching.</p>
<p><a href="https://github.com/Semantic-Org/Semantic-UI-React/blob/master/src/modules/Dropdown/Dropdown.js#L1275">https://github.com/Semantic-Org/Semantic-UI-React/blob/master/src/modules/Dropdown/Dropdown.js#L1275</a></p>
<figure data-rehype-pretty-code-figure=""><pre style="background-color:#282c34;color:#abb2bf" tabindex="0" data-language="jsx" data-theme="one-dark-pro"><code data-language="jsx" data-theme="one-dark-pro" style="display:grid"><span data-line=""><span style="color:#7F848E;font-style:italic">// omitted</span></span>
<span data-line=""><span style="color:#61AFEF">renderOptions</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> () </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span data-line=""><span style="color:#7F848E;font-style:italic">  // omitted</span></span>
<span data-line=""><span style="color:#C678DD">  return</span><span style="color:#E5C07B"> _</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">map</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">options</span><span style="color:#ABB2BF">, (</span><span style="color:#E06C75;font-style:italic">opt</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75;font-style:italic">i</span><span style="color:#ABB2BF">) </span><span style="color:#C678DD">=&gt;</span></span>
<span data-line=""><span style="color:#E5C07B">    DropdownItem</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">create</span><span style="color:#ABB2BF">({</span></span>
<span data-line=""><span style="color:#E06C75">      active</span><span style="color:#ABB2BF">: </span><span style="color:#61AFEF">isActive</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">opt</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">value</span><span style="color:#ABB2BF">),</span></span>
<span data-line=""><span style="color:#E06C75">      onClick</span><span style="color:#ABB2BF">: </span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">handleItemClick</span><span style="color:#ABB2BF">,</span></span>
<span data-line=""><span style="color:#E06C75">      selected</span><span style="color:#ABB2BF">: </span><span style="color:#E06C75">selectedIndex</span><span style="color:#56B6C2"> ===</span><span style="color:#E06C75"> i</span><span style="color:#ABB2BF">,</span></span>
<span data-line=""><span style="color:#ABB2BF">      ...</span><span style="color:#E06C75">opt</span><span style="color:#ABB2BF">,</span></span>
<span data-line=""><span style="color:#E06C75">      key</span><span style="color:#ABB2BF">: </span><span style="color:#61AFEF">getKeyOrValue</span><span style="color:#ABB2BF">(</span><span style="color:#E5C07B">opt</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">key</span><span style="color:#ABB2BF">, </span><span style="color:#E5C07B">opt</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">value</span><span style="color:#ABB2BF">),</span></span>
<span data-line=""><span style="color:#7F848E;font-style:italic">      // Needed for handling click events on disabled items</span></span>
<span data-line=""><span style="color:#E06C75">      style</span><span style="color:#ABB2BF">: { ...</span><span style="color:#E5C07B">opt</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75">style</span><span style="color:#ABB2BF">, </span><span style="color:#E06C75">pointerEvents</span><span style="color:#ABB2BF">: </span><span style="color:#98C379">&#x27;all&#x27;</span><span style="color:#ABB2BF"> },</span></span>
<span data-line=""><span style="color:#ABB2BF">    }),</span></span>
<span data-line=""><span style="color:#ABB2BF">  )</span></span>
<span data-line=""><span style="color:#ABB2BF">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#61AFEF">renderMenu</span><span style="color:#56B6C2"> =</span><span style="color:#ABB2BF"> () </span><span style="color:#C678DD">=&gt;</span><span style="color:#ABB2BF"> {</span></span>
<span data-line=""><span style="color:#7F848E;font-style:italic">  // omitted</span></span>
<span data-line=""><span style="color:#C678DD">  return</span><span style="color:#ABB2BF"> (</span></span>
<span data-line=""><span style="color:#ABB2BF">    &lt;</span><span style="color:#E5C07B">DropdownMenu</span><span style="color:#C678DD"> {</span><span style="color:#ABB2BF">...</span><span style="color:#E06C75">ariaOptions</span><span style="color:#C678DD">}</span><span style="color:#D19A66;font-style:italic"> direction</span><span style="color:#56B6C2">=</span><span style="color:#C678DD">{</span><span style="color:#E06C75">direction</span><span style="color:#C678DD">}</span><span style="color:#D19A66;font-style:italic"> open</span><span style="color:#56B6C2">=</span><span style="color:#C678DD">{</span><span style="color:#E06C75">open</span><span style="color:#C678DD">}</span><span style="color:#ABB2BF">&gt;</span></span>
<span data-line=""><span style="color:#C678DD">      {</span><span style="color:#E5C07B">DropdownHeader</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">create</span><span style="color:#ABB2BF">(</span><span style="color:#E06C75">header</span><span style="color:#ABB2BF">, { </span><span style="color:#E06C75">autoGenerateKey</span><span style="color:#ABB2BF">: </span><span style="color:#D19A66">false</span><span style="color:#ABB2BF"> })</span><span style="color:#C678DD">}</span></span>
<span data-line=""><span style="color:#C678DD">      {</span><span style="color:#E5C07B">this</span><span style="color:#ABB2BF">.</span><span style="color:#61AFEF">renderOptions</span><span style="color:#ABB2BF">()</span><span style="color:#C678DD">}</span></span>
<span data-line=""><span style="color:#ABB2BF">    &lt;/</span><span style="color:#E5C07B">DropdownMenu</span><span style="color:#ABB2BF">&gt;</span></span>
<span data-line=""><span style="color:#ABB2BF">  )</span></span>
<span data-line=""><span style="color:#ABB2BF">}</span></span>
<span data-line=""> </span>
<span data-line=""><span style="color:#61AFEF">render</span><span style="color:#ABB2BF">() {</span></span>
<span data-line=""><span style="color:#7F848E;font-style:italic">  // omitted</span></span>
<span data-line=""><span style="color:#C678DD">  return</span><span style="color:#ABB2BF"> (</span></span>
<span data-line=""><span style="color:#7F848E;font-style:italic">    // omitted</span></span>
<span data-line=""><span style="color:#ABB2BF">    {</span><span style="color:#E06C75;font-style:italic">this</span><span style="color:#ABB2BF">.</span><span style="color:#E06C75;font-style:italic">renderMenu</span><span style="color:#ABB2BF">()}</span></span>
<span data-line=""><span style="color:#7F848E;font-style:italic">    // omitted</span></span>
<span data-line=""><span style="color:#ABB2BF">  )</span></span>
<span data-line=""><span style="color:#ABB2BF">}</span></span></code></pre></figure>
<h1 id="solution"><a href="#solution" class="mr-1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="inline-block opacity-20 hover:opacity-60" height="16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a>Solution</h1>
<p>In this case, the options didn&#x27;t update anymore after the request had completed. Therefore, there was no need to update and re-render the options every time the component had changed.</p>
<p>To stop the re-render, I extracted the dropdown out into a separate component, passed the options as a prop, and most importantly, made it a <code>PureComponent</code> which only re-rendered itself when the props had changed.</p>
<p>The dropdown was used in a <strong>uncontrolled</strong> way -- that is, not managing its <code>value</code> by the DOM instead of as a state of React component by not passing value to the <code>input</code> DOM field. I had to admit it was not the React way, but here, not passing value to it meant that the component would <strong>never update</strong>, which was exactly what I wanted.</p>
<p><figure><img alt="Optimized code" loading="lazy" width="609" height="429" decoding="async" data-nimg="1" class="cursor-zoom-in mx-auto" style="color:transparent" srcSet="/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/optimized-code.png?width=640 1x, /articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/optimized-code.png?width=1920 2x" src="/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/optimized-code.png?width=1920"/><figcaption class="text-center">Optimized code</figcaption></figure></p>
<p>The optimization worked like a charm: the render time of the whole form for each input had reduced from <strong>~400ms</strong> to <strong>~22ms</strong>, and there was no any unresponsiveness and delay at every key stroke.</p>
<p><figure><img alt="After" loading="lazy" width="748" height="169" decoding="async" data-nimg="1" class="cursor-zoom-in mx-auto" style="color:transparent" srcSet="/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/after.png?width=750 1x, /articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/after.png?width=1920 2x" src="/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/after.png?width=1920"/><figcaption class="text-center">After</figcaption></figure></p>
<h1 id="verdict"><a href="#verdict" class="mr-1"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 512 512" class="inline-block opacity-20 hover:opacity-60" height="16" width="16" xmlns="http://www.w3.org/2000/svg"><path d="M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"></path></svg></a>Verdict</h1>
<p>Form is React is indeed a challenge. Without careful designing and implementation, problems may occur at any time, anywhere.</p>
<p>The issue here was ultimately the re-renders, but not the form I originally thought of, but the dropdown with large number of options. It is important to app performance to <strong>understand React update strategy</strong> and <strong>control the component update</strong> with lifecycle functions, property hook usage, memoing and caching, especially when the the number of component to render is too large.</p>
<p>The <strong>profiler</strong> was the key to finding the component to blame by providing the data of time to re-render for each component. Therefore, when a performance issue is detected, stop wasting guessing which compoenent causes it, and let profiler take you straight to it.</p></div><div class="hidden lg:block lg:w-[25%]"><div class="px-1 sticky top-24 max-h-[60vh] overflow-auto"><div class="flex space-x-1 items-center py-2"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 24 24" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path fill="none" d="M0 0h24v24H0z"></path><path d="M3 9h14V7H3v2zm0 4h14v-2H3v2zm0 4h14v-2H3v2zm16 0h2v-2h-2v2zm0-10v2h2V7h-2zm0 6h2v-2h-2v2z"></path></svg><span>目录</span></div><ul class="pl-2 border-l border-neutral"><li class="w-full text-sm"><a class="transition hover:bg-base-300 rounded w-full flex p-1" data-tocid="summary" href="#summary"><span class="font-bold">✨AI全文摘要</span></a></li><li class="w-full text-sm"><a class="transition hover:bg-base-300 rounded w-full flex p-1" data-tocid="the-problem" href="#the-problem">The Problem</a></li><li class="w-full text-sm"><a class="transition hover:bg-base-300 rounded w-full flex p-1" data-tocid="investigation" href="#investigation">Investigation</a><ul class="pl-2 border-l border-neutral"><li class="w-full text-sm"><a class="transition hover:bg-base-300 rounded w-full flex p-1" data-tocid="validations" href="#validations">Validations?</a></li><li class="w-full text-sm"><a class="transition hover:bg-base-300 rounded w-full flex p-1" data-tocid="re-renders-of-the-whole-form" href="#re-renders-of-the-whole-form">Re-renders of the Whole Form?</a><ul class="pl-2 border-l border-neutral"><li class="w-full text-sm"><a class="transition hover:bg-base-300 rounded w-full flex p-1" data-tocid="the-challenge-of-forms-in-react" href="#the-challenge-of-forms-in-react">The Challenge of Forms in React</a></li><li class="w-full text-sm"><a class="transition hover:bg-base-300 rounded w-full flex p-1" data-tocid="complicated-form" href="#complicated-form">Complicated Form</a></li><li class="w-full text-sm"><a class="transition hover:bg-base-300 rounded w-full flex p-1" data-tocid="no-easy-solutions" href="#no-easy-solutions">No Easy Solutions</a></li></ul></li><li class="w-full text-sm"><a class="transition hover:bg-base-300 rounded w-full flex p-1" data-tocid="maybe-not-re-renders" href="#maybe-not-re-renders">Maybe Not Re-renders?</a></li><li class="w-full text-sm"><a class="transition hover:bg-base-300 rounded w-full flex p-1" data-tocid="profiling-profiling-profiling" href="#profiling-profiling-profiling">Profiling, Profiling, Profiling</a></li><li class="w-full text-sm"><a class="transition hover:bg-base-300 rounded w-full flex p-1" data-tocid="large-quantity-of-options" href="#large-quantity-of-options">Large Quantity of Options</a></li></ul></li><li class="w-full text-sm"><a class="transition hover:bg-base-300 rounded w-full flex p-1" data-tocid="solution" href="#solution">Solution</a></li><li class="w-full text-sm"><a class="transition hover:bg-base-300 rounded w-full flex p-1" data-tocid="verdict" href="#verdict">Verdict</a></li></ul></div></div></div></div><div class="max-w-7xl mx-auto p-4"></div><div class="max-w-7xl mx-auto p-4"><div><h2 class="text-2xl font-bold mb-2 flex items-center"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 576 512" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M416 192c0-88.4-93.1-160-208-160S0 103.6 0 192c0 34.3 14.1 65.9 38 92-13.4 30.2-35.5 54.2-35.8 54.5-2.2 2.3-2.8 5.7-1.5 8.7S4.8 352 8 352c36.6 0 66.9-12.3 88.7-25 32.2 15.7 70.3 25 111.3 25 114.9 0 208-71.6 208-160zm122 220c23.9-26 38-57.7 38-92 0-66.9-53.5-124.2-129.3-148.1.9 6.6 1.3 13.3 1.3 20.1 0 105.9-107.7 192-240 192-10.8 0-21.3-.8-31.7-1.9C207.8 439.6 281.8 480 368 480c41 0 79.1-9.2 111.3-25 21.8 12.7 52.1 25 88.7 25 3.2 0 6.1-1.9 7.3-4.8 1.3-2.9.7-6.3-1.5-8.7-.3-.3-22.4-24.2-35.8-54.5z"></path></svg><span class="mx-2"> 评论</span></h2></div></div></div></article></div><footer class="bg-base-200 text-base-content"><div class="footer py-6 max-w-7xl mx-auto px-4"><div class="space-y-1"><p>👨🏼‍💻 <!-- -->本网站由<a class="link link-hover" href="/about/me/cn">ddadaal</a>自豪地编写</p><p>📝<!-- -->本站文章在<a rel="licene noreferrer" target="_blank" class="link" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a>协议下授权</p><div class="tooltip" data-tip="2018-11-17 06:51:00 UTC+0"><p>📅<!-- --> <!-- -->博客已经运行 <span class="countdown"><span style="--value:6"></span></span> 年 <span class="countdown"><span style="--value:4"></span></span> 月 <span class="countdown"><span style="--value:23"></span></span> 天 <span class="countdown"><span style="--value:5"></span></span> 时 <span class="countdown"><span style="--value:15"></span></span> 分 <span class="countdown"><span style="--value:54"></span></span> 秒</p></div><p>⏲️<!-- --> <!-- -->最后更新<!-- -->:  <!-- -->2025-03-08 12:06:54 UTC+0</p><div><p>📲<!-- --> <!-- -->联系我</p><div class="flex py-2 gap-2"><span><a href="http://wpa.qq.com/msgrd?v=3&amp;uin=540232834&amp;site=qq&amp;menu=yes" title="QQ: 540232834" target="_blank" class="block transition hover:scale-125" rel="noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="22.400000000000002" width="22.400000000000002" xmlns="http://www.w3.org/2000/svg"><path d="M433.754 420.445c-11.526 1.393-44.86-52.741-44.86-52.741 0 31.345-16.136 72.247-51.051 101.786 16.842 5.192 54.843 19.167 45.803 34.421-7.316 12.343-125.51 7.881-159.632 4.037-34.122 3.844-152.316 8.306-159.632-4.037-9.045-15.25 28.918-29.214 45.783-34.415-34.92-29.539-51.059-70.445-51.059-101.792 0 0-33.334 54.134-44.859 52.741-5.37-.65-12.424-29.644 9.347-99.704 10.261-33.024 21.995-60.478 40.144-105.779C60.683 98.063 108.982.006 224 0c113.737.006 163.156 96.133 160.264 214.963 18.118 45.223 29.912 72.85 40.144 105.778 21.768 70.06 14.716 99.053 9.346 99.704z"></path></svg></a></span><span><a href="mailto://ddadaal.me@outlook.com" title="E-mail: ddadaal@outlook.com" target="_blank" class="block transition hover:scale-125" rel="noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 576 512" height="22.400000000000002" width="22.400000000000002" xmlns="http://www.w3.org/2000/svg"><path d="M160 448c-25.6 0-51.2-22.4-64-32-64-44.8-83.2-60.8-96-70.4V480c0 17.67 14.33 32 32 32h256c17.67 0 32-14.33 32-32V345.6c-12.8 9.6-32 25.6-96 70.4-12.8 9.6-38.4 32-64 32zm128-192H32c-17.67 0-32 14.33-32 32v16c25.6 19.2 22.4 19.2 115.2 86.4 9.6 6.4 28.8 25.6 44.8 25.6s35.2-19.2 44.8-22.4c92.8-67.2 89.6-67.2 115.2-86.4V288c0-17.67-14.33-32-32-32zm256-96H224c-17.67 0-32 14.33-32 32v32h96c33.21 0 60.59 25.42 63.71 57.82l.29-.22V416h192c17.67 0 32-14.33 32-32V192c0-17.67-14.33-32-32-32zm-32 128h-64v-64h64v64zm-352-96c0-35.29 28.71-64 64-64h224V32c0-17.67-14.33-32-32-32H96C78.33 0 64 14.33 64 32v192h96v-32z"></path></svg></a></span><span><a href="https://www.linkedin.com/in/chenjunda/" title="LinkedIn: 陈俊达" target="_blank" class="block transition hover:scale-125" rel="noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" height="22.400000000000002" width="22.400000000000002" xmlns="http://www.w3.org/2000/svg"><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"></path></svg></a></span><span><a href="https://github.com/ddadaal" title="GitHub: ddadaal" target="_blank" class="block transition hover:scale-125" rel="noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="22.400000000000002" width="22.400000000000002" xmlns="http://www.w3.org/2000/svg"><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"></path></svg></a></span><span><a href="https://steamcommunity.com/profiles/76561198104889782" title="Steam: Victor Crubs" target="_blank" class="block transition hover:scale-125" rel="noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 496 512" height="22.400000000000002" width="22.400000000000002" xmlns="http://www.w3.org/2000/svg"><path d="M496 256c0 137-111.2 248-248.4 248-113.8 0-209.6-76.3-239-180.4l95.2 39.3c6.4 32.1 34.9 56.4 68.9 56.4 39.2 0 71.9-32.4 70.2-73.5l84.5-60.2c52.1 1.3 95.8-40.9 95.8-93.5 0-51.6-42-93.5-93.7-93.5s-93.7 42-93.7 93.5v1.2L176.6 279c-15.5-.9-30.7 3.4-43.5 12.1L0 236.1C10.2 108.4 117.1 8 247.6 8 384.8 8 496 119 496 256zM155.7 384.3l-30.5-12.6a52.79 52.79 0 0 0 27.2 25.8c26.9 11.2 57.8-1.6 69-28.4 5.4-13 5.5-27.3.1-40.3-5.4-13-15.5-23.2-28.5-28.6-12.9-5.4-26.7-5.2-38.9-.6l31.5 13c19.8 8.2 29.2 30.9 20.9 50.7-8.3 19.9-31 29.2-50.8 21zm173.8-129.9c-34.4 0-62.4-28-62.4-62.3s28-62.3 62.4-62.3 62.4 28 62.4 62.3-27.9 62.3-62.4 62.3zm.1-15.6c25.9 0 46.9-21 46.9-46.8 0-25.9-21-46.8-46.9-46.8s-46.9 21-46.9 46.8c.1 25.8 21.1 46.8 46.9 46.8z"></path></svg></a></span><span><a href="https://zhihu.com/people/VicCrubs" title="知乎：陈俊达" target="_blank" class="block transition hover:scale-125" rel="noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 640 512" height="22.400000000000002" width="22.400000000000002" xmlns="http://www.w3.org/2000/svg"><path d="M170.54 148.13v217.54l23.43.01 7.71 26.37 42.01-26.37h49.53V148.13H170.54zm97.75 193.93h-27.94l-27.9 17.51-5.08-17.47-11.9-.04V171.75h72.82v170.31zm-118.46-94.39H97.5c1.74-27.1 2.2-51.59 2.2-73.46h51.16s1.97-22.56-8.58-22.31h-88.5c3.49-13.12 7.87-26.66 13.12-40.67 0 0-24.07 0-32.27 21.57-3.39 8.9-13.21 43.14-30.7 78.12 5.89-.64 25.37-1.18 36.84-22.21 2.11-5.89 2.51-6.66 5.14-14.53h28.87c0 10.5-1.2 66.88-1.68 73.44H20.83c-11.74 0-15.56 23.62-15.56 23.62h65.58C66.45 321.1 42.83 363.12 0 396.34c20.49 5.85 40.91-.93 51-9.9 0 0 22.98-20.9 35.59-69.25l53.96 64.94s7.91-26.89-1.24-39.99c-7.58-8.92-28.06-33.06-36.79-41.81L87.9 311.95c4.36-13.98 6.99-27.55 7.87-40.67h61.65s-.09-23.62-7.59-23.62v.01zm412.02-1.6c20.83-25.64 44.98-58.57 44.98-58.57s-18.65-14.8-27.38-4.06c-6 8.15-36.83 48.2-36.83 48.2l19.23 14.43zm-150.09-59.09c-9.01-8.25-25.91 2.13-25.91 2.13s39.52 55.04 41.12 57.45l19.46-13.73s-25.67-37.61-34.66-45.86h-.01zM640 258.35c-19.78 0-130.91.93-131.06.93v-101c4.81 0 12.42-.4 22.85-1.2 40.88-2.41 70.13-4 87.77-4.81 0 0 12.22-27.19-.59-33.44-3.07-1.18-23.17 4.58-23.17 4.58s-165.22 16.49-232.36 18.05c1.6 8.82 7.62 17.08 15.78 19.55 13.31 3.48 22.69 1.7 49.15.89 24.83-1.6 43.68-2.43 56.51-2.43v99.81H351.41s2.82 22.31 25.51 22.85h107.94v70.92c0 13.97-11.19 21.99-24.48 21.12-14.08.11-26.08-1.15-41.69-1.81 1.99 3.97 6.33 14.39 19.31 21.84 9.88 4.81 16.17 6.57 26.02 6.57 29.56 0 45.67-17.28 44.89-45.31v-73.32h122.36c9.68 0 8.7-23.78 8.7-23.78l.03-.01z"></path></svg></a></span><span><a href="https://www.douban.com/people/183064260/" title="豆瓣: ddadaal" target="_blank" class="block transition hover:scale-125" rel="noreferrer"><svg stroke="currentColor" fill="currentColor" stroke-width="0" role="img" viewBox="0 0 24 24" height="22.400000000000002" width="22.400000000000002" xmlns="http://www.w3.org/2000/svg"><path d="M.51 3.06h22.98V.755H.51V3.06Zm20.976 2.537v9.608h-2.137l-1.669 5.76H24v2.28H0v-2.28h6.32l-1.67-5.76H2.515V5.597h18.972Zm-5.066 9.608H7.58l1.67 5.76h5.501l1.67-5.76ZM18.367 7.9H5.634v5.025h12.733V7.9Z"></path></svg></a></span></div></div><p class="text-center">©<!-- --> <!-- -->2025<!-- --> <!-- -->|<!-- --> <!-- -->用 ❤ 制作</p></div><div><span class="footer-title">🚀<!-- --> <!-- -->强力驱动</span><a class="link link-hover" target="_blank" href="https://reactjs.org/" rel="noreferrer">React</a><a class="link link-hover" target="_blank" href="https://nextjs.org/" rel="noreferrer">Next.js</a><a class="link link-hover" target="_blank" href="https://pages.github.com/" rel="noreferrer">GitHub Pages</a><a class="link link-hover" target="_blank" href="https://www.typescriptlang.org/" rel="noreferrer">TypeScript</a></div><div><span class="footer-title">🎨<!-- --> <!-- -->描绘主题</span><a class="link link-hover" target="_blank" href="https://daisyui.com/" rel="noreferrer">daisyui</a><a class="link link-hover" target="_blank" href="https://tailwindcss.com/" rel="noreferrer">tailwind</a></div><div><span class="footer-title">🎓<!-- --> <!-- -->联系我</span><a class="link link-hover" target="_blank" href="https://idealclover.top" rel="noreferrer">idealclover - 翠翠酱的个人网站</a><a class="link link-hover" target="_blank" href="https://sephidator.xyz" rel="noreferrer">Sephidator - Sephidator的个人博客</a><a class="link link-hover" target="_blank" href="https://iznauy.github.io/" rel="noreferrer">iznauy - 个人博客</a><a class="link link-hover" target="_blank" href="https://aironoria.github.io" rel="noreferrer">Aironoria - 陈俊宇的个人博客</a><a class="link link-hover" target="_blank" href="https://jbesu.com/" rel="noreferrer">forewing - 个人主页</a><a class="link link-hover" target="_blank" href="https://weiser.fun" rel="noreferrer">Weiser - 个人主页</a></div></div></footer><button class="fixed animate-slide-up bottom-8 right-8 z-50 p-3 rounded-full bg-base-300 text-base-content shadow" title="To top"><svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 448 512" class="w-6 h-6" height="1em" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M34.9 289.5l-22.2-22.2c-9.4-9.4-9.4-24.6 0-33.9L207 39c9.4-9.4 24.6-9.4 33.9 0l194.3 194.3c9.4 9.4 9.4 24.6 0 33.9L413 289.4c-9.5 9.5-25 9.3-34.3-.4L264 168.6V456c0 13.3-10.7 24-24 24h-32c-13.3 0-24-10.7-24-24V168.6L69.2 289.1c-9.3 9.8-24.8 10-34.3.4z"></path></svg></button><script src="/_next/static/chunks/webpack-2a9780a61575fd97.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n3:I[6221,[],\"\"]\n4:I[5657,[],\"\"]\n6:I[8002,[],\"OutletBoundary\"]\n8:I[8002,[],\"MetadataBoundary\"]\na:I[8002,[],\"ViewportBoundary\"]\nc:I[4404,[],\"\"]\n:HL[\"/_next/static/css/54c4c90f0e4aaa79.css\",\"style\"]\n:HL[\"/_next/static/css/fe1e54f11bde7158.css\",\"style\"]\n:HL[\"/_next/static/css/0e452e629ebb050b.css\",\"style\"]\n:HL[\"/_next/static/css/550cc6711c036586.css\",\"style\"]\n:HL[\"/_next/static/css/84af3e6cc7365e2a.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"hA_JT8TuDDq5HcqFuL77o\",\"p\":\"\",\"c\":[\"\",\"articles\",\"a-react-form-comp-pref-optimization-with-profiler\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"articles\",{\"children\":[[\"params\",\"a-react-form-comp-pref-optimization-with-profiler\",\"oc\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/54c4c90f0e4aaa79.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],\"$L2\"]}],{\"children\":[\"articles\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"articles\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"params\",\"a-react-form-comp-pref-optimization-with-profiler\",\"oc\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"articles\",\"children\",\"$0:f:0:1:2:children:2:children:0\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L5\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/fe1e54f11bde7158.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"1\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/0e452e629ebb050b.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"2\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/550cc6711c036586.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}],[\"$\",\"link\",\"3\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/84af3e6cc7365e2a.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$L6\",null,{\"children\":\"$L7\"}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"Ze08V4rPG4rt_KvNc1x75\",{\"children\":[[\"$\",\"$L8\",null,{\"children\":\"$L9\"}],[\"$\",\"$La\",null,{\"children\":\"$Lb\"}],null]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$c\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"d:I[1574,[\"116\",\"static/chunks/c556396d-6bde9789d0a41114.js\",\"845\",\"static/chunks/845-a0203995fac91684.js\",\"57\",\"static/chunks/57-3951d65188499c8f.js\",\"325\",\"static/chunks/325-924239ad7bda233c.js\",\"177\",\"static/chunks/app/layout-7026065b75b2b00f.js\"],\"RootLayout\"]\ne:I[2061,[\"116\",\"static/chunks/c556396d-6bde9789d0a41114.js\",\"845\",\"static/chunks/845-a0203995fac91684.js\",\"57\",\"static/chunks/57-3951d65188499c8f.js\",\"325\",\"static/chunks/325-924239ad7bda233c.js\",\"177\",\"static/chunks/app/layout-7026065b75b2b00f.js\"],\"\"]\nf:I[2725,[\"116\",\"static/chunks/c556396d-6bde9789d0a41114.js\",\"845\",\"static/chunks/845-a0203995fac91684.js\",\"57\",\"static/chunks/57-3951d65188499c8f.js\",\"325\",\"static/chunks/325-924239ad7bda233c.js\",\"177\",\"static/chunks/app/layout-7026065b75b2b00f.js\"],\"Header\"]\n10:I[7583,[\"845\",\"static/chunks/845-a0203995fac91684.js\",\"57\",\"static/chunks/57-3951d65188499c8f.js\",\"974\",\"static/chunks/app/page-6cd03741a79daf91.js\"],\"Localized\"]\n11:I[1453,[\"845\",\"static/chunks/845-a0203995fac91684.js\",\"57\",\"static/chunks/57-3951d65188499c8f.js\",\"974\",\"static/chunks/app/page-6cd03741a79daf91.js\"],\"LocalizedArticleLink\"]\n12:I[8077,[\"116\",\"static/chunks/c556396d-6bde9789d0a41114.js\",\"845\",\"static/chunks/845-a0203995fac91684.js\",\"57\",\"static/chunks/57-3951d65188499c8f.js\",\"325\",\"static/chunks/325-924239ad7bda233c.js\",\"177\",\"static/chunks/app/layout-7026065b75b2b00f.js\"],\"RunningTime\"]\n13:I[665,[\"845\",\"static/chunks/845-a0203995fac91684.js\",\"57\",\"static/chunks/57-3951d65188499c8f.js\",\"974\",\"static/chunks/app/page-6cd03741a79daf91.js\"],\"LastUpdateTime\"]\n16:I[7365,[\"116\",\"static/chunks/c556396d-6bde9789d0a41114.js\",\"845\",\"static/chunks/845-a0203995fac91684.js\",\"57\",\"static/chunks/57-3951d65188499c8f.js\",\"325\",\"static/chunks/325-924239ad7bda233c.js\",\"177\",\"static/chunks/app/layout-7026065b75b2b00f.js\"],\"ToTop\"]\n14:T518,M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9"])</script><script>self.__next_f.push([1,".3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z15:T5b8,M170.54 148.13v217.54l23.43.01 7.71 26.37 42.01-26.37h49.53V148.13H170.54zm97.75 193.93h-27.94l-27.9 17.51-5.08-17.47-11.9-.04V171.75h72.82v170.31zm-118.46-94.39H97.5c1.74-27.1 2.2-51.59 2.2-73.46h51.16s1.97-22.56-8.58-22.31h-88.5c3.49-13.12 7.87-26.66 13.12-40.67 0 0-24.07 0-32.27 21.57-3.39 8.9-13.21 43.14-30.7 78.12 5.89-.64 25.37-1.18 36.84-22.21 2.11-5.89 2.51-6.66 5.14-14.53h28.87c0 10.5-1.2 66.88-1.68 73.44H20.83c-11.74 0-15.56 23.62-15.56 23.62h65.58C66.45 321.1 42.83 363.12 0 396.34c20.49 5.85 40.91-.93 51-9.9 0 0 22.98-20.9 35.59-69.25l53.96 64.94s7.91-26.89-1.24-39.99c-7.58-8.92-28.06-33.06-36.79-41.81L87.9 311.95c4.36-13.98 6.99-27.55 7.87-40.67h61.65s-.09-23.62-7.59-23.62v.01zm412.02-1.6c20.83-25.64 44.98-58.57 44.98-58.57s-18.65-14.8-27.38-4.06c-6 8.15-36.83 48.2-36.83 48.2l19.23 14.43zm-150.09-59.09c-9.01-8.25-25.91 2.13-25.91 2.13s39.52 55.04 41.12 57.45l19.46-13.73s-25.67-37.61-34.66-45.86h-.01zM640 258.35c-19.78 0-130.91.9"])</script><script>self.__next_f.push([1,"3-131.06.93v-101c4.81 0 12.42-.4 22.85-1.2 40.88-2.41 70.13-4 87.77-4.81 0 0 12.22-27.19-.59-33.44-3.07-1.18-23.17 4.58-23.17 4.58s-165.22 16.49-232.36 18.05c1.6 8.82 7.62 17.08 15.78 19.55 13.31 3.48 22.69 1.7 49.15.89 24.83-1.6 43.68-2.43 56.51-2.43v99.81H351.41s2.82 22.31 25.51 22.85h107.94v70.92c0 13.97-11.19 21.99-24.48 21.12-14.08.11-26.08-1.15-41.69-1.81 1.99 3.97 6.33 14.39 19.31 21.84 9.88 4.81 16.17 6.57 26.02 6.57 29.56 0 45.67-17.28 44.89-45.31v-73.32h122.36c9.68 0 8.7-23.78 8.7-23.78l.03-.01z"])</script><script>self.__next_f.push([1,"2:[\"$\",\"$Ld\",null,{\"children\":[[\"$\",\"$Le\",null,{\"data-host\":\"https://services.ddadaal.me\",\"data-dnt\":\"false\",\"src\":\"https://services.ddadaal.me/monitor/script.js\",\"id\":\"ZwSg9rf6GA\",\"async\":true,\"defer\":true}],[\"$\",\"$Lf\",null,{\"resumeLangs\":[\"cn\",\"en\"]}],[\"$\",\"div\",null,{\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[],[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"footer\",null,{\"className\":\"bg-base-200 text-base-content\",\"children\":[\"$\",\"div\",null,{\"className\":\"footer py-6 max-w-7xl mx-auto px-4\",\"children\":[[\"$\",\"div\",null,{\"className\":\"space-y-1\",\"children\":[[\"$\",\"p\",null,{\"children\":[\"👨🏼‍💻 \",[\"$\",\"$L10\",null,{\"id\":\"footer.codeBy\",\"args\":[[\"$\",\"$L11\",\"about/me\",{\"className\":\"link link-hover\",\"basePath\":\"/about/me\",\"children\":\"ddadaal\"}]]}]]}],[\"$\",\"p\",null,{\"children\":[\"📝\",[\"$\",\"$L10\",null,{\"id\":\"footer.license\",\"args\":[[\"$\",\"a\",\"license\",{\"rel\":\"licene noreferrer\",\"target\":\"_blank\",\"className\":\"link\",\"href\":\"https://creativecommons.org/licenses/by-sa/4.0/\",\"children\":\"CC BY-SA 4.0\"}]]}]]}],[\"$\",\"$L12\",null,{\"serverStartTime\":\"2025-03-08T12:06:54.279+00:00\"}],[\"$\",\"$L13\",null,{\"time\":\"2025-03-08T12:06:54.279+00:00\"}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"p\",null,{\"children\":[\"📲\",\" \",[\"$\",\"$L10\",null,{\"id\":\"footer.contacts\"}]]}],[\"$\",\"div\",null,{\"className\":\"flex py-2 gap-2\",\"children\":[[\"$\",\"span\",\"http://wpa.qq.com/msgrd?v=3\u0026uin=540232834\u0026site=qq\u0026menu=yes\",{\"children\":[\"$\",\"a\",null,{\"href\":\"http://wpa.qq.com/msgrd?v=3\u0026uin=540232834\u0026site=qq\u0026menu=yes\",\"title\":\"QQ: 540232834\",\"target\":\"_blank\",\"className\":\"block transition hover:scale-125\",\"rel\":\"noreferrer\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 448 512\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M433.754 420.445c-11.526 1.393-44.86-52.741-44.86-52.741 0 31.345-16.136 72.247-51.051 101.786 16.842 5.192 54.843 19.167 45.803 34.421-7.316 12.343-125.51 7.881-159.632 4.037-34.122 3.844-152.316 8.306-159.632-4.037-9.045-15.25 28.918-29.214 45.783-34.415-34.92-29.539-51.059-70.445-51.059-101.792 0 0-33.334 54.134-44.859 52.741-5.37-.65-12.424-29.644 9.347-99.704 10.261-33.024 21.995-60.478 40.144-105.779C60.683 98.063 108.982.006 224 0c113.737.006 163.156 96.133 160.264 214.963 18.118 45.223 29.912 72.85 40.144 105.778 21.768 70.06 14.716 99.053 9.346 99.704z\",\"children\":[]}]]],\"className\":\"$undefined\",\"style\":{\"color\":\"$undefined\"},\"height\":22.400000000000002,\"width\":22.400000000000002,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}]}],[\"$\",\"span\",\"mailto://ddadaal.me@outlook.com\",{\"children\":[\"$\",\"a\",null,{\"href\":\"mailto://ddadaal.me@outlook.com\",\"title\":\"E-mail: ddadaal@outlook.com\",\"target\":\"_blank\",\"className\":\"block transition hover:scale-125\",\"rel\":\"noreferrer\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 576 512\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M160 448c-25.6 0-51.2-22.4-64-32-64-44.8-83.2-60.8-96-70.4V480c0 17.67 14.33 32 32 32h256c17.67 0 32-14.33 32-32V345.6c-12.8 9.6-32 25.6-96 70.4-12.8 9.6-38.4 32-64 32zm128-192H32c-17.67 0-32 14.33-32 32v16c25.6 19.2 22.4 19.2 115.2 86.4 9.6 6.4 28.8 25.6 44.8 25.6s35.2-19.2 44.8-22.4c92.8-67.2 89.6-67.2 115.2-86.4V288c0-17.67-14.33-32-32-32zm256-96H224c-17.67 0-32 14.33-32 32v32h96c33.21 0 60.59 25.42 63.71 57.82l.29-.22V416h192c17.67 0 32-14.33 32-32V192c0-17.67-14.33-32-32-32zm-32 128h-64v-64h64v64zm-352-96c0-35.29 28.71-64 64-64h224V32c0-17.67-14.33-32-32-32H96C78.33 0 64 14.33 64 32v192h96v-32z\",\"children\":[]}]]],\"className\":\"$undefined\",\"style\":{\"color\":\"$undefined\"},\"height\":22.400000000000002,\"width\":22.400000000000002,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}]}],[\"$\",\"span\",\"https://www.linkedin.com/in/chenjunda/\",{\"children\":[\"$\",\"a\",null,{\"href\":\"https://www.linkedin.com/in/chenjunda/\",\"title\":\"LinkedIn: 陈俊达\",\"target\":\"_blank\",\"className\":\"block transition hover:scale-125\",\"rel\":\"noreferrer\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 448 512\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z\",\"children\":[]}]]],\"className\":\"$undefined\",\"style\":{\"color\":\"$undefined\"},\"height\":22.400000000000002,\"width\":22.400000000000002,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}]}],[\"$\",\"span\",\"https://github.com/ddadaal\",{\"children\":[\"$\",\"a\",null,{\"href\":\"https://github.com/ddadaal\",\"title\":\"GitHub: ddadaal\",\"target\":\"_blank\",\"className\":\"block transition hover:scale-125\",\"rel\":\"noreferrer\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 496 512\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"$14\",\"children\":[]}]]],\"className\":\"$undefined\",\"style\":{\"color\":\"$undefined\"},\"height\":22.400000000000002,\"width\":22.400000000000002,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}]}],[\"$\",\"span\",\"https://steamcommunity.com/profiles/76561198104889782\",{\"children\":[\"$\",\"a\",null,{\"href\":\"https://steamcommunity.com/profiles/76561198104889782\",\"title\":\"Steam: Victor Crubs\",\"target\":\"_blank\",\"className\":\"block transition hover:scale-125\",\"rel\":\"noreferrer\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 496 512\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M496 256c0 137-111.2 248-248.4 248-113.8 0-209.6-76.3-239-180.4l95.2 39.3c6.4 32.1 34.9 56.4 68.9 56.4 39.2 0 71.9-32.4 70.2-73.5l84.5-60.2c52.1 1.3 95.8-40.9 95.8-93.5 0-51.6-42-93.5-93.7-93.5s-93.7 42-93.7 93.5v1.2L176.6 279c-15.5-.9-30.7 3.4-43.5 12.1L0 236.1C10.2 108.4 117.1 8 247.6 8 384.8 8 496 119 496 256zM155.7 384.3l-30.5-12.6a52.79 52.79 0 0 0 27.2 25.8c26.9 11.2 57.8-1.6 69-28.4 5.4-13 5.5-27.3.1-40.3-5.4-13-15.5-23.2-28.5-28.6-12.9-5.4-26.7-5.2-38.9-.6l31.5 13c19.8 8.2 29.2 30.9 20.9 50.7-8.3 19.9-31 29.2-50.8 21zm173.8-129.9c-34.4 0-62.4-28-62.4-62.3s28-62.3 62.4-62.3 62.4 28 62.4 62.3-27.9 62.3-62.4 62.3zm.1-15.6c25.9 0 46.9-21 46.9-46.8 0-25.9-21-46.8-46.9-46.8s-46.9 21-46.9 46.8c.1 25.8 21.1 46.8 46.9 46.8z\",\"children\":[]}]]],\"className\":\"$undefined\",\"style\":{\"color\":\"$undefined\"},\"height\":22.400000000000002,\"width\":22.400000000000002,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}]}],[\"$\",\"span\",\"https://zhihu.com/people/VicCrubs\",{\"children\":[\"$\",\"a\",null,{\"href\":\"https://zhihu.com/people/VicCrubs\",\"title\":\"知乎：陈俊达\",\"target\":\"_blank\",\"className\":\"block transition hover:scale-125\",\"rel\":\"noreferrer\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 640 512\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"$15\",\"children\":[]}]]],\"className\":\"$undefined\",\"style\":{\"color\":\"$undefined\"},\"height\":22.400000000000002,\"width\":22.400000000000002,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}]}],[\"$\",\"span\",\"https://www.douban.com/people/183064260/\",{\"children\":[\"$\",\"a\",null,{\"href\":\"https://www.douban.com/people/183064260/\",\"title\":\"豆瓣: ddadaal\",\"target\":\"_blank\",\"className\":\"block transition hover:scale-125\",\"rel\":\"noreferrer\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"role\":\"img\",\"viewBox\":\"0 0 24 24\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"M.51 3.06h22.98V.755H.51V3.06Zm20.976 2.537v9.608h-2.137l-1.669 5.76H24v2.28H0v-2.28h6.32l-1.67-5.76H2.515V5.597h18.972Zm-5.066 9.608H7.58l1.67 5.76h5.501l1.67-5.76ZM18.367 7.9H5.634v5.025h12.733V7.9Z\",\"children\":[]}]]],\"className\":\"$undefined\",\"style\":{\"color\":\"$undefined\"},\"height\":22.400000000000002,\"width\":22.400000000000002,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}]}]]}]]}],[\"$\",\"p\",null,{\"className\":\"text-center\",\"children\":[\"©\",\" \",2025,\" \",\"|\",\" \",[\"$\",\"$L10\",null,{\"id\":\"footer.madeWithLove\"}]]}]]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"footer-title\",\"children\":[\"🚀\",\" \",[\"$\",\"$L10\",null,{\"id\":\"footer.poweredBy\"}]]}],[[\"$\",\"a\",\"React\",{\"className\":\"link link-hover\",\"target\":\"_blank\",\"href\":\"https://reactjs.org/\",\"rel\":\"noreferrer\",\"children\":\"React\"}],[\"$\",\"a\",\"Next.js\",{\"className\":\"link link-hover\",\"target\":\"_blank\",\"href\":\"https://nextjs.org/\",\"rel\":\"noreferrer\",\"children\":\"Next.js\"}],[\"$\",\"a\",\"GitHub Pages\",{\"className\":\"link link-hover\",\"target\":\"_blank\",\"href\":\"https://pages.github.com/\",\"rel\":\"noreferrer\",\"children\":\"GitHub Pages\"}],[\"$\",\"a\",\"TypeScript\",{\"className\":\"link link-hover\",\"target\":\"_blank\",\"href\":\"https://www.typescriptlang.org/\",\"rel\":\"noreferrer\",\"children\":\"TypeScript\"}]]]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"footer-title\",\"children\":[\"🎨\",\" \",[\"$\",\"$L10\",null,{\"id\":\"footer.themedWith\"}]]}],[[\"$\",\"a\",\"daisyui\",{\"className\":\"link link-hover\",\"target\":\"_blank\",\"href\":\"https://daisyui.com/\",\"rel\":\"noreferrer\",\"children\":\"daisyui\"}],[\"$\",\"a\",\"tailwind\",{\"className\":\"link link-hover\",\"target\":\"_blank\",\"href\":\"https://tailwindcss.com/\",\"rel\":\"noreferrer\",\"children\":\"tailwind\"}]]]}],[\"$\",\"div\",null,{\"children\":[[\"$\",\"span\",null,{\"className\":\"footer-title\",\"children\":[\"🎓\",\" \",[\"$\",\"$L10\",null,{\"id\":\"footer.contacts\"}]]}],[[\"$\",\"a\",\"idealclover - 翠翠酱的个人网站\",{\"className\":\"link link-hover\",\"target\":\"_blank\",\"href\":\"https://idealclover.top\",\"rel\":\"noreferrer\",\"children\":\"idealclover - 翠翠酱的个人网站\"}],[\"$\",\"a\",\"Sephidator - Sephidator的个人博客\",{\"className\":\"link link-hover\",\"target\":\"_blank\",\"href\":\"https://sephidator.xyz\",\"rel\":\"noreferrer\",\"children\":\"Sephidator - Sephidator的个人博客\"}],[\"$\",\"a\",\"iznauy - 个人博客\",{\"className\":\"link link-hover\",\"target\":\"_blank\",\"href\":\"https://iznauy.github.io/\",\"rel\":\"noreferrer\",\"children\":\"iznauy - 个人博客\"}],[\"$\",\"a\",\"Aironoria - 陈俊宇的个人博客\",{\"className\":\"link link-hover\",\"target\":\"_blank\",\"href\":\"https://aironoria.github.io\",\"rel\":\"noreferrer\",\"children\":\"Aironoria - 陈俊宇的个人博客\"}],[\"$\",\"a\",\"forewing - 个人主页\",{\"className\":\"link link-hover\",\"target\":\"_blank\",\"href\":\"https://jbesu.com/\",\"rel\":\"noreferrer\",\"children\":\"forewing - 个人主页\"}],[\"$\",\"a\",\"Weiser - 个人主页\",{\"className\":\"link link-hover\",\"target\":\"_blank\",\"href\":\"https://weiser.fun\",\"rel\":\"noreferrer\",\"children\":\"Weiser - 个人主页\"}]]]}]]}]}],[\"$\",\"$L16\",null,{}]]}]\n"])</script><script>self.__next_f.push([1,"17:I[4378,[\"116\",\"static/chunks/c556396d-6bde9789d0a41114.js\",\"413\",\"static/chunks/7a1bdfe6-8f7609c25899d936.js\",\"994\",\"static/chunks/c4aeae87-2a85323a0275cbf9.js\",\"786\",\"static/chunks/1b3e99d6-50521588821d44ca.js\",\"845\",\"static/chunks/845-a0203995fac91684.js\",\"57\",\"static/chunks/57-3951d65188499c8f.js\",\"826\",\"static/chunks/826-c44bffd752ec02cd.js\",\"467\",\"static/chunks/467-ff6f7f0e9f0462a7.js\",\"971\",\"static/chunks/app/articles/%5B%5B...params%5D%5D/page-59c8401fd7fff2e0.js\"],\"ArticleFrontmatter\"]\n1a:I[4674,[\"116\",\"static/chunks/c556396d-6bde9789d0a41114.js\",\"413\",\"static/chunks/7a1bdfe6-8f7609c25899d936.js\",\"994\",\"static/chunks/c4aeae87-2a85323a0275cbf9.js\",\"786\",\"static/chunks/1b3e99d6-50521588821d44ca.js\",\"845\",\"static/chunks/845-a0203995fac91684.js\",\"57\",\"static/chunks/57-3951d65188499c8f.js\",\"826\",\"static/chunks/826-c44bffd752ec02cd.js\",\"467\",\"static/chunks/467-ff6f7f0e9f0462a7.js\",\"971\",\"static/chunks/app/articles/%5B%5B...params%5D%5D/page-59c8401fd7fff2e0.js\"],\"RelatedArticles\"]\n1b:I[3373,[\"116\",\"static/chunks/c556396d-6bde9789d0a41114.js\",\"413\",\"static/chunks/7a1bdfe6-8f7609c25899d936.js\",\"994\",\"static/chunks/c4aeae87-2a85323a0275cbf9.js\",\"786\",\"static/chunks/1b3e99d6-50521588821d44ca.js\",\"845\",\"static/chunks/845-a0203995fac91684.js\",\"57\",\"static/chunks/57-3951d65188499c8f.js\",\"826\",\"static/chunks/826-c44bffd752ec02cd.js\",\"467\",\"static/chunks/467-ff6f7f0e9f0462a7.js\",\"971\",\"static/chunks/app/articles/%5B%5B...params%5D%5D/page-59c8401fd7fff2e0.js\"],\"CommentPanelWithCurrentLanguage\"]\n18:T2a7c,"])</script><script>self.__next_f.push([1,"\n\u003e Note: This code is from an internal project. Measurements apply to protect confidential information, but the problem and methods mentioned in the article are universal and not limited to specific projects.\n\n# The Problem\n\nI was working on a form that had very poor performance. To be specific, at every key stroke, the form responded pretty slowly. What's worse, the component and the whole website became completely unresponsive for **seconds** if several keys were stroked sequentially (like input a long number), which was, unfortunately, the normal use case for this field.\n\n![bad performance, especially for the first input field](bad-pref.gif)\n\n# Investigation\n\n## Validations?\n\nFrom the gif provided above, you may find some details that are worth taking notice of:\n\n- The first field had the **worse performance**,\n- The first field had some kinds of input validation (loading indicator when the first inputs were registered),\n- The field below the first field had better performance than the first one, and it had no validation.\n\nHmm...It looks like **the validation** might be the cause.\n\nHowever, the validation process was merely some format check, and a request which would be cancelled if next key stroke had come before it completed. It did increase the delay of input, but should not be so significant.\n\n## Re-renders of the Whole Form?\n\n### The Challenge of Forms in React\n\nThe **re-render of the whole form at every input** might be the problem as well.\n\nReact has been known as *not good at implementing forms* because of its famous **unidirectional data flow**.\n\n![Source: https://gist.github.com/alexmingoia/4db967e5aeb31d84847c. See this page to get yourself familiarized if you haven't already.](unidirectiona-data-flow.png)\n\nUnidirectional data flow simplifies the data flow and fits seeminglessly with the concept of React. However, since **each update to the state will trigger the component to re-render**, it might impact the performance of the app.\n\nForm is one of such cases, because a form consists of multiple input fields, and **each input to any one of them** would update the state, and re-render the whole form and every other fields. Therefore, writing forms in React has always a challenge.\n\n### Complicated Form\n\nLooking at the code, the form was implemented in a very React way: the form contained all the fields, and handled every `onChange` event for each input fields.\n\n![part of fields](fields.png)\n\nThe form was complicated with dozens of fields, several **sync/async and cross-field validations**, **dynamic placeholders** and some unnecessary **duplicate calculations** (which could be improved with constants and cache).\n\nIt seemed pretty evident that the **re-renders** and **the complicated calculations** during the render were the cause to the problem.\n\n### No Easy Solutions\n\nHaving found the reason, what's left was to find a solution. However, the reason that form implementation is called a *challenge* in React is that it can not be solved easily. There are lots of React form library from the community (like [react-form](https://github.com/tannerlinsley/react-form), [formik](https://github.com/jaredpalmer/formik)) trying to solve the form as a whole by providing a complete solution to some common form challenges, including input management, async validations, and submission. They may be viable for many users and should be considered if you are having trouble building a form in your project, but I couldn't adopt them in this project because:\n\n- hiding complexities usually means introducing other complexities\n    - for example, when using the libraries, more problems are introduced, like **less flexibilities**, **less understandable code**, **interop with UI libraries** and **the cost of learning and adopting a new set of APIs**.\n- The code is involved with several internal concepts and conventions, which I am not familiar enough. As a result, I don't have the confidence to rewrite the logic correctly in a short time;\n- introducing a new library into this project is hard, for it is a internal project that has over 200K lines of TypeScript code, hundreds of authors and users, so the review for this project is strict.\n\n## Maybe Not Re-renders?\n\nBesides, my experiences told me that it was possibly not the **re-renders** that was to blame, since the updates of the form should not be so costly that would result in such a significant delay.\n\nI have encountered situations where even **a whole page** re-rendered at every interaction, but React and modern JavaScript engines is more than capable to drive it smoothly without even a stutter. This form had several fields to be re-rendered at every input, but when taking the whole page into consideration, the number of re-renders inside this page was negligible.\n\n## Profiling, Profiling, Profiling\n\nAfter wasting days on *brainstorming* the source of problem, I decided to diagnose the issue in a scientific way -- **profiling**.\n\n[React's official devtool of Chrome](https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi) has a built-in profiling tool. By recoding a sequence of user interactions, profiler can provide performance metrics on each commit during the record, like what components are re-rendered, how many time they take to re-render, with which the developer can locate the components that have biggest impact to the performance, and optimize them accordingly.\n\nStart the recoding, repeat the operations of the gif above, and I had the following result:\n\n![Ranked chart](profiling.png)\n![Flamegraph chart](profiling-2.png)\n\nThe first chart (ranked chart) showed the time to re-render for each component that had re-rendered on this commit. The second chart (flamegraph chart) shoed the re-rendered components **hierarchically**: that is, the time to render the component itself, and each of its children.\n\nAs you could see, a **Dropdown** component took a significant time to re-render. In fact, all the graphes on all the last 10 commits had led me to the same component. By following the hierarchy provided by the flamegraph, it didn't take long to locate the component, which was the dropdown **on the right side** of the first field with slow responsiveness, and implemented as follows:\n\n![The dropdown](dropdown.png)\n\nIt looked like a normal dropdown with the exception of a **duplicate calculations**: generating an options array at every render. **Providing different instances at every render** is a common source of performance problem in React, because it signals React that the props have changed and a re-render is required, even the objects between renders are **deep equal**. The solution is straightforward: instead of generating a different instance each time, provide a constant or a class field that only changes when it is modified.\n\nBut unfortunately, in this case, after replacing the call to `this.generateDropdown` to a constant, the problem persisted.\n\n## Large Quantity of Options\n\nThe source of options of the dropdown came from a network request that was initiated when the page loaded. Another clue that I found during investigation was that when network errors happened, the input became very **responsive**, at which time **the dropdown had no option**. And after several intentional experiments, I found the correspondance between options and performance to be true (no option -\u003e good performance, had options -\u003e bad performace).\n\nI was just a maintainer of the component, not the original authors, so I didn't take notice of the contents of dropdown during my previous investigation. Now, according to the correspondance, I checked out the options of the dropdown, only to find it had over 400 options.\n\n![\u003e400 options](large-number-of-options.png)\n\nRendering **so many options** at each render would definitely impact performance pretty hard, unless the component had thought of it and selectively re-rendered only the changed part.\n\nThis project used [React Wrapper of Semantic-UI](https://react.semantic-ui.com/) which was a famous component library and open source. By diving into the source code, I found that the dropdown did re-render every options every time without any memoing or caching.\n\nhttps://github.com/Semantic-Org/Semantic-UI-React/blob/master/src/modules/Dropdown/Dropdown.js#L1275\n\n```jsx\n// omitted\nrenderOptions = () =\u003e {\n  // omitted\n  return _.map(options, (opt, i) =\u003e\n    DropdownItem.create({\n      active: isActive(opt.value),\n      onClick: this.handleItemClick,\n      selected: selectedIndex === i,\n      ...opt,\n      key: getKeyOrValue(opt.key, opt.value),\n      // Needed for handling click events on disabled items\n      style: { ...opt.style, pointerEvents: 'all' },\n    }),\n  )\n}\n\nrenderMenu = () =\u003e {\n  // omitted\n  return (\n    \u003cDropdownMenu {...ariaOptions} direction={direction} open={open}\u003e\n      {DropdownHeader.create(header, { autoGenerateKey: false })}\n      {this.renderOptions()}\n    \u003c/DropdownMenu\u003e\n  )\n}\n\nrender() {\n  // omitted\n  return (\n    // omitted\n    {this.renderMenu()}\n    // omitted\n  )\n}\n```\n\n# Solution\n\nIn this case, the options didn't update anymore after the request had completed. Therefore, there was no need to update and re-render the options every time the component had changed.\n\nTo stop the re-render, I extracted the dropdown out into a separate component, passed the options as a prop, and most importantly, made it a `PureComponent` which only re-rendered itself when the props had changed.\n\nThe dropdown was used in a **uncontrolled** way -- that is, not managing its `value` by the DOM instead of as a state of React component by not passing value to the `input` DOM field. I had to admit it was not the React way, but here, not passing value to it meant that the component would **never update**, which was exactly what I wanted.\n\n![Optimized code](optimized-code.png)\n\nThe optimization worked like a charm: the render time of the whole form for each input had reduced from **~400ms** to **~22ms**, and there was no any unresponsiveness and delay at every key stroke.\n\n![After](after.png)\n\n# Verdict\n\nForm is React is indeed a challenge. Without careful designing and implementation, problems may occur at any time, anywhere.\n\nThe issue here was ultimately the re-renders, but not the form I originally thought of, but the dropdown with large number of options. It is important to app performance to **understand React update strategy** and **control the component update** with lifecycle functions, property hook usage, memoing and caching, especially when the the number of component to render is too large.\n\nThe **profiler** was the key to finding the component to blame by providing the data of time to re-render for each component. Therefore, when a performance issue is detected, stop wasting guessing which compoenent causes it, and let profiler take you straight to it.\n"])</script><script>self.__next_f.push([1,"5:[\"$\",\"article\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"bg-neutral px-4 py-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"max-w-7xl mx-auto min-h-[256px] flex justify-center text-center text-neutral-content\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col justify-center animate-slide-up\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-4xl my-2\",\"children\":\"A React Form Component Performance Optimization with Profiler\"}],[\"$\",\"$L17\",null,{\"className\":\"justify-center\",\"articleId\":\"a-react-form-comp-pref-optimization-with-profiler\",\"info\":{\"content\":\"$18\",\"title\":\"A React Form Component Performance Optimization with Profiler\",\"date\":\"2019-10-13 11:14\",\"id\":\"a-react-form-comp-pref-optimization-with-profiler\",\"lang\":\"en\",\"tags\":[\"problem-investigation\",\"web-frontend\",\"React\"],\"related\":\"$undefined\",\"ignored_in_list\":\"$undefined\",\"hide_heading\":\"$undefined\",\"no_toc\":\"$undefined\",\"absolute_path\":\"$undefined\",\"last_updated\":\"$undefined\",\"wordCount\":1628,\"readingTime\":8.14,\"filePath\":\"contents/20191012-a-react-form-comp-pref-optimization-with-profiler/en.md\",\"summary\":{\"articleId\":\"a-react-form-comp-pref-optimization-with-profiler\",\"lang\":\"en\",\"hash\":\"58f148902a4372123c27b1aba8286d8b97e1fafda757d397bf96a3fada5e2e2e\",\"summaries\":[{\"metadata\":{\"summarizer\":\"azure-ai\",\"model\":\"DeepSeek-R1\"},\"summaries\":[\"A developer addressed severe performance issues in a React form, where input lagged significantly, especially when entering sequential keystrokes. Initially suspecting validations or form-wide re-renders, profiling with React DevTools revealed a Dropdown component (Semantic-UI) rendering 400+ options as the culprit. Each keystroke triggered re-renders, generating new option instances. The uncontrolled Dropdown was extracted into a PureComponent, memoizing options to prevent redundant renders. This reduced per-input render time from ~400ms to ~22ms, eliminating lag. The solution highlighted the importance of profiling to identify bottlenecks, controlled re-renders via memoization, and optimizing third-party components in large-scale React applications to maintain responsiveness.\"],\"startTime\":\"2025-02-14T13:31:36.293Z\",\"endTime\":\"2025-02-14T13:31:59.423Z\"},{\"metadata\":{\"summarizer\":\"ollama\",\"model\":\"deepseek-r1:8b\"},\"summaries\":[\"为了解决下拉框组件性能问题，我们需要分析其导致因素，并实施必要的优化。以下是详细的步骤解释：\\n\\n1. **识别性能问题**：\\n   - 使用 React Profiler 工具，发现下拉框组件在输入时花费大量时间。\\n   \\n2. **分析组件行为**：\\n   - 检查下拉框组件代码，发现每次渲染都生成包含400多个选项的数组。\\n   - 发现网络请求完成后，数据不会再变化，但组件仍频繁重复渲染。\\n\\n3. **实施优化措施**：\\n   - **拆分组件**：将下拉框组件单独抽出来，以便独立控制和优化。\\n   - **使用PureComponent**：确保子组件只在 props 变化时重新渲染。\\n   - **缓存选项数据**：避免每次渲染都生成新数组，而是使用一个常量或缓存变量。\\n   - **控制组件状态**：通过 React 组件管理状态，减少不必要的 DOM 更新。\\n\\n4. **验证和测试**：\\n   - 测试优化后的组件，确认性能提升。\\n   - 确保在网络请求失败时，下拉框仍能正常显示（空白或错误提示）。\\n\\n5. **部署改进代码**：\\n   - 修改下拉框组件，使其接受外部的选项数据，并仅在必要时渲染。\\n   - 确保 `generateDropdown` 函数被替换为一个不再生成新数组的优化版本。\\n\\n通过以上步骤，我们能够有效地解决下拉框的性能问题，提升应用整体运行速度和用户体验。\"]}]}},\"langVersions\":[\"en\"]}]]}]}]}],[\"$\",\"div\",null,{\"className\":\"animate-slide-up\",\"children\":[[\"$\",\"div\",null,{\"className\":\"max-w-7xl mx-auto p-4\",\"children\":\"$L19\"}],[\"$\",\"div\",null,{\"className\":\"max-w-7xl mx-auto p-4\",\"children\":[\"$\",\"$L1a\",null,{\"relatedArticles\":[]}]}],[\"$\",\"div\",null,{\"className\":\"max-w-7xl mx-auto p-4\",\"children\":[\"$\",\"$L1b\",null,{\"articleId\":\"a-react-form-comp-pref-optimization-with-profiler\",\"articleTitle\":\"A React Form Component Performance Optimization with Profiler\"}]}]]}]]}]\n"])</script><script>self.__next_f.push([1,"1c:I[6535,[\"116\",\"static/chunks/c556396d-6bde9789d0a41114.js\",\"413\",\"static/chunks/7a1bdfe6-8f7609c25899d936.js\",\"994\",\"static/chunks/c4aeae87-2a85323a0275cbf9.js\",\"786\",\"static/chunks/1b3e99d6-50521588821d44ca.js\",\"845\",\"static/chunks/845-a0203995fac91684.js\",\"57\",\"static/chunks/57-3951d65188499c8f.js\",\"826\",\"static/chunks/826-c44bffd752ec02cd.js\",\"467\",\"static/chunks/467-ff6f7f0e9f0462a7.js\",\"971\",\"static/chunks/app/articles/%5B%5B...params%5D%5D/page-59c8401fd7fff2e0.js\"],\"ArticleSummarization\"]\n1d:I[7868,[\"116\",\"static/chunks/c556396d-6bde9789d0a41114.js\",\"413\",\"static/chunks/7a1bdfe6-8f7609c25899d936.js\",\"994\",\"static/chunks/c4aeae87-2a85323a0275cbf9.js\",\"786\",\"static/chunks/1b3e99d6-50521588821d44ca.js\",\"845\",\"static/chunks/845-a0203995fac91684.js\",\"57\",\"static/chunks/57-3951d65188499c8f.js\",\"826\",\"static/chunks/826-c44bffd752ec02cd.js\",\"467\",\"static/chunks/467-ff6f7f0e9f0462a7.js\",\"971\",\"static/chunks/app/articles/%5B%5B...params%5D%5D/page-59c8401fd7fff2e0.js\"],\"Gallery\"]\n33:I[2422,[\"116\",\"static/chunks/c556396d-6bde9789d0a41114.js\",\"413\",\"static/chunks/7a1bdfe6-8f7609c25899d936.js\",\"994\",\"static/chunks/c4aeae87-2a85323a0275cbf9.js\",\"786\",\"static/chunks/1b3e99d6-50521588821d44ca.js\",\"845\",\"static/chunks/845-a0203995fac91684.js\",\"57\",\"static/chunks/57-3951d65188499c8f.js\",\"826\",\"static/chunks/826-c44bffd752ec02cd.js\",\"467\",\"static/chunks/467-ff6f7f0e9f0462a7.js\",\"971\",\"static/chunks/app/articles/%5B%5B...params%5D%5D/page-59c8401fd7fff2e0.js\"],\"ArticleToc\"]\n1e:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521"])</script><script>self.__next_f.push([1,"-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z20:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z21:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-"])</script><script>self.__next_f.push([1,"59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z22:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.0"])</script><script>self.__next_f.push([1,"37 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z23:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z25:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.8"])</script><script>self.__next_f.push([1,"3-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z27:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-"])</script><script>self.__next_f.push([1,"59.259 59.271-155.699.001-214.959z28:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z29:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.45"])</script><script>self.__next_f.push([1,"4 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z2d:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z2f:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13"])</script><script>self.__next_f.push([1,".087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4.35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z32:T4df,M326.612 185.391c59.747 59.809 58.927 155.698.36 214.59-.11.12-.24.25-.36.37l-67.2 67.2c-59.27 59.27-155.699 59.262-214.96 0-59.27-59.26-59.27-155.7 0-214.96l37.106-37.106c9.84-9.84 26.786-3.3 27.294 10.606.648 17.722 3.826 35.527 9.69 52.721 1.986 5.822.567 12.262-3.783 16.612l-13.087 13.087c-28.026 28.026-28.905 73.66-1.155 101.96 28.024 28.579 74.086 28.749 102.325.51l67.2-67.19c28.191-28.191 28.073-73.757 0-101.83-3.701-3.694-7.429-6.564-10.341-8.569a16.037 16.037 0 0 1-6.947-12.606c-.396-10.567 3.348-21.456 11.698-29.806l21.054-21.055c5.521-5.521 14.182-6.199 20.584-1.731a152.482 152.482 0 0 1 20.522 17.197zM467.547 44.449c-59.261-59.262-155.69-59.27-214.96 0l-67.2 67.2c-.12.12-.25.25-.36.37-58.566 58.892-59.387 154.781.36 214.59a152.454 152.454 0 0 0 20.521 17.196c6.402 4.468 15.064 3.789 20.584-1.731l21.054-21.055c8.35-8.35 12.094-19.239 11.698-29.806a16.037 16.037 0 0 0-6.947-12.606c-2.912-2.005-6.64-4.875-10.341-8.569-28.073-28.073-28.191-73.639 0-101.83l67.2-67.19c28.239-28.239 74.3-28.069 102.325.51 27.75 28.3 26.872 73.934-1.155 101.96l-13.087 13.087c-4."])</script><script>self.__next_f.push([1,"35 4.35-5.769 10.79-3.783 16.612 5.864 17.194 9.042 34.999 9.69 52.721.509 13.906 17.454 20.446 27.294 10.606l37.106-37.106c59.271-59.259 59.271-155.699.001-214.959z"])</script><script>self.__next_f.push([1,"19:[\"$\",\"div\",null,{\"className\":\"flex flex-row space-x-4\",\"children\":[[\"$\",\"div\",null,{\"className\":\"prose max-w-full lg:w-[75%]\",\"children\":[[\"$\",\"$L1c\",null,{\"summaries\":[{\"metadata\":\"$5:props:children:0:props:children:props:children:props:children:1:props:info:summary:summaries:0:metadata\",\"children\":[[\"$\",\"p\",\"p-0\",{\"children\":\"A developer addressed severe performance issues in a React form, where input lagged significantly, especially when entering sequential keystrokes. Initially suspecting validations or form-wide re-renders, profiling with React DevTools revealed a Dropdown component (Semantic-UI) rendering 400+ options as the culprit. Each keystroke triggered re-renders, generating new option instances. The uncontrolled Dropdown was extracted into a PureComponent, memoizing options to prevent redundant renders. This reduced per-input render time from ~400ms to ~22ms, eliminating lag. The solution highlighted the importance of profiling to identify bottlenecks, controlled re-renders via memoization, and optimizing third-party components in large-scale React applications to maintain responsiveness.\"}]]},{\"metadata\":\"$5:props:children:0:props:children:props:children:props:children:1:props:info:summary:summaries:1:metadata\",\"children\":[[\"$\",\"p\",\"p-0\",{\"children\":\"为了解决下拉框组件性能问题，我们需要分析其导致因素，并实施必要的优化。以下是详细的步骤解释：\"}],\"\\n\",[\"$\",\"ol\",\"ol-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"识别性能问题\"}],\"：\"]}],\"\\n\",[\"$\",\"ul\",\"ul-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":\"使用 React Profiler 工具，发现下拉框组件在输入时花费大量时间。\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"分析组件行为\"}],\"：\"]}],\"\\n\",[\"$\",\"ul\",\"ul-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":\"检查下拉框组件代码，发现每次渲染都生成包含400多个选项的数组。\"}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":\"发现网络请求完成后，数据不会再变化，但组件仍频繁重复渲染。\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":[\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"实施优化措施\"}],\"：\"]}],\"\\n\",[\"$\",\"ul\",\"ul-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"拆分组件\"}],\"：将下拉框组件单独抽出来，以便独立控制和优化。\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"使用PureComponent\"}],\"：确保子组件只在 props 变化时重新渲染。\"]}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"缓存选项数据\"}],\"：避免每次渲染都生成新数组，而是使用一个常量或缓存变量。\"]}],\"\\n\",[\"$\",\"li\",\"li-3\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"控制组件状态\"}],\"：通过 React 组件管理状态，减少不必要的 DOM 更新。\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",\"li-3\",{\"children\":[\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"验证和测试\"}],\"：\"]}],\"\\n\",[\"$\",\"ul\",\"ul-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":\"测试优化后的组件，确认性能提升。\"}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":\"确保在网络请求失败时，下拉框仍能正常显示（空白或错误提示）。\"}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",\"li-4\",{\"children\":[\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":[[\"$\",\"strong\",\"strong-0\",{\"children\":\"部署改进代码\"}],\"：\"]}],\"\\n\",[\"$\",\"ul\",\"ul-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":\"修改下拉框组件，使其接受外部的选项数据，并仅在必要时渲染。\"}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":[\"确保 \",[\"$\",\"code\",\"code-0\",{\"children\":\"generateDropdown\"}],\" 函数被替换为一个不再生成新数组的优化版本。\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":\"通过以上步骤，我们能够有效地解决下拉框的性能问题，提升应用整体运行速度和用户体验。\"}]]}]}],[\"$\",\"$L1d\",null,{\"withCaption\":true,\"id\":\"a-react-form-comp-pref-optimization-with-profiler\",\"children\":[[\"$\",\"blockquote\",\"blockquote-0\",{\"children\":[\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":\"Note: This code is from an internal project. Measurements apply to protect confidential information, but the problem and methods mentioned in the article are universal and not limited to specific projects.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h1\",\"h1-0\",{\"id\":\"the-problem\",\"children\":[[\"$\",\"a\",\"the-problem\",{\"href\":\"#the-problem\",\"className\":\"mr-1\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"inline-block opacity-20 hover:opacity-60\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"$1e\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":16,\"width\":16,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}],\"The Problem\"]}],\"\\n\",[\"$\",\"p\",\"p-0\",{\"children\":[\"I was working on a form that had very poor performance. To be specific, at every key stroke, the form responded pretty slowly. What's worse, the component and the whole website became completely unresponsive for \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"seconds\"}],\" if several keys were stroked sequentially (like input a long number), which was, unfortunately, the normal use case for this field.\"]}],\"\\n\",[\"$\",\"p\",\"p-1\",{\"children\":\"$L1f\"}],\"\\n\",[\"$\",\"h1\",\"h1-1\",{\"id\":\"investigation\",\"children\":[[\"$\",\"a\",\"investigation\",{\"href\":\"#investigation\",\"className\":\"mr-1\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"inline-block opacity-20 hover:opacity-60\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"$20\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":16,\"width\":16,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}],\"Investigation\"]}],\"\\n\",[\"$\",\"h2\",\"h2-0\",{\"id\":\"validations\",\"children\":[[\"$\",\"a\",\"validations\",{\"href\":\"#validations\",\"className\":\"mr-1\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"inline-block opacity-20 hover:opacity-60\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"$21\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":16,\"width\":16,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}],\"Validations?\"]}],\"\\n\",[\"$\",\"p\",\"p-2\",{\"children\":\"From the gif provided above, you may find some details that are worth taking notice of:\"}],\"\\n\",[\"$\",\"ul\",\"ul-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[\"The first field had the \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"worse performance\"}],\",\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":\"The first field had some kinds of input validation (loading indicator when the first inputs were registered),\"}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":\"The field below the first field had better performance than the first one, and it had no validation.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"p\",\"p-3\",{\"children\":[\"Hmm...It looks like \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"the validation\"}],\" might be the cause.\"]}],\"\\n\",[\"$\",\"p\",\"p-4\",{\"children\":\"However, the validation process was merely some format check, and a request which would be cancelled if next key stroke had come before it completed. It did increase the delay of input, but should not be so significant.\"}],\"\\n\",[\"$\",\"h2\",\"h2-1\",{\"id\":\"re-renders-of-the-whole-form\",\"children\":[[\"$\",\"a\",\"re-renders-of-the-whole-form\",{\"href\":\"#re-renders-of-the-whole-form\",\"className\":\"mr-1\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"inline-block opacity-20 hover:opacity-60\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"$22\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":16,\"width\":16,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}],\"Re-renders of the Whole Form?\"]}],\"\\n\",[\"$\",\"h3\",\"h3-0\",{\"id\":\"the-challenge-of-forms-in-react\",\"children\":[[\"$\",\"a\",\"the-challenge-of-forms-in-react\",{\"href\":\"#the-challenge-of-forms-in-react\",\"className\":\"mr-1\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"inline-block opacity-20 hover:opacity-60\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"$23\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":16,\"width\":16,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}],\"The Challenge of Forms in React\"]}],\"\\n\",[\"$\",\"p\",\"p-5\",{\"children\":[\"The \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"re-render of the whole form at every input\"}],\" might be the problem as well.\"]}],\"\\n\",[\"$\",\"p\",\"p-6\",{\"children\":[\"React has been known as \",[\"$\",\"em\",\"em-0\",{\"children\":\"not good at implementing forms\"}],\" because of its famous \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"unidirectional data flow\"}],\".\"]}],\"\\n\",[\"$\",\"p\",\"p-7\",{\"children\":\"$L24\"}],\"\\n\",[\"$\",\"p\",\"p-8\",{\"children\":[\"Unidirectional data flow simplifies the data flow and fits seeminglessly with the concept of React. However, since \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"each update to the state will trigger the component to re-render\"}],\", it might impact the performance of the app.\"]}],\"\\n\",[\"$\",\"p\",\"p-9\",{\"children\":[\"Form is one of such cases, because a form consists of multiple input fields, and \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"each input to any one of them\"}],\" would update the state, and re-render the whole form and every other fields. Therefore, writing forms in React has always a challenge.\"]}],\"\\n\",[\"$\",\"h3\",\"h3-1\",{\"id\":\"complicated-form\",\"children\":[[\"$\",\"a\",\"complicated-form\",{\"href\":\"#complicated-form\",\"className\":\"mr-1\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"inline-block opacity-20 hover:opacity-60\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"$25\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":16,\"width\":16,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}],\"Complicated Form\"]}],\"\\n\",[\"$\",\"p\",\"p-10\",{\"children\":[\"Looking at the code, the form was implemented in a very React way: the form contained all the fields, and handled every \",[\"$\",\"code\",\"code-0\",{\"children\":\"onChange\"}],\" event for each input fields.\"]}],\"\\n\",[\"$\",\"p\",\"p-11\",{\"children\":\"$L26\"}],\"\\n\",[\"$\",\"p\",\"p-12\",{\"children\":[\"The form was complicated with dozens of fields, several \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"sync/async and cross-field validations\"}],\", \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"dynamic placeholders\"}],\" and some unnecessary \",[\"$\",\"strong\",\"strong-2\",{\"children\":\"duplicate calculations\"}],\" (which could be improved with constants and cache).\"]}],\"\\n\",[\"$\",\"p\",\"p-13\",{\"children\":[\"It seemed pretty evident that the \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"re-renders\"}],\" and \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"the complicated calculations\"}],\" during the render were the cause to the problem.\"]}],\"\\n\",[\"$\",\"h3\",\"h3-2\",{\"id\":\"no-easy-solutions\",\"children\":[[\"$\",\"a\",\"no-easy-solutions\",{\"href\":\"#no-easy-solutions\",\"className\":\"mr-1\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"inline-block opacity-20 hover:opacity-60\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"$27\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":16,\"width\":16,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}],\"No Easy Solutions\"]}],\"\\n\",[\"$\",\"p\",\"p-14\",{\"children\":[\"Having found the reason, what's left was to find a solution. However, the reason that form implementation is called a \",[\"$\",\"em\",\"em-0\",{\"children\":\"challenge\"}],\" in React is that it can not be solved easily. There are lots of React form library from the community (like \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://github.com/tannerlinsley/react-form\",\"children\":\"react-form\"}],\", \",[\"$\",\"a\",\"a-1\",{\"href\":\"https://github.com/jaredpalmer/formik\",\"children\":\"formik\"}],\") trying to solve the form as a whole by providing a complete solution to some common form challenges, including input management, async validations, and submission. They may be viable for many users and should be considered if you are having trouble building a form in your project, but I couldn't adopt them in this project because:\"]}],\"\\n\",[\"$\",\"ul\",\"ul-1\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[\"hiding complexities usually means introducing other complexities\\n\",[\"$\",\"ul\",\"ul-0\",{\"children\":[\"\\n\",[\"$\",\"li\",\"li-0\",{\"children\":[\"for example, when using the libraries, more problems are introduced, like \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"less flexibilities\"}],\", \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"less understandable code\"}],\", \",[\"$\",\"strong\",\"strong-2\",{\"children\":\"interop with UI libraries\"}],\" and \",[\"$\",\"strong\",\"strong-3\",{\"children\":\"the cost of learning and adopting a new set of APIs\"}],\".\"]}],\"\\n\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"li\",\"li-1\",{\"children\":\"The code is involved with several internal concepts and conventions, which I am not familiar enough. As a result, I don't have the confidence to rewrite the logic correctly in a short time;\"}],\"\\n\",[\"$\",\"li\",\"li-2\",{\"children\":\"introducing a new library into this project is hard, for it is a internal project that has over 200K lines of TypeScript code, hundreds of authors and users, so the review for this project is strict.\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h2\",\"h2-2\",{\"id\":\"maybe-not-re-renders\",\"children\":[[\"$\",\"a\",\"maybe-not-re-renders\",{\"href\":\"#maybe-not-re-renders\",\"className\":\"mr-1\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"inline-block opacity-20 hover:opacity-60\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"$28\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":16,\"width\":16,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}],\"Maybe Not Re-renders?\"]}],\"\\n\",[\"$\",\"p\",\"p-15\",{\"children\":[\"Besides, my experiences told me that it was possibly not the \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"re-renders\"}],\" that was to blame, since the updates of the form should not be so costly that would result in such a significant delay.\"]}],\"\\n\",[\"$\",\"p\",\"p-16\",{\"children\":[\"I have encountered situations where even \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"a whole page\"}],\" re-rendered at every interaction, but React and modern JavaScript engines is more than capable to drive it smoothly without even a stutter. This form had several fields to be re-rendered at every input, but when taking the whole page into consideration, the number of re-renders inside this page was negligible.\"]}],\"\\n\",[\"$\",\"h2\",\"h2-3\",{\"id\":\"profiling-profiling-profiling\",\"children\":[[\"$\",\"a\",\"profiling-profiling-profiling\",{\"href\":\"#profiling-profiling-profiling\",\"className\":\"mr-1\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"inline-block opacity-20 hover:opacity-60\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"$29\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":16,\"width\":16,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}],\"Profiling, Profiling, Profiling\"]}],\"\\n\",[\"$\",\"p\",\"p-17\",{\"children\":[\"After wasting days on \",[\"$\",\"em\",\"em-0\",{\"children\":\"brainstorming\"}],\" the source of problem, I decided to diagnose the issue in a scientific way -- \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"profiling\"}],\".\"]}],\"\\n\",[\"$\",\"p\",\"p-18\",{\"children\":[[\"$\",\"a\",\"a-0\",{\"href\":\"https://chrome.google.com/webstore/detail/react-developer-tools/fmkadmapgofadopljbjfkapdkoienihi\",\"children\":\"React's official devtool of Chrome\"}],\" has a built-in profiling tool. By recoding a sequence of user interactions, profiler can provide performance metrics on each commit during the record, like what components are re-rendered, how many time they take to re-render, with which the developer can locate the components that have biggest impact to the performance, and optimize them accordingly.\"]}],\"\\n\",[\"$\",\"p\",\"p-19\",{\"children\":\"Start the recoding, repeat the operations of the gif above, and I had the following result:\"}],\"\\n\",[\"$\",\"p\",\"p-20\",{\"children\":[\"$L2a\",\"\\n\",\"$L2b\"]}],\"\\n\",[\"$\",\"p\",\"p-21\",{\"children\":[\"The first chart (ranked chart) showed the time to re-render for each component that had re-rendered on this commit. The second chart (flamegraph chart) shoed the re-rendered components \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"hierarchically\"}],\": that is, the time to render the component itself, and each of its children.\"]}],\"\\n\",[\"$\",\"p\",\"p-22\",{\"children\":[\"As you could see, a \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"Dropdown\"}],\" component took a significant time to re-render. In fact, all the graphes on all the last 10 commits had led me to the same component. By following the hierarchy provided by the flamegraph, it didn't take long to locate the component, which was the dropdown \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"on the right side\"}],\" of the first field with slow responsiveness, and implemented as follows:\"]}],\"\\n\",[\"$\",\"p\",\"p-23\",{\"children\":\"$L2c\"}],\"\\n\",[\"$\",\"p\",\"p-24\",{\"children\":[\"It looked like a normal dropdown with the exception of a \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"duplicate calculations\"}],\": generating an options array at every render. \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"Providing different instances at every render\"}],\" is a common source of performance problem in React, because it signals React that the props have changed and a re-render is required, even the objects between renders are \",[\"$\",\"strong\",\"strong-2\",{\"children\":\"deep equal\"}],\". The solution is straightforward: instead of generating a different instance each time, provide a constant or a class field that only changes when it is modified.\"]}],\"\\n\",[\"$\",\"p\",\"p-25\",{\"children\":[\"But unfortunately, in this case, after replacing the call to \",[\"$\",\"code\",\"code-0\",{\"children\":\"this.generateDropdown\"}],\" to a constant, the problem persisted.\"]}],\"\\n\",[\"$\",\"h2\",\"h2-4\",{\"id\":\"large-quantity-of-options\",\"children\":[[\"$\",\"a\",\"large-quantity-of-options\",{\"href\":\"#large-quantity-of-options\",\"className\":\"mr-1\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"inline-block opacity-20 hover:opacity-60\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"$2d\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":16,\"width\":16,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}],\"Large Quantity of Options\"]}],\"\\n\",[\"$\",\"p\",\"p-26\",{\"children\":[\"The source of options of the dropdown came from a network request that was initiated when the page loaded. Another clue that I found during investigation was that when network errors happened, the input became very \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"responsive\"}],\", at which time \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"the dropdown had no option\"}],\". And after several intentional experiments, I found the correspondance between options and performance to be true (no option -\u003e good performance, had options -\u003e bad performace).\"]}],\"\\n\",[\"$\",\"p\",\"p-27\",{\"children\":\"I was just a maintainer of the component, not the original authors, so I didn't take notice of the contents of dropdown during my previous investigation. Now, according to the correspondance, I checked out the options of the dropdown, only to find it had over 400 options.\"}],\"\\n\",[\"$\",\"p\",\"p-28\",{\"children\":\"$L2e\"}],\"\\n\",[\"$\",\"p\",\"p-29\",{\"children\":[\"Rendering \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"so many options\"}],\" at each render would definitely impact performance pretty hard, unless the component had thought of it and selectively re-rendered only the changed part.\"]}],\"\\n\",[\"$\",\"p\",\"p-30\",{\"children\":[\"This project used \",[\"$\",\"a\",\"a-0\",{\"href\":\"https://react.semantic-ui.com/\",\"children\":\"React Wrapper of Semantic-UI\"}],\" which was a famous component library and open source. By diving into the source code, I found that the dropdown did re-render every options every time without any memoing or caching.\"]}],\"\\n\",[\"$\",\"p\",\"p-31\",{\"children\":[\"$\",\"a\",\"a-0\",{\"href\":\"https://github.com/Semantic-Org/Semantic-UI-React/blob/master/src/modules/Dropdown/Dropdown.js#L1275\",\"children\":\"https://github.com/Semantic-Org/Semantic-UI-React/blob/master/src/modules/Dropdown/Dropdown.js#L1275\"}]}],\"\\n\",[\"$\",\"figure\",\"figure-0\",{\"data-rehype-pretty-code-figure\":\"\",\"children\":[\"$\",\"pre\",\"pre-0\",{\"style\":{\"backgroundColor\":\"#282c34\",\"color\":\"#abb2bf\"},\"tabIndex\":0,\"data-language\":\"jsx\",\"data-theme\":\"one-dark-pro\",\"children\":[\"$\",\"code\",\"code-0\",{\"data-language\":\"jsx\",\"data-theme\":\"one-dark-pro\",\"style\":{\"display\":\"grid\"},\"children\":[[\"$\",\"span\",\"span-0\",{\"data-line\":\"\",\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#7F848E\",\"fontStyle\":\"italic\"},\"children\":\"// omitted\"}]}],\"\\n\",[\"$\",\"span\",\"span-1\",{\"data-line\":\"\",\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#61AFEF\"},\"children\":\"renderOptions\"}],[\"$\",\"span\",\"span-1\",{\"style\":{\"color\":\"#56B6C2\"},\"children\":\" =\"}],[\"$\",\"span\",\"span-2\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\" () \"}],[\"$\",\"span\",\"span-3\",{\"style\":{\"color\":\"#C678DD\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",\"span-4\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",\"span-2\",{\"data-line\":\"\",\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#7F848E\",\"fontStyle\":\"italic\"},\"children\":\"  // omitted\"}]}],\"\\n\",[\"$\",\"span\",\"span-3\",{\"data-line\":\"\",\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#C678DD\"},\"children\":\"  return\"}],[\"$\",\"span\",\"span-1\",{\"style\":{\"color\":\"#E5C07B\"},\"children\":\" _\"}],[\"$\",\"span\",\"span-2\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\".\"}],[\"$\",\"span\",\"span-3\",{\"style\":{\"color\":\"#61AFEF\"},\"children\":\"map\"}],[\"$\",\"span\",\"span-4\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"(\"}],[\"$\",\"span\",\"span-5\",{\"style\":{\"color\":\"#E06C75\"},\"children\":\"options\"}],[\"$\",\"span\",\"span-6\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\", (\"}],[\"$\",\"span\",\"span-7\",{\"style\":{\"color\":\"#E06C75\",\"fontStyle\":\"italic\"},\"children\":\"opt\"}],[\"$\",\"span\",\"span-8\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\", \"}],[\"$\",\"span\",\"span-9\",{\"style\":{\"color\":\"#E06C75\",\"fontStyle\":\"italic\"},\"children\":\"i\"}],[\"$\",\"span\",\"span-10\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\") \"}],[\"$\",\"span\",\"span-11\",{\"style\":{\"color\":\"#C678DD\"},\"children\":\"=\u003e\"}]]}],\"\\n\",[\"$\",\"span\",\"span-4\",{\"data-line\":\"\",\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#E5C07B\"},\"children\":\"    DropdownItem\"}],[\"$\",\"span\",\"span-1\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\".\"}],[\"$\",\"span\",\"span-2\",{\"style\":{\"color\":\"#61AFEF\"},\"children\":\"create\"}],[\"$\",\"span\",\"span-3\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"({\"}]]}],\"\\n\",[\"$\",\"span\",\"span-5\",{\"data-line\":\"\",\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#E06C75\"},\"children\":\"      active\"}],[\"$\",\"span\",\"span-1\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\": \"}],[\"$\",\"span\",\"span-2\",{\"style\":{\"color\":\"#61AFEF\"},\"children\":\"isActive\"}],[\"$\",\"span\",\"span-3\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"(\"}],[\"$\",\"span\",\"span-4\",{\"style\":{\"color\":\"#E5C07B\"},\"children\":\"opt\"}],[\"$\",\"span\",\"span-5\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\".\"}],[\"$\",\"span\",\"span-6\",{\"style\":{\"color\":\"#E06C75\"},\"children\":\"value\"}],[\"$\",\"span\",\"span-7\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"),\"}]]}],\"\\n\",[\"$\",\"span\",\"span-6\",{\"data-line\":\"\",\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#E06C75\"},\"children\":\"      onClick\"}],[\"$\",\"span\",\"span-1\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\": \"}],[\"$\",\"span\",\"span-2\",{\"style\":{\"color\":\"#E5C07B\"},\"children\":\"this\"}],[\"$\",\"span\",\"span-3\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\".\"}],[\"$\",\"span\",\"span-4\",{\"style\":{\"color\":\"#E06C75\"},\"children\":\"handleItemClick\"}],[\"$\",\"span\",\"span-5\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",\"span-7\",{\"data-line\":\"\",\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#E06C75\"},\"children\":\"      selected\"}],[\"$\",\"span\",\"span-1\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\": \"}],[\"$\",\"span\",\"span-2\",{\"style\":{\"color\":\"#E06C75\"},\"children\":\"selectedIndex\"}],[\"$\",\"span\",\"span-3\",{\"style\":{\"color\":\"#56B6C2\"},\"children\":\" ===\"}],[\"$\",\"span\",\"span-4\",{\"style\":{\"color\":\"#E06C75\"},\"children\":\" i\"}],[\"$\",\"span\",\"span-5\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",\"span-8\",{\"data-line\":\"\",\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"      ...\"}],[\"$\",\"span\",\"span-1\",{\"style\":{\"color\":\"#E06C75\"},\"children\":\"opt\"}],[\"$\",\"span\",\"span-2\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\",\"}]]}],\"\\n\",[\"$\",\"span\",\"span-9\",{\"data-line\":\"\",\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#E06C75\"},\"children\":\"      key\"}],[\"$\",\"span\",\"span-1\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\": \"}],[\"$\",\"span\",\"span-2\",{\"style\":{\"color\":\"#61AFEF\"},\"children\":\"getKeyOrValue\"}],[\"$\",\"span\",\"span-3\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"(\"}],[\"$\",\"span\",\"span-4\",{\"style\":{\"color\":\"#E5C07B\"},\"children\":\"opt\"}],[\"$\",\"span\",\"span-5\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\".\"}],[\"$\",\"span\",\"span-6\",{\"style\":{\"color\":\"#E06C75\"},\"children\":\"key\"}],[\"$\",\"span\",\"span-7\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\", \"}],[\"$\",\"span\",\"span-8\",{\"style\":{\"color\":\"#E5C07B\"},\"children\":\"opt\"}],[\"$\",\"span\",\"span-9\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\".\"}],[\"$\",\"span\",\"span-10\",{\"style\":{\"color\":\"#E06C75\"},\"children\":\"value\"}],[\"$\",\"span\",\"span-11\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"),\"}]]}],\"\\n\",[\"$\",\"span\",\"span-10\",{\"data-line\":\"\",\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#7F848E\",\"fontStyle\":\"italic\"},\"children\":\"      // Needed for handling click events on disabled items\"}]}],\"\\n\",[\"$\",\"span\",\"span-11\",{\"data-line\":\"\",\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#E06C75\"},\"children\":\"      style\"}],[\"$\",\"span\",\"span-1\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\": { ...\"}],[\"$\",\"span\",\"span-2\",{\"style\":{\"color\":\"#E5C07B\"},\"children\":\"opt\"}],[\"$\",\"span\",\"span-3\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\".\"}],[\"$\",\"span\",\"span-4\",{\"style\":{\"color\":\"#E06C75\"},\"children\":\"style\"}],[\"$\",\"span\",\"span-5\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\", \"}],[\"$\",\"span\",\"span-6\",{\"style\":{\"color\":\"#E06C75\"},\"children\":\"pointerEvents\"}],[\"$\",\"span\",\"span-7\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\": \"}],[\"$\",\"span\",\"span-8\",{\"style\":{\"color\":\"#98C379\"},\"children\":\"'all'\"}],[\"$\",\"span\",\"span-9\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\" },\"}]]}],\"\\n\",[\"$\",\"span\",\"span-12\",{\"data-line\":\"\",\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"    }),\"}]}],\"\\n\",[\"$\",\"span\",\"span-13\",{\"data-line\":\"\",\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"  )\"}]}],\"\\n\",[\"$\",\"span\",\"span-14\",{\"data-line\":\"\",\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",\"span-15\",{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",\"span-16\",{\"data-line\":\"\",\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#61AFEF\"},\"children\":\"renderMenu\"}],[\"$\",\"span\",\"span-1\",{\"style\":{\"color\":\"#56B6C2\"},\"children\":\" =\"}],[\"$\",\"span\",\"span-2\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\" () \"}],[\"$\",\"span\",\"span-3\",{\"style\":{\"color\":\"#C678DD\"},\"children\":\"=\u003e\"}],[\"$\",\"span\",\"span-4\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\" {\"}]]}],\"\\n\",[\"$\",\"span\",\"span-17\",{\"data-line\":\"\",\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#7F848E\",\"fontStyle\":\"italic\"},\"children\":\"  // omitted\"}]}],\"\\n\",[\"$\",\"span\",\"span-18\",{\"data-line\":\"\",\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#C678DD\"},\"children\":\"  return\"}],[\"$\",\"span\",\"span-1\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\" (\"}]]}],\"\\n\",[\"$\",\"span\",\"span-19\",{\"data-line\":\"\",\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"    \u003c\"}],[\"$\",\"span\",\"span-1\",{\"style\":{\"color\":\"#E5C07B\"},\"children\":\"DropdownMenu\"}],[\"$\",\"span\",\"span-2\",{\"style\":{\"color\":\"#C678DD\"},\"children\":\" {\"}],[\"$\",\"span\",\"span-3\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"...\"}],[\"$\",\"span\",\"span-4\",{\"style\":{\"color\":\"#E06C75\"},\"children\":\"ariaOptions\"}],[\"$\",\"span\",\"span-5\",{\"style\":{\"color\":\"#C678DD\"},\"children\":\"}\"}],[\"$\",\"span\",\"span-6\",{\"style\":{\"color\":\"#D19A66\",\"fontStyle\":\"italic\"},\"children\":\" direction\"}],[\"$\",\"span\",\"span-7\",{\"style\":{\"color\":\"#56B6C2\"},\"children\":\"=\"}],[\"$\",\"span\",\"span-8\",{\"style\":{\"color\":\"#C678DD\"},\"children\":\"{\"}],[\"$\",\"span\",\"span-9\",{\"style\":{\"color\":\"#E06C75\"},\"children\":\"direction\"}],[\"$\",\"span\",\"span-10\",{\"style\":{\"color\":\"#C678DD\"},\"children\":\"}\"}],[\"$\",\"span\",\"span-11\",{\"style\":{\"color\":\"#D19A66\",\"fontStyle\":\"italic\"},\"children\":\" open\"}],[\"$\",\"span\",\"span-12\",{\"style\":{\"color\":\"#56B6C2\"},\"children\":\"=\"}],[\"$\",\"span\",\"span-13\",{\"style\":{\"color\":\"#C678DD\"},\"children\":\"{\"}],[\"$\",\"span\",\"span-14\",{\"style\":{\"color\":\"#E06C75\"},\"children\":\"open\"}],[\"$\",\"span\",\"span-15\",{\"style\":{\"color\":\"#C678DD\"},\"children\":\"}\"}],[\"$\",\"span\",\"span-16\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",\"span-20\",{\"data-line\":\"\",\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#C678DD\"},\"children\":\"      {\"}],[\"$\",\"span\",\"span-1\",{\"style\":{\"color\":\"#E5C07B\"},\"children\":\"DropdownHeader\"}],[\"$\",\"span\",\"span-2\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\".\"}],[\"$\",\"span\",\"span-3\",{\"style\":{\"color\":\"#61AFEF\"},\"children\":\"create\"}],[\"$\",\"span\",\"span-4\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"(\"}],[\"$\",\"span\",\"span-5\",{\"style\":{\"color\":\"#E06C75\"},\"children\":\"header\"}],[\"$\",\"span\",\"span-6\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\", { \"}],[\"$\",\"span\",\"span-7\",{\"style\":{\"color\":\"#E06C75\"},\"children\":\"autoGenerateKey\"}],[\"$\",\"span\",\"span-8\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\": \"}],[\"$\",\"span\",\"span-9\",{\"style\":{\"color\":\"#D19A66\"},\"children\":\"false\"}],[\"$\",\"span\",\"span-10\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\" })\"}],[\"$\",\"span\",\"span-11\",{\"style\":{\"color\":\"#C678DD\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",\"span-21\",{\"data-line\":\"\",\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#C678DD\"},\"children\":\"      {\"}],[\"$\",\"span\",\"span-1\",{\"style\":{\"color\":\"#E5C07B\"},\"children\":\"this\"}],[\"$\",\"span\",\"span-2\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\".\"}],[\"$\",\"span\",\"span-3\",{\"style\":{\"color\":\"#61AFEF\"},\"children\":\"renderOptions\"}],[\"$\",\"span\",\"span-4\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"()\"}],[\"$\",\"span\",\"span-5\",{\"style\":{\"color\":\"#C678DD\"},\"children\":\"}\"}]]}],\"\\n\",[\"$\",\"span\",\"span-22\",{\"data-line\":\"\",\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"    \u003c/\"}],[\"$\",\"span\",\"span-1\",{\"style\":{\"color\":\"#E5C07B\"},\"children\":\"DropdownMenu\"}],[\"$\",\"span\",\"span-2\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"\u003e\"}]]}],\"\\n\",[\"$\",\"span\",\"span-23\",{\"data-line\":\"\",\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"  )\"}]}],\"\\n\",[\"$\",\"span\",\"span-24\",{\"data-line\":\"\",\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"}\"}]}],\"\\n\",[\"$\",\"span\",\"span-25\",{\"data-line\":\"\",\"children\":\" \"}],\"\\n\",[\"$\",\"span\",\"span-26\",{\"data-line\":\"\",\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#61AFEF\"},\"children\":\"render\"}],[\"$\",\"span\",\"span-1\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"() {\"}]]}],\"\\n\",[\"$\",\"span\",\"span-27\",{\"data-line\":\"\",\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#7F848E\",\"fontStyle\":\"italic\"},\"children\":\"  // omitted\"}]}],\"\\n\",[\"$\",\"span\",\"span-28\",{\"data-line\":\"\",\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#C678DD\"},\"children\":\"  return\"}],[\"$\",\"span\",\"span-1\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\" (\"}]]}],\"\\n\",[\"$\",\"span\",\"span-29\",{\"data-line\":\"\",\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#7F848E\",\"fontStyle\":\"italic\"},\"children\":\"    // omitted\"}]}],\"\\n\",[\"$\",\"span\",\"span-30\",{\"data-line\":\"\",\"children\":[[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"    {\"}],[\"$\",\"span\",\"span-1\",{\"style\":{\"color\":\"#E06C75\",\"fontStyle\":\"italic\"},\"children\":\"this\"}],[\"$\",\"span\",\"span-2\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\".\"}],[\"$\",\"span\",\"span-3\",{\"style\":{\"color\":\"#E06C75\",\"fontStyle\":\"italic\"},\"children\":\"renderMenu\"}],[\"$\",\"span\",\"span-4\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"()}\"}]]}],\"\\n\",[\"$\",\"span\",\"span-31\",{\"data-line\":\"\",\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#7F848E\",\"fontStyle\":\"italic\"},\"children\":\"    // omitted\"}]}],\"\\n\",[\"$\",\"span\",\"span-32\",{\"data-line\":\"\",\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"  )\"}]}],\"\\n\",[\"$\",\"span\",\"span-33\",{\"data-line\":\"\",\"children\":[\"$\",\"span\",\"span-0\",{\"style\":{\"color\":\"#ABB2BF\"},\"children\":\"}\"}]}]]}]}]}],\"\\n\",[\"$\",\"h1\",\"h1-2\",{\"id\":\"solution\",\"children\":[[\"$\",\"a\",\"solution\",{\"href\":\"#solution\",\"className\":\"mr-1\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"inline-block opacity-20 hover:opacity-60\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"$2f\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":16,\"width\":16,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}],\"Solution\"]}],\"\\n\",[\"$\",\"p\",\"p-32\",{\"children\":\"In this case, the options didn't update anymore after the request had completed. Therefore, there was no need to update and re-render the options every time the component had changed.\"}],\"\\n\",[\"$\",\"p\",\"p-33\",{\"children\":[\"To stop the re-render, I extracted the dropdown out into a separate component, passed the options as a prop, and most importantly, made it a \",[\"$\",\"code\",\"code-0\",{\"children\":\"PureComponent\"}],\" which only re-rendered itself when the props had changed.\"]}],\"\\n\",[\"$\",\"p\",\"p-34\",{\"children\":[\"The dropdown was used in a \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"uncontrolled\"}],\" way -- that is, not managing its \",[\"$\",\"code\",\"code-0\",{\"children\":\"value\"}],\" by the DOM instead of as a state of React component by not passing value to the \",[\"$\",\"code\",\"code-1\",{\"children\":\"input\"}],\" DOM field. I had to admit it was not the React way, but here, not passing value to it meant that the component would \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"never update\"}],\", which was exactly what I wanted.\"]}],\"\\n\",[\"$\",\"p\",\"p-35\",{\"children\":\"$L30\"}],\"\\n\",[\"$\",\"p\",\"p-36\",{\"children\":[\"The optimization worked like a charm: the render time of the whole form for each input had reduced from \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"~400ms\"}],\" to \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"~22ms\"}],\", and there was no any unresponsiveness and delay at every key stroke.\"]}],\"\\n\",[\"$\",\"p\",\"p-37\",{\"children\":\"$L31\"}],\"\\n\",[\"$\",\"h1\",\"h1-3\",{\"id\":\"verdict\",\"children\":[[\"$\",\"a\",\"verdict\",{\"href\":\"#verdict\",\"className\":\"mr-1\",\"children\":[\"$\",\"svg\",null,{\"stroke\":\"currentColor\",\"fill\":\"currentColor\",\"strokeWidth\":\"0\",\"viewBox\":\"0 0 512 512\",\"className\":\"inline-block opacity-20 hover:opacity-60\",\"children\":[\"$undefined\",[[\"$\",\"path\",\"0\",{\"d\":\"$32\",\"children\":[]}]]],\"style\":{\"color\":\"$undefined\"},\"height\":16,\"width\":16,\"xmlns\":\"http://www.w3.org/2000/svg\"}]}],\"Verdict\"]}],\"\\n\",[\"$\",\"p\",\"p-38\",{\"children\":\"Form is React is indeed a challenge. Without careful designing and implementation, problems may occur at any time, anywhere.\"}],\"\\n\",[\"$\",\"p\",\"p-39\",{\"children\":[\"The issue here was ultimately the re-renders, but not the form I originally thought of, but the dropdown with large number of options. It is important to app performance to \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"understand React update strategy\"}],\" and \",[\"$\",\"strong\",\"strong-1\",{\"children\":\"control the component update\"}],\" with lifecycle functions, property hook usage, memoing and caching, especially when the the number of component to render is too large.\"]}],\"\\n\",[\"$\",\"p\",\"p-40\",{\"children\":[\"The \",[\"$\",\"strong\",\"strong-0\",{\"children\":\"profiler\"}],\" was the key to finding the component to blame by providing the data of time to re-render for each component. Therefore, when a performance issue is detected, stop wasting guessing which compoenent causes it, and let profiler take you straight to it.\"]}]]}]]}],[\"$\",\"div\",null,{\"className\":\"hidden lg:block lg:w-[25%]\",\"children\":[\"$\",\"$L33\",null,{\"toc\":[{\"depth\":1,\"value\":\"The Problem\",\"id\":\"the-problem\"},{\"depth\":1,\"value\":\"Investigation\",\"id\":\"investigation\",\"children\":[{\"depth\":2,\"value\":\"Validations?\",\"id\":\"validations\"},{\"depth\":2,\"value\":\"Re-renders of the Whole Form?\",\"id\":\"re-renders-of-the-whole-form\",\"children\":[{\"depth\":3,\"value\":\"The Challenge of Forms in React\",\"id\":\"the-challenge-of-forms-in-react\"},{\"depth\":3,\"value\":\"Complicated Form\",\"id\":\"complicated-form\"},{\"depth\":3,\"value\":\"No Easy Solutions\",\"id\":\"no-easy-solutions\"}]},{\"depth\":2,\"value\":\"Maybe Not Re-renders?\",\"id\":\"maybe-not-re-renders\"},{\"depth\":2,\"value\":\"Profiling, Profiling, Profiling\",\"id\":\"profiling-profiling-profiling\"},{\"depth\":2,\"value\":\"Large Quantity of Options\",\"id\":\"large-quantity-of-options\"}]},{\"depth\":1,\"value\":\"Solution\",\"id\":\"solution\"},{\"depth\":1,\"value\":\"Verdict\",\"id\":\"verdict\"}],\"hasSummary\":true}]}]]}]\n"])</script><script>self.__next_f.push([1,"b:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"9:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"A React Form Component Performance Optimization with Profiler - ddadaal.me\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"ddadaal's personal website\"}],[\"$\",\"link\",\"3\",{\"rel\":\"manifest\",\"href\":\"/site.webmanifest\",\"crossOrigin\":\"$undefined\"}],[\"$\",\"link\",\"4\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"16x16\"}],[\"$\",\"link\",\"5\",{\"rel\":\"icon\",\"href\":\"/icon.svg?35be8e76be1c3618\",\"type\":\"image/svg+xml\",\"sizes\":\"any\"}],[\"$\",\"link\",\"6\",{\"rel\":\"apple-touch-icon\",\"href\":\"/apple-icon.png?5334a64f42000bb0\",\"type\":\"image/png\",\"sizes\":\"180x180\"}]]\n"])</script><script>self.__next_f.push([1,"7:null\n"])</script><script>self.__next_f.push([1,"34:I[51,[\"116\",\"static/chunks/c556396d-6bde9789d0a41114.js\",\"413\",\"static/chunks/7a1bdfe6-8f7609c25899d936.js\",\"994\",\"static/chunks/c4aeae87-2a85323a0275cbf9.js\",\"786\",\"static/chunks/1b3e99d6-50521588821d44ca.js\",\"845\",\"static/chunks/845-a0203995fac91684.js\",\"57\",\"static/chunks/57-3951d65188499c8f.js\",\"826\",\"static/chunks/826-c44bffd752ec02cd.js\",\"467\",\"static/chunks/467-ff6f7f0e9f0462a7.js\",\"971\",\"static/chunks/app/articles/%5B%5B...params%5D%5D/page-59c8401fd7fff2e0.js\"],\"ArticleImage\"]\n1f:[\"$\",\"$L34\",\"img-0\",{\"src\":\"/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/bad-pref.gif\",\"imageSize\":{\"height\":123,\"width\":534},\"imageProps\":{\"src\":\"bad-pref.gif\",\"alt\":\"bad performance, especially for the first input field\"}}]\n24:[\"$\",\"$L34\",\"img-0\",{\"src\":\"/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/unidirectiona-data-flow.png\",\"imageSize\":{\"height\":720,\"width\":960},\"imageProps\":{\"src\":\"unidirectiona-data-flow.png\",\"alt\":\"Source: https://gist.github.com/alexmingoia/4db967e5aeb31d84847c. See this page to get yourself familiarized if you haven't already.\"}}]\n26:[\"$\",\"$L34\",\"img-0\",{\"src\":\"/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/fields.png\",\"imageSize\":{\"height\":248,\"width\":726},\"imageProps\":{\"src\":\"fields.png\",\"alt\":\"part of fields\"}}]\n2a:[\"$\",\"$L34\",\"img-0\",{\"src\":\"/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/profiling.png\",\"imageSize\":{\"height\":141,\"width\":780},\"imageProps\":{\"src\":\"profiling.png\",\"alt\":\"Ranked chart\"}}]\n2b:[\"$\",\"$L34\",\"img-1\",{\"src\":\"/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/profiling-2.png\",\"imageSize\":{\"height\":228,\"width\":414},\"imageProps\":{\"src\":\"profiling-2.png\",\"alt\":\"Flamegraph chart\"}}]\n2c:[\"$\",\"$L34\",\"img-0\",{\"src\":\"/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/dropdown.png\",\"imageSize\":{\"height\":174,\"width\":476},\"imageProps\":{\"src\":\"dropdown.png\",\"alt\":\"The drop"])</script><script>self.__next_f.push([1,"down\"}}]\n2e:[\"$\",\"$L34\",\"img-0\",{\"src\":\"/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/large-number-of-options.png\",\"imageSize\":{\"height\":109,\"width\":123},\"imageProps\":{\"src\":\"large-number-of-options.png\",\"alt\":\"\u003e400 options\"}}]\n30:[\"$\",\"$L34\",\"img-0\",{\"src\":\"/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/optimized-code.png\",\"imageSize\":{\"height\":429,\"width\":609},\"imageProps\":{\"src\":\"optimized-code.png\",\"alt\":\"Optimized code\"}}]\n31:[\"$\",\"$L34\",\"img-0\",{\"src\":\"/articles/asset/contents/20191012-a-react-form-comp-pref-optimization-with-profiler/after.png\",\"imageSize\":{\"height\":169,\"width\":748},\"imageProps\":{\"src\":\"after.png\",\"alt\":\"After\"}}]\n"])</script></body></html>